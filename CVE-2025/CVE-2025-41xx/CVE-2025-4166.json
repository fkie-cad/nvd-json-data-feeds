{
  "id": "CVE-2025-4166",
  "sourceIdentifier": "security@hashicorp.com",
  "published": "2025-05-02T15:15:50.313",
  "lastModified": "2025-08-12T01:44:28.067",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Vault Community and Vault Enterprise Key/Value (kv) Version 2 plugin may unintentionally expose sensitive information in server and audit logs when users submit malformed payloads during secret creation or update operations via the Vault REST API. This vulnerability, identified as CVE-2025-4166, is fixed in Vault Community 1.19.3 and Vault Enterprise 1.19.3, 1.18.9, 1.17.16, 1.16.20."
    },
    {
      "lang": "es",
      "value": "El complemento Clave/Valor (kv) versi\u00f3n 2 de Vault Community y Vault Enterprise podr\u00eda exponer involuntariamente informaci\u00f3n confidencial en los registros del servidor y de auditor\u00eda cuando los usuarios env\u00edan payloads malformadas durante la creaci\u00f3n o actualizaci\u00f3n de secretos mediante la API REST de Vault. Esta vulnerabilidad, identificada como CVE-2025-4166, est\u00e1 corregida en Vault Community 1.19.3 y Vault Enterprise 1.19.3, 1.18.9, 1.17.16 y 1.16.20."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security@hashicorp.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:U/C:H/I:N/A:N",
          "baseScore": 4.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 0.9,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@hashicorp.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-209"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "0.3.0",
              "versionEndExcluding": "1.16.20",
              "matchCriteriaId": "D5725166-DE38-4732-943E-593516467228"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionStartIncluding": "0.3.0",
              "versionEndExcluding": "1.19.3",
              "matchCriteriaId": "03C206B1-F9D1-4C88-AD39-A7D00BA9A14E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.17.0",
              "versionEndExcluding": "1.17.16",
              "matchCriteriaId": "970B0477-CEE0-4A5B-957A-443FC008E9A5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.18.0",
              "versionEndExcluding": "1.18.9",
              "matchCriteriaId": "35573CFA-209A-4C06-ABFE-872F52CAD8F9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.19.0",
              "versionEndExcluding": "1.19.3",
              "matchCriteriaId": "A2697ADE-3ADA-49EC-AA4C-68AE84F56C8D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2025-09-vault-may-expose-sensitive-information-in-error-logs-when-processing-malformed-data-with-the-kv-v2-plugin",
      "source": "security@hashicorp.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}