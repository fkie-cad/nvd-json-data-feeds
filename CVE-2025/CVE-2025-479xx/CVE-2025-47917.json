{
  "id": "CVE-2025-47917",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2025-07-20T19:15:23.847",
  "lastModified": "2025-07-22T13:06:07.260",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Mbed TLS before 3.6.4 allows a use-after-free in certain situations of applications that are developed in accordance with the documentation. The function mbedtls_x509_string_to_names() takes a head argument that is documented as an output argument. The documentation does not suggest that the function will free that pointer; however, the function does call mbedtls_asn1_free_named_data_list() on that argument, which performs a deep free(). As a result, application code that uses this function (relying only on documented behavior) is likely to still hold pointers to the memory blocks that were freed, resulting in a high risk of use-after-free or double-free. In particular, the two sample programs x509/cert_write and x509/cert_req are affected (use-after-free if the san string contains more than one DN)."
    },
    {
      "lang": "es",
      "value": "Mbed TLS anterior a la versi\u00f3n 3.6.4 permite el use-after-free en ciertas situaciones de aplicaciones desarrolladas de acuerdo con la documentaci\u00f3n. La funci\u00f3n mbedtls_x509_string_to_names() toma un argumento principal documentado como argumento de salida. La documentaci\u00f3n no sugiere que la funci\u00f3n libere dicho puntero; sin embargo, la funci\u00f3n llama a mbedtls_asn1_free_named_data_list() con dicho argumento, lo que realiza una liberaci\u00f3n profunda. Como resultado, es probable que el c\u00f3digo de la aplicaci\u00f3n que utiliza esta funci\u00f3n (bas\u00e1ndose \u00fanicamente en el comportamiento documentado) a\u00fan contenga punteros a los bloques de memoria liberados, lo que resulta en un alto riesgo de use-after-free o doble liberaci\u00f3n. En particular, los dos programas de ejemplo x509/cert_write y x509/cert_req se ven afectados (use-after-free si la cadena san contiene m\u00e1s de un DN)."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "cve@mitre.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:H",
          "baseScore": 8.9,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "cve@mitre.org",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-416"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Mbed-TLS/mbedtls-docs/blob/main/security-advisories/mbedtls-security-advisory-2025-06-7.md",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://mbed-tls.readthedocs.io/en/latest/tech-updates/security-advisories/",
      "source": "cve@mitre.org"
    }
  ]
}