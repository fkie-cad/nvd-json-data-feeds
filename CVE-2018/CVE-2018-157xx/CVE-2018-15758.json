{
  "id": "CVE-2018-15758",
  "sourceIdentifier": "security_alert@emc.com",
  "published": "2018-10-18T22:29:00.537",
  "lastModified": "2019-10-03T00:03:26.223",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Spring Security OAuth, versions 2.3 prior to 2.3.4, and 2.2 prior to 2.2.3, and 2.1 prior to 2.1.3, and 2.0 prior to 2.0.16, and older unsupported versions could be susceptible to a privilege escalation under certain conditions. A malicious user or attacker can craft a request to the approval endpoint that can modify the previously saved authorization request and lead to a privilege escalation on the subsequent approval. This scenario can happen if the application is configured to use a custom approval endpoint that declares AuthorizationRequest as a controller method argument. This vulnerability exposes applications that meet all of the following requirements: Act in the role of an Authorization Server (e.g. @EnableAuthorizationServer) and use a custom Approval Endpoint that declares AuthorizationRequest as a controller method argument. This vulnerability does not expose applications that: Act in the role of an Authorization Server and use the default Approval Endpoint, act in the role of a Resource Server only (e.g. @EnableResourceServer), act in the role of a Client only (e.g. @EnableOAuthClient)."
    },
    {
      "lang": "es",
      "value": "Spring Security OAuth, en versiones 2.3 anteriores a la 2.3.4, versiones 2.2 anteriores a la 2.2.3, versiones 2.1 anteriores a la 2.1.3, versiones 2.0 anteriores a la 2.0.16 y versiones anteriores no soportadas, podr\u00eda ser susceptible a un escalado de privilegios bajo ciertas condiciones. Un usuario o atacante malicioso puede manipular una petici\u00f3n al endpoint de aprobaci\u00f3n que puede modificar la petici\u00f3n de autorizaci\u00f3n anteriormente guardada y conducir a un escalado de privilegios en la siguiente aprobaci\u00f3n. Este escenario puede ocurrir si la aplicaci\u00f3n se configura para emplear un endpoint de aprobaci\u00f3n personalizado que declara AuthorizationRequest como argumento del m\u00e9todo del controlador. Esta vulnerabilidad expone las aplicaciones que cumplen con todos estos requisitos: Actuar en nombre de un servidor de autorizaci\u00f3n (@EnableAuthorizationServer) y emplear un endpoint de aprobaci\u00f3n personalizado que declara AuthorizationRequest como argumento del m\u00e9todo del controlador. Esta vulnerabilidad no expone aplicaciones que: Act\u00faan en el rol de un servidor de autorizaci\u00f3n y emplean el endpoint de aprobaci\u00f3n por defecto, act\u00faan solo en el rol de un servidor de recursos (@EnableResourceServer) o act\u00faan solo en el rol de un cliente (@EnableOAuthClient)."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.1,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.9
      },
      {
        "source": "security_alert@emc.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 9.6,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 5.8
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.8
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.0.5",
              "matchCriteriaId": "9A509469-AEE5-456E-893E-8A9DD20720D9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.0.0",
              "versionEndExcluding": "2.0.16",
              "matchCriteriaId": "04374D1E-5861-4668-AC33-D90BCDEC995B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.1.0",
              "versionEndExcluding": "2.1.3",
              "matchCriteriaId": "A5470031-AFC1-4EC1-A5AC-940393DA5A00"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.2.0",
              "versionEndExcluding": "2.2.3",
              "matchCriteriaId": "6BDDDBC1-781C-409B-B701-DEC72B11D90B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pivotal_software:spring_security_oauth:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.3.0",
              "versionEndExcluding": "2.3.4",
              "matchCriteriaId": "075640B9-8D85-4917-BFD5-C0000FB37CFD"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/105687",
      "source": "security_alert@emc.com",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://access.redhat.com/errata/RHSA-2019:2413",
      "source": "security_alert@emc.com"
    },
    {
      "url": "https://pivotal.io/security/cve-2018-15758",
      "source": "security_alert@emc.com",
      "tags": [
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ]
}