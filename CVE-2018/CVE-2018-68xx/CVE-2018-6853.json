{
  "id": "CVE-2018-6853",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2018-07-09T18:29:00.747",
  "lastModified": "2019-10-03T00:03:26.223",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Sophos SafeGuard Enterprise before 8.00.5, SafeGuard Easy before 7.00.3, and SafeGuard LAN Crypt before 3.95.2 are vulnerable to Local Privilege Escalation via IOCTL 0x80206024. By crafting an input buffer we can control the execution path to the point where a global variable will be written to a user controlled address. We can take advantage of this condition to zero-out the pointer to the security descriptor in the object header of a privileged process or modify the security descriptor itself and run code in the context of a process running as SYSTEM."
    },
    {
      "lang": "es",
      "value": "Sophos SafeGuard Enterprise en versiones anteriores a la 8.00.5, SafeGuard Easy en versiones anteriores a la 7.00.3, y SafeGuard LAN Crypt en versiones anteriores a la 3.95.2 son vulnerables a una escalada de privilegios local mediante IOCTL 0x80206024. Manipulando un b\u00fafer de entrada, es posible controlar la ruta de ejecuci\u00f3n al puntero, en el que se escribir\u00e1 una variable global en una direcci\u00f3n controlada por el usuario. Se puede aprovechar esta situaci\u00f3n para eliminar el puntero al descriptor de seguridad en la cabecera del objeto de un proceso privilegiado o modificar el descriptor de seguridad en s\u00ed para ejecutar c\u00f3digo en el contexto de un proceso que se est\u00e1 ejecutando como SYSTEM."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.2
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 3.9,
        "impactScore": 10.0,
        "acInsufInfo": true,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-119"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.00:*:*:*:*:*:*:*",
              "matchCriteriaId": "2F57138C-7C06-496F-994E-0966CE8212C0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:6.10:*:*:*:*:*:*:*",
              "matchCriteriaId": "C35D6EE3-06A4-4720-A41F-A853CBF5AD31"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_easy_device_encryption_client:7.00:*:*:*:*:*:*:*",
              "matchCriteriaId": "3EC3A868-4328-4C39-9846-8E1182E747CB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:5.60.3:vs-nfd:*:*:*:*:*:*",
              "matchCriteriaId": "1831A4DA-2F50-411A-924F-FF0E15A593A0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:6.00:*:*:*:*:*:*:*",
              "matchCriteriaId": "7D8F90D7-7D25-418F-AE85-AD1D7E60DD18"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:6.00.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "864E1982-8947-4EF7-912D-CDFD74E8D134"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:6.10:*:*:*:*:*:*:*",
              "matchCriteriaId": "60BBA33F-853D-407B-975B-A9182B259DB9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:7.00:*:*:*:*:*:*:*",
              "matchCriteriaId": "88E54DC4-12A5-452F-8DCE-890645585097"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_enterprise_client:8.00:*:*:*:*:*:*:*",
              "matchCriteriaId": "3075C40D-1FF9-46D0-80F3-2EF8E8423974"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.1:ts:*:*:*:*:*:*",
              "matchCriteriaId": "4BCE0FAF-54C0-420D-BA05-F90848408515"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.90.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "4CD621BA-6AB7-427D-B6D0-D2D75D1ADC18"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "C82A7CD5-0703-47E1-BA4F-3797986CE139"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sophos:safeguard_lan_crypt_client:3.95.1:ts:*:*:*:*:*:*",
              "matchCriteriaId": "2D0F50CA-6C19-4ECF-97B7-6636A2756961"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2018/Jul/20",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://community.sophos.com/kb/en-us/131934",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://labs.nettitude.com/blog/cve-2018-6851-to-cve-2018-6857-sophos-privilege-escalation-vulnerabilities/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Technical Description",
        "Third Party Advisory"
      ]
    }
  ]
}