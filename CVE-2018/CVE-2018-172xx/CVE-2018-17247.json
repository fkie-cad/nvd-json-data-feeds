{
  "id": "CVE-2018-17247",
  "sourceIdentifier": "bressers@elastic.co",
  "published": "2018-12-20T22:29:00.427",
  "lastModified": "2019-10-09T23:36:34.643",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Elasticsearch Security versions 6.5.0 and 6.5.1 contain an XXE flaw in Machine Learning's find_file_structure API. If a policy allowing external network access has been added to Elasticsearch's Java Security Manager then an attacker could send a specially crafted request capable of leaking content of local files on the Elasticsearch node. This could allow a user to access information that they should not have access to."
    },
    {
      "lang": "es",
      "value": "Elasticsearch Security, en versiones 6.5.0 y 6.5.1, contiene un error de XEE (XML External Entity) en la API find_file_structure de Machine Learning. Si se ha a\u00f1adido una pol\u00edtica que permite acceso externo a la red al gestor de seguridad Java de Elasticsearch Security, un atacante podr\u00eda enviar una petici\u00f3n especialmente manipulada capaz de filtrar contenido de archivos locales en el nodo de Elasticsearch. Esto podr\u00eda permitir a un usuario acceder a informaci\u00f3n a la que no deber\u00eda tener acceso."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-611"
        }
      ]
    },
    {
      "source": "bressers@elastic.co",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-611"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:elastic:elasticsearch:6.5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "6872390D-6001-424E-A4C0-AF2C2E73FB26"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:elastic:elasticsearch:6.5.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "49E7B0E1-E674-4055-B7E7-C1227E0872D3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/106294",
      "source": "bressers@elastic.co",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "https://discuss.elastic.co/t/elastic-stack-6-5-2-security-update/159594",
      "source": "bressers@elastic.co",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.elastic.co/community/security",
      "source": "bressers@elastic.co",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}