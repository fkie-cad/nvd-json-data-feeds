{
  "id": "CVE-2018-20061",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2018-12-11T17:29:00.507",
  "lastModified": "2019-01-02T14:50:42.310",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A SQL injection issue was discovered in ERPNext 10.x and 11.x through 11.0.3-beta.29. This attack is only available to a logged-in user; however, many ERPNext sites allow account creation via the web. No special privileges are needed to conduct the attack. By calling a JavaScript function that calls a server-side Python function with carefully chosen arguments, a SQL attack can be carried out which allows SQL queries to be constructed to return any columns from any tables in the database. This is related to /api/resource/Item?fields= URIs, frappe.get_list, and frappe.call."
    },
    {
      "lang": "es",
      "value": "Se ha descubierto un problema de inyecci\u00f3n SQL en ERPNext, en versiones 10.x y 11.x hasta la 11.0.3-beta.29. Este ataque solo est\u00e1 disponible para un usuario que haya iniciado sesi\u00f3n; sin embargo, muchos sitios de ERPNext permiten la creaci\u00f3n de cuentas mediante la web. No se necesitan privilegios especiales para llevar a cabo el ataque. Al llamar a una funci\u00f3n JavaScript que llama a una funci\u00f3n de Python del lado del servidor con argumentos cuidadosamente escogidos, se puede realizar un ataque SQL que permite que se construyan consultas SQL que devuelvan cualquier columna de cualquier tabla de la base de datos. Esto est\u00e1 relacionado con los URI frappe.get_list y frappe.call en /api/resource/Item?fields=."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "10.0.0",
              "versionEndIncluding": "10.1.76",
              "matchCriteriaId": "7D15E6CA-D0E1-493A-B300-7AF679D33F44"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "11.0.0",
              "versionEndExcluding": "11.0.3",
              "matchCriteriaId": "FFAED978-36E5-459B-B94C-E76F545D6917"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta10:*:*:*:*:*:*",
              "matchCriteriaId": "C9DCB37E-061E-44D6-A686-6464B5BE54D2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta11:*:*:*:*:*:*",
              "matchCriteriaId": "93C2D6DF-B4E5-434B-8632-DB1DF10CE5E9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta12:*:*:*:*:*:*",
              "matchCriteriaId": "0C6F3220-13B5-4504-87DB-09495E5E1386"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta13:*:*:*:*:*:*",
              "matchCriteriaId": "D6AFF494-240F-4981-B4EC-24771A6E1E4C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta14:*:*:*:*:*:*",
              "matchCriteriaId": "69D3FEA8-FC3F-434E-AFA6-D03D8EFAC524"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta15:*:*:*:*:*:*",
              "matchCriteriaId": "D9D81630-3EE2-498E-9A76-0F0C1CDD1A15"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta16:*:*:*:*:*:*",
              "matchCriteriaId": "C3367D0E-5701-4FCA-8307-0FA7D25D71E3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta17:*:*:*:*:*:*",
              "matchCriteriaId": "1DBD878F-935B-427F-B6DF-4DA4356E9843"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta18:*:*:*:*:*:*",
              "matchCriteriaId": "DAE5DFE4-55B8-4F68-8C3A-2CDC13D8A735"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta19:*:*:*:*:*:*",
              "matchCriteriaId": "6F22BFC9-CA3D-4B57-AD93-1B5094D69508"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta2:*:*:*:*:*:*",
              "matchCriteriaId": "FE5E71D9-CCD4-47F4-9AC8-4E4A112E9C0A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta20:*:*:*:*:*:*",
              "matchCriteriaId": "CA394555-C3A0-4142-B023-60A9014C87E8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta21:*:*:*:*:*:*",
              "matchCriteriaId": "6B5C737A-A824-4E7D-A8D6-A0E0A4AE710A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta22:*:*:*:*:*:*",
              "matchCriteriaId": "33E4D6A6-2F64-4DB8-9946-5E54FE889E6C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta23:*:*:*:*:*:*",
              "matchCriteriaId": "8AAD166B-0B54-4D74-A61D-A17F34C403F6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta24:*:*:*:*:*:*",
              "matchCriteriaId": "2856944B-7178-414D-B485-5B8C4D88E95D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta25:*:*:*:*:*:*",
              "matchCriteriaId": "27EE33DF-6485-463D-BB51-33D4295D3E55"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta26:*:*:*:*:*:*",
              "matchCriteriaId": "FBEED6D7-3EA2-4BC0-B7F8-5F104F90EB82"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta27:*:*:*:*:*:*",
              "matchCriteriaId": "C5E9A6A8-A210-467F-888C-1327C8E5F5D0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta28:*:*:*:*:*:*",
              "matchCriteriaId": "97CA5919-E7B0-417B-BF91-6B407F83F167"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta29:*:*:*:*:*:*",
              "matchCriteriaId": "E0C2C925-F3D3-4C5D-A281-2BE62F32BB52"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta3:*:*:*:*:*:*",
              "matchCriteriaId": "0411AA32-05B2-49C2-A0DC-8F74BDABCA3B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta4:*:*:*:*:*:*",
              "matchCriteriaId": "EE9DFDFA-9387-46C2-BC9C-58A90713F0E6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta5:*:*:*:*:*:*",
              "matchCriteriaId": "86661EEC-799A-404B-A847-D91A00403F3C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta6:*:*:*:*:*:*",
              "matchCriteriaId": "2AFA67C7-6829-4160-A7C8-B3DD56E60CF3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta7:*:*:*:*:*:*",
              "matchCriteriaId": "90E1D4DA-2D89-4CD5-B34F-33D96BD2C341"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta8:*:*:*:*:*:*",
              "matchCriteriaId": "8B4BE801-0FF0-4B44-8DCF-E2805DCC39A6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:frappe:erpnext:11.0.3:beta9:*:*:*:*:*:*",
              "matchCriteriaId": "B4AE27CF-FCAF-4491-AAC1-8EB5E5C5FD6A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/frappe/erpnext/issues/15337",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}