{
  "id": "CVE-2018-19148",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2018-11-10T19:29:00.227",
  "lastModified": "2019-01-30T18:09:41.997",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Caddy through 0.11.0 sends incorrect certificates for certain invalid requests, making it easier for attackers to enumerate hostnames. Specifically, when unable to match a Host header with a vhost in its configuration, it serves the X.509 certificate for a randomly selected vhost in its configuration. Repeated requests (with a nonexistent hostname in the Host header) permit full enumeration of all certificates on the server. This generally permits an attacker to easily and accurately discover the existence of and relationships among hostnames that weren't meant to be public, though this information could likely have been discovered via other methods with additional effort."
    },
    {
      "lang": "es",
      "value": "Caddy hasta la versi\u00f3n 0.11.0 env\u00eda certificados incorrectos para determinadas solicitudes no v\u00e1lidas, lo que facilita a los atacantes la enumeraci\u00f3n de nombres de host. Espec\u00edficamente, cuando no puede hacer coincidir una cabecera Host con un vhost en su configuraci\u00f3n, sirve el certificado X.509 para un vhost seleccionado aleatoriamente en su configuraci\u00f3n. Las peticiones repetidas (con un nombre de host inexistente en la cabecera Host) permiten la enumeraci\u00f3n completa de todos los certificados en el servidor. Esto generalmente permite que un atacante descubra de forma f\u00e1cil y precisa la existencia y las relaciones entre los nombres de host que no estaban destinados a ser p\u00fablicos, aunque es probable que esta informaci\u00f3n se haya descubierto a trav\u00e9s de otros m\u00e9todos con un esfuerzo adicional."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.7,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:caddyserver:caddy:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "0.11.0",
              "matchCriteriaId": "59A5EAFF-215E-4C1B-9600-32A00D3F1432"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/mholt/caddy/issues/1303",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mholt/caddy/issues/2334",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/mholt/caddy/pull/2015",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://securitytrails.com/blog/caddy-web-server-ssl-bug",
      "source": "nvd@nist.gov",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}