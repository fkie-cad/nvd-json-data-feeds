{
  "id": "CVE-2020-8562",
  "sourceIdentifier": "jordan@liggitt.net",
  "published": "2022-02-01T11:15:10.903",
  "lastModified": "2022-03-29T16:35:38.577",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "As mitigations to a report from 2019 and CVE-2020-8555, Kubernetes attempts to prevent proxied connections from accessing link-local or localhost networks when making user-driven connections to Services, Pods, Nodes, or StorageClass service providers. As part of this mitigation Kubernetes does a DNS name resolution check and validates that response IPs are not in the link-local (169.254.0.0/16) or localhost (127.0.0.0/8) range. Kubernetes then performs a second DNS resolution without validation for the actual connection. If a non-standard DNS server returns different non-cached responses, a user may be able to bypass the proxy IP restriction and access private networks on the control plane."
    },
    {
      "lang": "es",
      "value": "Como mitigaci\u00f3n a un informe de 2019 y CVE-2020-8555, Kubernetes intenta impedir que las conexiones proxy accedan a las redes link-local o localhost cuando son realizadas conexiones impulsadas por el usuario a los servicios, pods, nodos o proveedores de servicios StorageClass. Como parte de esta mitigaci\u00f3n, Kubernetes realiza una comprobaci\u00f3n de resoluci\u00f3n de nombres DNS y comprueba que las IPs de respuesta no est\u00e9n en el rango link-local (169.254.0.0/16) o localhost (127.0.0/8). A continuaci\u00f3n, Kubernetes lleva a cabo una segunda resoluci\u00f3n de DNS sin comprobar para la conexi\u00f3n real. Si un servidor DNS no est\u00e1ndar devuelve diferentes respuestas no almacenadas en cach\u00e9, un usuario puede ser capaz de omitir la restricci\u00f3n de la IP del proxy y acceder a redes privadas en el plano de control"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.1,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 1.4
      },
      {
        "source": "jordan@liggitt.net",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 2.2,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 0.7,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.5
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 6.8,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-367"
        }
      ]
    },
    {
      "source": "jordan@liggitt.net",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-367"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.18.18",
              "matchCriteriaId": "7BE1AD99-F12A-4F6E-8EA5-578F32A1F15F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.19.0",
              "versionEndIncluding": "1.19.10",
              "matchCriteriaId": "34CCC198-AAA6-4DAE-94C4-B8CE55F621F7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:kubernetes:kubernetes:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.20.0",
              "versionEndIncluding": "1.20.6",
              "matchCriteriaId": "6868B56F-DDBE-4CDA-9537-A0CAD3CDB1AB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:kubernetes:kubernetes:1.21.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "1A3D8AFD-1FB4-4F98-8522-E57A15DD00BB"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/kubernetes/kubernetes/issues/101493",
      "source": "jordan@liggitt.net",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://groups.google.com/g/kubernetes-security-announce/c/-MFX60_wdOY",
      "source": "jordan@liggitt.net",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220225-0002/",
      "source": "jordan@liggitt.net",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}