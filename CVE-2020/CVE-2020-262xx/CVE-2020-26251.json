{
  "id": "CVE-2020-26251",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2020-12-18T18:15:12.543",
  "lastModified": "2020-12-22T19:30:04.637",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Open Zaak is a modern, open-source data- and services-layer to enable zaakgericht werken, a Dutch approach to case management. In Open Zaak before version 1.3.3 the Cross-Origin-Resource-Sharing policy in Open Zaak is currently wide open - every client is allowed. This allows evil.com to run scripts that perform AJAX calls to known Open Zaak installations, and the browser will not block these. This was intended to only apply to development machines running on localhost/127.0.0.1. Open Zaak 1.3.3 disables CORS by default, while it can be opted-in through environment variables. The vulnerability does not actually seem exploitable because: a) The session cookie has a `Same-Site: Lax` policy which prevents it from being sent along in Cross-Origin requests. b) All pages that give access to (production) data are login-protected c) `Access-Control-Allow-Credentials` is set to `false` d) CSRF checks probably block the remote origin, since they're not explicitly added to the trusted allowlist."
    },
    {
      "lang": "es",
      "value": "Open Zaak es una capa moderna de datos y servicios de c\u00f3digo abierto que habilita a zaakgericht werken, un enfoque Dutch para la gesti\u00f3n de casos.&#xa0;En Open Zaak anterior a la versi\u00f3n 1.3.3, la pol\u00edtica Cross-Origin-Resource-Sharing en Open Zaak est\u00e1 actualmente abierta: todos los clientes est\u00e1n autorizados.&#xa0;Esto permite que evil.com ejecutar scripts que realicen llamadas AJAX a instalaciones conocidas de Open Zaak, y el navegador no las bloquear\u00e1.&#xa0;Esto estaba destinado a ser aplicado solo a las m\u00e1quinas de desarrollo que se ejecutan en localhost/127.0.0.1.&#xa0;Open Zaak versi\u00f3n 1.3.3 deshabilita a CORS por defecto, mientras que se puede habilitar por medio de variables de entorno.&#xa0;En realidad, la vulnerabilidad no parece explotable porque: a) La cookie de sesi\u00f3n tiene una pol\u00edtica \"Same-Site: Lax\" que impide que se env\u00ede en peticiones de origen cruzado. b) Todas las p\u00e1ginas que dan acceso a los datos (de producci\u00f3n) est\u00e1n protegidas por inicio de sesi\u00f3n c) \"Access-Control-Allow-Credentials\" se establece en \"false\" d) Las comprobaciones de CSRF probablemente bloquean el origen remoto, ya que no se agregan expl\u00edcitamente a la lista de permitidos de confianza"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-346"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-346"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:openzaak:open_zaak:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.3.3",
              "matchCriteriaId": "2EC50EF3-3341-4DA3-83C7-88272FC139CB"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/open-zaak/open-zaak/blob/master/CHANGELOG.rst#133-2020-12-17",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/open-zaak/open-zaak/commit/952269269f1b629fce9c94485f83ac13f31d6c46",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/open-zaak/open-zaak/security/advisories/GHSA-chhr-gxrg-64x7",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}