{
  "id": "CVE-2020-15239",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2020-10-06T19:15:13.633",
  "lastModified": "2020-10-23T03:09:55.120",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In xmpp-http-upload before version 0.4.0, when the GET method is attacked, attackers can read files which have a `.data` suffix and which are accompanied by a JSON file with the `.meta` suffix. This can lead to Information Disclosure and in some shared-hosting scenarios also to circumvention of authentication or other limitations on the outbound (GET) traffic. For example, in a scenario where a single server has multiple instances of the application running (with separate DATA_ROOT settings), an attacker who has knowledge about the directory structure is able to read files from any other instance to which the process has read access. If instances have individual authentication (for example, HTTP authentication via a reverse proxy, source IP based filtering) or other restrictions (such as quotas), attackers may circumvent those limits in such a scenario by using the Directory Traversal to retrieve data from the other instances. If the associated XMPP server (or anyone knowing the SECRET_KEY) is malicious, they can write files outside the DATA_ROOT. The files which are written are constrained to have the `.meta` and the `.data` suffixes; the `.meta` file will contain the JSON with the Content-Type of the original request and the `.data` file will contain the payload. The issue is patched in version 0.4.0."
    },
    {
      "lang": "es",
      "value": "En xmpp-http-upload anterior a la versi\u00f3n 0.4.0, cuando el m\u00e9todo GET es atacado, los atacantes pueden leer archivos que tienen un sufijo \".data\" y que est\u00e1n acompa\u00f1ados de un archivo JSON con el sufijo \".meta\".&#xa0;Esto puede conducir a una divulgaci\u00f3n de informaci\u00f3n y, en algunos escenarios de hosting compartido, tambi\u00e9n a una omisi\u00f3n de autenticaci\u00f3n u otras limitaciones en el tr\u00e1fico saliente (GET).&#xa0;Por ejemplo, en un escenario en el que un solo servidor posee varias instancias de la aplicaci\u00f3n en ejecuci\u00f3n (con configuraciones DATA_ROOT separadas), un atacante que tenga conocimiento sobre la estructura del directorio puede leer archivos de cualquier otra instancia a la que el proceso tenga acceso de lectura.&#xa0;Si las instancias tienen autenticaci\u00f3n individual (por ejemplo, autenticaci\u00f3n HTTP por medio de un proxy inverso, filtrado basado en IP de origen) u otras restricciones (como cuotas),&#xa0;los atacantes pueden omitir esos l\u00edmites en tal escenario usando un Salto de Directorio para recuperar datos de las otras instancias.&#xa0;Si el servidor XMPP asociado (o cualquier persona que conozca la SECRET_KEY) es malicioso, puede escribir archivos fuera de DATA_ROOT.&#xa0;Los archivos que se escriben est\u00e1n limitados a tener los sufijos \".meta\" y \".data\";&#xa0;el archivo \".meta\" contendr\u00e1 el JSON con el tipo de contenido de la petici\u00f3n original y el archivo \".data\" contendr\u00e1 la carga \u00fatil.&#xa0;El problema est\u00e1 parcheado en la versi\u00f3n 0.4.0"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.5,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.5,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xmpp-http-upload_project:xmpp-http-upload:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.4.0",
              "matchCriteriaId": "103FED28-C896-42E2-8C47-863D84A841C3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/horazont/xmpp-http-upload/commit/82056540191e89f0cd697c81f57714c00962ed75",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/horazont/xmpp-http-upload/pull/12",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/horazont/xmpp-http-upload/security/advisories/GHSA-hwv5-w8gm-fq9f",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pypi.org/project/xmpp-http-upload/#history",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ]
}