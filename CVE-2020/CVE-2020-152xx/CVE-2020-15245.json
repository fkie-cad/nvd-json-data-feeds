{
  "id": "CVE-2020-15245",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2020-10-19T21:15:12.810",
  "lastModified": "2021-11-18T16:19:33.113",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In Sylius before versions 1.6.9, 1.7.9 and 1.8.3, the user may register in a shop by email mail@example.com, verify it, change it to the mail another@domain.com and stay verified and enabled. This may lead to having accounts addressed to totally different emails, that were verified. Note, that this way one is not able to take over any existing account (guest or normal one). The issue has been patched in Sylius 1.6.9, 1.7.9 and 1.8.3. As a workaround, you may resolve this issue on your own by creating a custom event listener, which will listen to the sylius.customer.pre_update event. You can determine that email has been changed if customer email and user username are different. They are synchronized later on. Pay attention, to email changing behavior for administrators. You may need to skip this logic for them. In order to achieve this, you should either check master request path info, if it does not contain /admin prefix or adjust event triggered during customer update in the shop. You can find more information on how to customize the event here."
    },
    {
      "lang": "es",
      "value": "En Sylius versiones anteriores a 1.6.9, 1.7.9 y 1.8.3, el usuario puede registrarse en una tienda mediante el correo electr\u00f3nico mail@example.com, verificarlo, cambiarlo al correo another@domain.com y permanecer verificado y habilitado.&#xa0;Esto puede conllevar a tener cuentas dirigidas a correos electr\u00f3nicos totalmente diferentes, que fueron verificados.&#xa0;Tome en cuenta que de esta manera uno no es capaz de tomar el control de ninguna cuenta existente (de invitado o normal).&#xa0;El problema ha sido parcheado en Sylius versiones 1.6.9, 1.7.9 y 1.8.3.&#xa0;Como soluci\u00f3n alternativa, puede resolver este problema por su cuenta mediante la creaci\u00f3n de un detector de eventos personalizado, que escuchar\u00e1 el evento sylius.customer.pre_update.&#xa0;Puede determinar que el correo electr\u00f3nico ha sido cambiado si el correo electr\u00f3nico del cliente y el nombre de usuario son diferentes.&#xa0;Estos se sincronizan m\u00e1s tarde.&#xa0;Preste atenci\u00f3n al comportamiento cambiante del correo electr\u00f3nico para los administradores.&#xa0;Puede necesitar omitir esta l\u00f3gica para ellos.&#xa0;En funci\u00f3n de lograr esto,&#xa0;debe comprobar la informaci\u00f3n de la ruta de petici\u00f3n maestra, si no contiene el prefijo /admin o ajustar el evento activado durante la actualizaci\u00f3n del cliente en la tienda.&#xa0;Puede encontrar m\u00e1s informaci\u00f3n sobre c\u00f3mo personalizar el evento aqu\u00ed"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 4.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-862"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sylius:sylius:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.6.9",
              "matchCriteriaId": "B2E8B8E9-D805-4E1A-8AB4-B06B322668DA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sylius:sylius:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.7.0",
              "versionEndExcluding": "1.7.9",
              "matchCriteriaId": "6C4F2B73-6B56-4226-9F97-F5B3C2F14B4F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:sylius:sylius:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.8.0",
              "versionEndExcluding": "1.8.3",
              "matchCriteriaId": "B995A95C-06CD-46C4-90C4-FF42915BAFAF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Sylius/Sylius/commit/60636d711a4011e8694d10d201b53632c7e8ecaf",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/Sylius/Sylius/security/advisories/GHSA-6gw4-x63h-5499",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}