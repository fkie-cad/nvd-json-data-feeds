{
  "id": "CVE-2020-11767",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-04-15T02:15:14.000",
  "lastModified": "2021-07-21T11:39:23.747",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Istio through 1.5.1 and Envoy through 1.14.1 have a data-leak issue. If there is a TCP connection (negotiated with SNI over HTTPS) to *.example.com, a request for a domain concurrently configured explicitly (e.g., abc.example.com) is sent to the server(s) listening behind *.example.com. The outcome should instead be 421 Misdirected Request. Imagine a shared caching forward proxy re-using an HTTP/2 connection for a large subnet with many users. If a victim is interacting with abc.example.com, and a server (for abc.example.com) recycles the TCP connection to the forward proxy, the victim's browser may suddenly start sending sensitive data to a *.example.com server. This occurs because the forward proxy between the victim and the origin server reuses connections (which obeys the specification), but neither Istio nor Envoy corrects this by sending a 421 error. Similarly, this behavior voids the security model browsers have put in place between domains."
    },
    {
      "lang": "es",
      "value": "Istio versiones hasta 1.5.1 y Envoy versiones hasta 1.14.1, presenta un problema de p\u00e9rdida de datos. Si existe una conexi\u00f3n TCP (negociada con SNI a trav\u00e9s de HTTPS) a *.example.com, se env\u00eda una petici\u00f3n de un dominio configurado de manera simult\u00e1nea expl\u00edcitamente (por ejemplo, abc.example.com) hacia los servidores que escuchan detr\u00e1s de * .example.com. El resultado en su lugar deber\u00eda ser 421 Misdirected Request. Imagine un proxy directo de almacenamiento en cach\u00e9 compartido que reutiliza una conexi\u00f3n HTTP/2 para una subred grande con muchos usuarios. Si una v\u00edctima est\u00e1 interactuando con abc.example.com, y un servidor (para abc.example.com) recicla la conexi\u00f3n TCP al proxy directo, el navegador de la v\u00edctima puede comenzar a enviar datos confidenciales hacia un servidor *.example.com. Esto ocurre porque el proxy de reenv\u00edo entre la v\u00edctima y el servidor de origen reutiliza las conexiones (que obedecen la especificaci\u00f3n), pero ni Istio ni Envoy corrigen esto al enviar un error 421. Del mismo modo, este comportamiento anula los modelos de seguridad que los navegadores han implementado entre dominios."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.1,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:H/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "HIGH",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 2.6
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 4.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:envoyproxy:envoy:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.14.1",
              "matchCriteriaId": "CCE5F040-C8AF-4F73-AB1F-D0A2752AD185"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:istio:istio:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.5.1",
              "matchCriteriaId": "2122D404-F673-4F12-B91C-1338F3AEE5CC"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugs.chromium.org/p/chromium/issues/detail?id=954160#c5",
      "source": "cve@mitre.org",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/envoyproxy/envoy/issues/6767",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/issues/13589",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/istio/istio/issues/9429",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}