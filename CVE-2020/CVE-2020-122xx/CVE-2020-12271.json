{
  "id": "CVE-2020-12271",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2020-04-27T04:15:10.553",
  "lastModified": "2022-10-05T18:38:12.407",
  "vulnStatus": "Analyzed",
  "cisaExploitAdd": "2021-11-03",
  "cisaActionDue": "2022-05-03",
  "cisaRequiredAction": "Apply updates per vendor instructions.",
  "cisaVulnerabilityName": "Sophos SFOS SQL Injection Vulnerability",
  "descriptions": [
    {
      "lang": "en",
      "value": "A SQL injection issue was found in SFOS 17.0, 17.1, 17.5, and 18.0 before 2020-04-25 on Sophos XG Firewall devices, as exploited in the wild in April 2020. This affected devices configured with either the administration (HTTPS) service or the User Portal exposed on the WAN zone. A successful attack may have caused remote code execution that exfiltrated usernames and hashed passwords for the local device admin(s), portal admins, and user accounts used for remote access (but not external Active Directory or LDAP passwords)"
    },
    {
      "lang": "es",
      "value": "Se descubri\u00f3\u00b4 un problema de inyecci\u00f3n SQL en SFOS versiones 17.0, 17.1, 17.5 y versiones 18.0 antes del 25-04-2020, en los dispositivos Firewall Sophos XG, tal como se explot\u00f3 \"in the wild\" en abril de 2020. Esto afect\u00f3 a los dispositivos configurados con el servicio de administraci\u00f3n (HTTPS) o el Portal de Usuario expuesto en la zona WAN. Un ataque con \u00e9xito puede haber filtrado nombres de usuario y contrase\u00f1as del hash a los administradores de los dispositivos locales, los administradores del portal y las cuentas de usuario usadas para el acceso remoto (pero no las contrase\u00f1as externas de Active Directory o LDAP)."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV30": [
      {
        "source": "cve@mitre.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 7.5
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:sophos:sfos:17.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "BC4B4B56-5DF6-400D-BC59-ECAE47332E54"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:sophos:sfos:17.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "8F159D9E-F268-4648-8894-5A9426F7C6AF"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:sophos:sfos:17.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "788AC43C-23A8-4E86-A7F1-8133808D54F8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:sophos:sfos:18.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "42065AE5-13B2-429E-9610-F14269A44D4A"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:sophos:xg_firewall:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "9628D079-44BD-479E-BE63-9BEF824B4E4B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://community.sophos.com/kb/en-us/135412",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://cwe.mitre.org/data/definitions/89.html",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://news.sophos.com/en-us/2020/04/26/asnarok/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}