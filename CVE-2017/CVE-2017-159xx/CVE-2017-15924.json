{
  "id": "CVE-2017-15924",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-10-27T16:29:00.223",
  "lastModified": "2019-10-03T00:03:26.223",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In manager.c in ss-manager in shadowsocks-libev 3.1.0, improper parsing allows command injection via shell metacharacters in a JSON configuration request received via 127.0.0.1 UDP traffic, related to the add_server, build_config, and construct_command_line functions."
    },
    {
      "lang": "es",
      "value": "En manager.c en ss-manager en shadowsocks-libev 3.1.0, un an\u00e1lisis sint\u00e1ctico incorrecto permite que se inyecten comandos mediante metacaracteres shell en una petici\u00f3n de configuraci\u00f3n JSON recibida mediante tr\u00e1fico UDP 127.0.0.1. Esto est\u00e1 relacionado con las funciones add_server, build_config y construct_command_line."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.2
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 3.9,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-78"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "262748CE-0CD9-44C2-AB0F-1A294CE0AA30"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.3.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "858C9955-84A0-46A3-B59A-F6BD2C9D25F5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "EFAD798C-521E-4521-B340-3B543F5CDB16"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "AB12F9EF-7ACC-46E2-B218-0C0E1E38BB89"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "7C350C3D-5F7F-4F4B-B8A3-B08FDAB2618A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "8C49FC33-3806-42ED-893C-232C141E5140"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "92225501-B713-4DBD-8EBD-8D56B6AD0872"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "01559F24-751D-42C8-9648-CC604E514B64"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "E30AB75A-4553-453B-A711-7FFA6EB448FB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.7:*:*:*:*:*:*:*",
              "matchCriteriaId": "602BCBCB-7B57-4037-ADC0-01090B7EBC5C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.4.8:*:*:*:*:*:*:*",
              "matchCriteriaId": "4158AB78-5C3A-48E5-8B42-7103D4D95FC9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "DAC3B37C-5AC7-4785-82F3-FB0D4CD4B777"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.5.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "6FBBA7A1-2183-4435-8064-2841597DBD55"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.5.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "54CBF205-2399-4661-AD93-FFCCD757A2D9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.5.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "7D20FECE-568E-4991-A869-23789B18A8F4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.6.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "8BB2C3F3-A4DB-4C04-8F65-3C24B61E524D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.6.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "B6B825E3-F934-4D1D-B307-7196C61BDA31"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.6.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "B3B8FECA-EE5C-4058-873C-F65C91642FE2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:1.6.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "236849B1-4DAE-482C-B75E-912C1CE5F9A2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "8ACBD11A-4C3E-47CA-A9CD-333318A855C6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "B2340582-1281-408A-AF05-4A71E78DB847"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "06182273-F0E4-4F7E-A563-121AD2FAC441"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "0279A0FD-292B-45BC-B56A-1E12EDAACB38"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "A36328CB-2DDF-40C4-AA52-98A7B4BDBCB0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "12C85600-1F7F-476D-B060-FBE25545300D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.7:*:*:*:*:*:*:*",
              "matchCriteriaId": "71E66FC1-612B-488C-A6D4-9E73CBD9DE82"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.0.8:*:*:*:*:*:*:*",
              "matchCriteriaId": "3E9BAF98-48E9-4440-A492-60778999BEAD"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.1.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "AFA20F57-5234-43D9-B33E-6AA49A6FCBA0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.1.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "20D60ABD-1D9F-4D27-9D2D-48F10AF6D4E9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.1.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "D89BD126-AD55-4EF8-A48E-BA737A89F8CE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.1.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "5ECDF224-ADA3-4025-9E09-E9EF3B43444F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.1.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "F31D2E50-FB42-4082-BC86-6662D8706A50"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.2.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "9C12C316-6F4C-4475-AA98-285AFC4E2B4F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.2.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "2E51B2F2-1838-4A6A-96AB-EE9EEB995A77"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.2.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "21421755-6E64-4FF5-BF57-EDB768D26AD8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.2.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "F4AF0932-F04A-4E8A-AFD3-52F006F85FB9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.3.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "6F689FB4-2B30-452D-BE8B-96DF84C00960"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.3.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "79909DAF-3264-4828-8E36-887FF5173541"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.3.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "46166314-7AAC-42D6-A676-840D5EF872D2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.3.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "8E490DD4-4FD8-410E-8BD7-2B1E081A2506"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "403B82B9-53F8-4BA9-8EE8-93EC5B970DB6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "1BFBDE8F-0977-4917-AFF3-031C40CB9E0E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "058DF5B7-AF32-48FA-8EFE-3ED1E4130C4C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "4D65CEA2-205A-4527-8255-25317FFDE336"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "FBDD3327-5537-4792-9B02-13D1BC6892A6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "B6A9C44E-C7FA-4364-A5B6-684A1084073E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "FCEB57E4-A7D2-42C5-84A6-ABD50FA2B91B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.7:*:*:*:*:*:*:*",
              "matchCriteriaId": "675CBFEF-AF81-4EF4-9E18-13B41C1F89F6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.4.8:*:*:*:*:*:*:*",
              "matchCriteriaId": "5FED856A-2144-4D7D-B574-F67793DAA251"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "18A99F5F-FEDF-457A-B274-4702214ADD6A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "8C2CBF01-5961-4294-A0CC-D0B274879FE1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "E0043DF8-3531-4B34-A0C7-0F58F8C90667"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "62F18204-8AD4-4807-A859-410D55ABFBF8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "DA8144FE-9F00-4B83-909A-9147CE8D7819"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "652369C8-9B12-409E-975F-17F3C05B4981"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.5.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "03AD1670-0B5E-419D-A29F-5230C9DD1175"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.6.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "9B030384-DB8E-469D-AAFB-4F7D9ECA5CFA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.6.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "1BBBED6A-744D-4010-815F-4C1FE454B2A6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.6.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "562B9AEF-8F59-4634-B4E5-AA3B447C414C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:2.6.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "2B4C4BAC-756E-41EA-A13D-8AB96F1C1DD5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "B8E25A0F-8EA6-426C-8992-41F0065BBE9E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "F6E1528A-610A-4DF9-A5A2-E65DE99B8C0F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "B9062913-8F01-45E8-AB15-18BAC8A71249"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "CCDDF0A6-A17D-44A7-ACE5-55E0E378BC0A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "A7DA1D19-8123-4898-AAD4-3C672B7B296F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.5:*:*:*:*:*:*:*",
              "matchCriteriaId": "86EE26E9-C5D6-43BF-9882-5B1AB5F19D10"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "9C05CFCD-5136-440C-B0C2-E03D281A5A26"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.7:*:*:*:*:*:*:*",
              "matchCriteriaId": "916FEC4D-DFB6-4194-960A-8EACD3C374C4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.0.8:*:*:*:*:*:*:*",
              "matchCriteriaId": "95DF4CAE-A6CD-4AC7-9376-01939ED9F19E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shadowsocks:shadowsocks-libev:3.1.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "C5295170-CCB0-452A-B6B7-14CA5D2A6F0B"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:debian:debian_linux:9.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "6911EEBB-541E-4448-B028-2F473903B24E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://openwall.com/lists/oss-security/2017/10/13/2",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.debian.org/security/2017/dsa-4009",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/shadowsocks/shadowsocks-libev/commit/c67d275803dc6ea22c558d06b1f7ba9f94cd8de3",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/shadowsocks/shadowsocks-libev/issues/1734",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.x41-dsec.de/lab/advisories/x41-2017-010-shadowsocks-libev/",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}