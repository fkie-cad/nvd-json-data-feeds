{
  "id": "CVE-2017-6417",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-03-21T16:59:00.443",
  "lastModified": "2019-10-03T00:03:26.223",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Code injection vulnerability in Avira Total Security Suite 15.0 (and earlier), Optimization Suite 15.0 (and earlier), Internet Security Suite 15.0 (and earlier), and Free Security Suite 15.0 (and earlier) allows a local attacker to bypass a self-protection mechanism, inject arbitrary code, and take full control of any Avira process via a \"DoubleAgent\" attack. One perspective on this issue is that (1) these products do not use the Protected Processes feature, and therefore an attacker can enter an arbitrary Application Verifier Provider DLL under Image File Execution Options in the registry; (2) the self-protection mechanism is intended to block all local processes (regardless of privileges) from modifying Image File Execution Options for these products; and (3) this mechanism can be bypassed by an attacker who temporarily renames Image File Execution Options during the attack."
    },
    {
      "lang": "es",
      "value": "Vulnerabilidad de inyecci\u00f3n de c\u00f3digo en Avira Total Security Suite 15.0 (y versiones anteriores), Optimization Suite 15.0 (y versiones anteriores), Internet Security Suite 15.0 (y versiones anteriores), y Free Security Suite 15.0 (y versiones anteriores) permite a atacante local evitar un mecanismo de autoprotecci\u00f3n, inyectar c\u00f3digo arbitrario, y tomar el control total de cualquier proceso Avira a trav\u00e9s de un ataque \"DoubleAgent\".Una perspectiva de este problema es que (1) estos productos no utilizan la caracter\u00edstica de procesos protegidos y, por lo tanto, un atacante puede introducir un proveedor verificador de aplicaciones DLL arbitrario bajo opciones de ejecuci\u00f3n de archivo de imagen en el registro; (2) el mecanismo de autoprotecci\u00f3n est\u00e1 destinado a bloquear todos los procesos locales (independientemente de los privilegios) de modificar las opciones de ejecuci\u00f3n de archivos de imagen para estos productos; Y (3) este mecanismo puede ser anulado por un atacante que cambia temporalmente las opciones de ejecuci\u00f3n de archivo de imagen durante el ataque."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 6.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.2
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 3.9,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-427"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:avira:free_security_suite:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "15.0",
              "matchCriteriaId": "AE7F57F3-44EC-4A62-961A-96D738C07F9F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:avira:internet_security_suite:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "15.0",
              "matchCriteriaId": "3A683F78-042B-4503-9DCC-F770110046ED"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:avira:optimization_suite:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "15.0",
              "matchCriteriaId": "3CA1DEA5-7C23-48D5-9DD2-B1725B27B5E1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:avira:total_security_suite:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "15.0",
              "matchCriteriaId": "9456309A-CA21-4558-9E71-B2C560DF962C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://cybellum.com/doubleagent-taking-full-control-antivirus/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://cybellum.com/doubleagentzero-day-code-injection-and-persistence-technique/",
      "source": "cve@mitre.org",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/97021",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory",
        "VDB Entry"
      ]
    }
  ]
}