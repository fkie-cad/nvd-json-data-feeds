{
  "id": "CVE-2017-5217",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-01-09T08:59:00.247",
  "lastModified": "2017-01-11T02:59:12.870",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "Installing a zero-permission Android application on certain Samsung Android devices with KK(4.4), L(5.0/5.1), and M(6.0) software can continually crash the system_server process in the Android OS. The zero-permission app will create an active install session for a separate app that it has embedded within it. The active install session of the embedded app is performed using the android.content.pm.PackageInstaller class and its nested classes in the Android API. The active install session will write the embedded APK file to the /data/app directory, but the app will not be installed since third-party applications cannot programmatically install apps. Samsung has modified AOSP in order to accelerate the parsing of APKs by introducing the com.android.server.pm.PackagePrefetcher class and its nested classes. These classes will parse the APKs present in the /data/app directory and other directories, even if the app is not actually installed. The embedded APK that was written to the /data/app directory via the active install session has a very large but valid AndroidManifest.xml file. Specifically, the AndroidManifest.xml file contains a very large string value for the name of a permission-tree that it declares. When system_server tries to parse the APK file of the embedded app from the active install session, it will crash due to an uncaught error (i.e., java.lang.OutOfMemoryError) or an uncaught exception (i.e., std::bad_alloc) because of memory constraints. The Samsung Android device will encounter a soft reboot due to a system_server crash, and this action will keep repeating since parsing the APKs in the /data/app directory as performed by the system_server process is part of the normal boot process. The Samsung ID is SVE-2016-6917."
    },
    {
      "lang": "es",
      "value": "La instalaci\u00f3n de una aplicaci\u00f3n Android de cero permisos en ciertos dispositivos Samsung con software KK(4.4), L(5.0/5.1) y M(6.0) puede bloquear continuamente el proceso system_server en el SO Android. La aplicaci\u00f3n de cero permisos crear\u00e1 una sesi\u00f3n de instalaci\u00f3n activa para una aplicaci\u00f3n separada que tiene embebida. La sesi\u00f3n de instalaci\u00f3n activa de la aplicaci\u00f3n embebida se realiza usando la clase android.content.pm.PackageInstaller y sus clases anidadas en la API de Android. La instalaci\u00f3n activa escribir\u00e1 el archivo APK embebido en el directorio /data/app, pero la aplicaci\u00f3n no se instalar\u00e1 ya que las aplicaciones de terceros no pueden instalar aplicaciones de forma programada. Samsung ha modificado AOSP para acelerar el an\u00e1lisis de APKs introduciendo la clase com.android.server.pm.PackagePrefetcher y sus clases anidadas. Estas clases analizar\u00e1n las APKs presentes en el directorio /data/app y otros directorios, incluso si la aplicaci\u00f3n no est\u00e1 instalada actualmente. El APK embebido que se escribi\u00f3 en el directorio /data/app a trav\u00e9s de la sesi\u00f3n de instalaci\u00f3n activada tiene un archivo AndroidManifest.xml muy extenso pero v\u00e1lido. Espec\u00edficamente, el archivo AndroidManifest.xml contiene un valor de cadena muy grande para el nombre de un \u00e1rbol de permisos que declara. Cuando system_server intenta analizar el archivo APK de la aplicaci\u00f3n embebida de la sesi\u00f3n de instalaci\u00f3n activa, se bloquear\u00e1 debido a un error no detectado (java.lang.OutOfMemoryError) o una excepci\u00f3n no detectada (std::bad_alloc) por restricciones de memoria. El dispositivo Samsung Android se encontrar\u00e1 con un reinicio suave debido a un fallo de system_server, y esta acci\u00f3n se repetir\u00e1 debido a que el an\u00e1lisis de los APK en el directorio /data/app realizado a trav\u00e9s de system_server, es parte del funcionamiento normal. La ID de Samsung es SVE-2016-6917."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:N/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.1
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.6,
        "impactScore": 6.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-119"
        },
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:4.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "68B4FF3D-35CC-4E86-A6EE-D065D654FC4A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "A13E2E2D-41E2-4CF7-A019-6B462A614271"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:5.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "DD99CD57-C55D-4812-8F9C-5ACE7555C086"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:samsung:samsung_mobile:6.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "ABD6EA64-6B65-4487-914F-9EF9CBB78211"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://security.samsungmobile.com/smrupdate.html#SMR-JAN-2017",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "http://www.securityfocus.com/bid/95319",
      "source": "cve@mitre.org"
    }
  ]
}