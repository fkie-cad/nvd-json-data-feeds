{
  "id": "CVE-2023-47640",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-11-14T21:15:13.517",
  "lastModified": "2023-11-22T15:00:49.287",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "DataHub is an open-source metadata platform. The HMAC signature for DataHub Frontend sessions was being signed using a SHA-1 HMAC with the frontend secret key. SHA1 with a 10 byte key can be brute forced using sufficient resources (i.e. state level actors with large computational capabilities). DataHub Frontend was utilizing the Play LegacyCookiesModule with default settings which utilizes a SHA1 HMAC for signing. This is compounded by using a shorter key length than recommended by default for the signing key for the randomized secret value. An authenticated attacker (or attacker who has otherwise obtained a session token) could crack the signing key for DataHub and obtain escalated privileges by generating a privileged session cookie. Due to key length being a part of the risk, deployments should update to the latest helm chart and rotate their session signing secret. All deployments using the default helm chart configurations for generating the Play secret key used for signing are affected by this vulnerability. Version 0.11.1 resolves this vulnerability. All users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "DataHub es una plataforma de metadatos de c\u00f3digo abierto. La firma HMAC para las sesiones de DataHub Frontend se firmaba utilizando un HMAC SHA-1 con la clave secreta de frontend. SHA1 con una clave de 10 bytes puede ser forzado de forma bruta utilizando recursos suficientes (es decir, actores a nivel de estado con grandes capacidades computacionales). DataHub Frontend estaba utilizando Play LegacyCookiesModule con configuraci\u00f3n predeterminada que utiliza SHA1 HMAC para firmar. Esto se ve agravado por el uso de una longitud de clave m\u00e1s corta que la recomendada de forma predeterminada para la clave de firma para el valor secreto aleatorio. Un atacante autenticado (o un atacante que de otro modo haya obtenido un token de sesi\u00f3n) podr\u00eda descifrar la clave de firma de DataHub y obtener privilegios escalados generando una cookie de sesi\u00f3n privilegiada. Debido a que la longitud de la clave es parte del riesgo, las implementaciones deben actualizarse al gr\u00e1fico de tim\u00f3n m\u00e1s reciente y rotar su secreto de firma de sesi\u00f3n. Todas las implementaciones que utilizan las configuraciones predeterminadas del gr\u00e1fico de tim\u00f3n para generar la clave secreta de Play utilizada para firmar se ven afectadas por esta vulnerabilidad. La versi\u00f3n 0.11.1 resuelve esta vulnerabilidad. Se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:H/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW",
          "baseScore": 6.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 4.7
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-327"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-327"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:datahub_project:datahub:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.11.1",
              "matchCriteriaId": "9A9EC1A2-5DA6-4B23-9C0D-D93095C69C6A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/datahub-project/datahub/security/advisories/GHSA-fg9x-wvqw-6gmw",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}