{
  "id": "CVE-2023-46249",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-10-31T16:15:09.853",
  "lastModified": "2023-11-08T17:50:18.727",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "authentik is an open-source Identity Provider. Prior to versions 2023.8.4 and 2023.10.2, when the default admin user has been deleted, it is potentially possible for an attacker to set the password of the default admin user without any authentication. authentik uses a blueprint to create the default admin user, which can also optionally set the default admin users' password from an environment variable. When the user is deleted, the `initial-setup` flow used to configure authentik after the first installation becomes available again. authentik 2023.8.4 and 2023.10.2 fix this issue. As a workaround, ensure the default admin user (Username `akadmin`) exists and has a password set. It is recommended to use a very strong password for this user, and store it in a secure location like a password manager. It is also possible to deactivate the user to prevent any logins as akadmin."
    },
    {
      "lang": "es",
      "value": "authentik es un proveedor de identidades de c\u00f3digo abierto. Antes de las versiones 2023.8.4 y 2023.10.2, cuando se eliminaba el usuario administrador predeterminado, era posible que un atacante estableciera la contrase\u00f1a del usuario administrador predeterminado sin ninguna autenticaci\u00f3n. authentik utiliza un modelo para crear el usuario administrador predeterminado, que tambi\u00e9n puede establecer opcionalmente la contrase\u00f1a de los usuarios administradores predeterminados desde una variable de entorno. Cuando se elimina el usuario, el flujo de \"configuraci\u00f3n inicial\" utilizado para configurar authentik despu\u00e9s de la primera instalaci\u00f3n vuelve a estar disponible. authentik 2023.8.4 y 2023.10.2 solucionan este problema. Como workaround, aseg\u00farese de que el usuario administrador predeterminado (nombre de usuario `akadmin`) exista y tenga una contrase\u00f1a establecida. Se recomienda utilizar una contrase\u00f1a muy segura para este usuario y guardarla en un lugar seguro como un administrador de contrase\u00f1as. Tambi\u00e9n es posible desactivar el usuario para evitar inicios de sesi\u00f3n como akaadmin."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.6,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-306"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2023.8.4",
              "matchCriteriaId": "5889E9B4-DDA1-474A-A1AB-1483E2F5FDE8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:goauthentik:authentik:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2023.10.0",
              "versionEndExcluding": "2023.10.2",
              "matchCriteriaId": "AA3E7BC0-8AEE-4861-949A-86818D17DEFD"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/goauthentik/authentik/commit/261879022d25016d58867cf1f24e90b81ad618d0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/commit/ea75741ec22ecef34bc7073f1163e17a8a2bf9fc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/releases/tag/version%2F2023.10.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/releases/tag/version%2F2023.8.4",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/goauthentik/authentik/security/advisories/GHSA-rjvp-29xq-f62w",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}