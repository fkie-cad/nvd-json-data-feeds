{
  "id": "CVE-2023-41046",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-09-01T20:15:07.540",
  "lastModified": "2023-09-07T19:20:17.653",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "XWiki Platform is a generic wiki platform offering runtime services for applications built on top of it. It is possible in XWiki to execute Velocity code without having script right by creating an XClass with a property of type \"TextArea\" and content type \"VelocityCode\" or \"VelocityWiki\". For the former, the syntax of the document needs to be set the `xwiki/1.0` (this syntax doesn't need to be installed). In both cases, when adding the property to an object, the Velocity code is executed regardless of the rights of the author of the property (edit right is still required, though). In both cases, the code is executed with the correct context author so no privileged APIs can be accessed. However, Velocity still grants access to otherwise inaccessible data and APIs that could allow further privilege escalation. At least for \"VelocityCode\", this behavior is most likely very old but only since XWiki 7.2, script right is a separate right, before that version all users were allowed to execute Velocity and thus this was expected and not a security issue. This has been patched in XWiki 14.10.10 and 15.4 RC1. Users are advised to upgrade. There are no known workarounds."
    },
    {
      "lang": "es",
      "value": "Xwiki Platform es una plataforma wiki gen\u00e9rica que ofrece servicios de ejecuci\u00f3n para aplicaciones construidas sobre ella. Es posible en XWiki ejecutar c\u00f3digo Velocity sin tener derecho a script creando una \"Xclass\" con una propiedad de tipo \"TextArea\" y tipo de contenido \"VelocityCode\" o \"VelocityWiki\". Para el primero, la sintaxis del documento necesita ser configurada como \"xwiki/1.0\" (esta sintaxis no necesita ser instalada). En ambos casos, cuando se agrega la propiedad a un objeto, el c\u00f3digo de Velocity se ejecuta sin importar los derechos del autor de la propiedad (aunque el derecho de edici\u00f3n sigue siendo necesario). En ambos casos, el c\u00f3digo se ejecuta con el autor de contexto correcto por lo que no se puede acceder a APIs privilegiadas. Sin embargo, Velocity a\u00fan permite el acceso a datos y APIs que de otra manera sr\u00edan inaccesibles y que podr\u00edan permitir una escalada de privilegios mayor. Al menos para \"VelocitiyCode\", este comportamiento es probablemente muy antiguo pero solo desde XWiki v7.2, el derecho de script es un derecho separado, antes de esa versi\u00f3n todos los usuarios pod\u00edan ejecutar Velocity y por lo tanto esto era esperado y no un problema de seguridad. Esto ha sido parcheado en XWiki v14.10.10 y v15.4 RC1. Se recomienda a los usuarios actualizar. No hay soluciones conocidas. "
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-862"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "7.2",
              "versionEndExcluding": "14.10.10",
              "matchCriteriaId": "BB71750B-49AB-4C51-BFBF-38047BB5FA32"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "15.0",
              "versionEndExcluding": "15.4",
              "matchCriteriaId": "6FFCB973-8456-44E0-ACB0-2A237AEAD917"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/edc52579eeaab1b4514785c134044671a1ecd839",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-m5m2-h6h9-p2c8",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20847",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-20848",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Vendor Advisory"
      ]
    }
  ]
}