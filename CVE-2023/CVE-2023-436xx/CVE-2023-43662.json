{
  "id": "CVE-2023-43662",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-09-28T22:15:10.270",
  "lastModified": "2023-10-06T18:28:46.827",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "ShokoServer is a media server which specializes in organizing anime. In affected versions the `/api/Image/WithPath` endpoint is accessible without authentication and is supposed to return default server images. The endpoint accepts the parameter `serverImagePath`, which is not sanitized in any way before being passed to `System.IO.File.OpenRead`, which results in an arbitrary file read. This issue may lead to an arbitrary file read which is exacerbated in the windows installer which installs the ShokoServer as administrator. Any unauthenticated attacker may be able to access sensitive information and read files stored on the server. The `/api/Image/WithPath` endpoint has been removed in commit `6c57ba0f0` which will be included in subsequent releases. Users should limit access to the `/api/Image/WithPath` endpoint or manually patch their installations until a patched release is made. This issue was discovered by the GitHub Security lab and is also indexed as GHSL-2023-191."
    },
    {
      "lang": "es",
      "value": "ShokoServer es un servidor de medios que se especializa en organizar anime. En las versiones afectadas, se puede acceder al endpoint `/api/Image/WithPath` sin autenticaci\u00f3n y se supone que devuelve im\u00e1genes de servidor predeterminadas. El endpoint acepta el par\u00e1metro `serverImagePath`, que no se sanitiza de ninguna manera antes de pasarse a `System.IO.File.OpenRead`, lo que da como resultado una lectura de archivo arbitraria. Este problema puede provocar una lectura de archivo arbitraria que se agrava en el instalador de Windows que instala ShokoServer como administrador. Cualquier atacante no autenticado puede acceder a informaci\u00f3n confidencial y leer archivos almacenados en el servidor. El endpoint `/api/Image/WithPath` se elimin\u00f3 en el commit `6c57ba0f0`, que se incluir\u00e1 en versiones posteriores. Los usuarios deben limitar el acceso al endpoin `/api/Image/WithPath` o parchear manualmente sus instalaciones hasta que se realice una versi\u00f3n parcheada. Este problema fue descubierto por el laboratorio de GitHub Security y tambi\u00e9n est\u00e1 indexado como GHSL-2023-191."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 8.6,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.0
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 8.6,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shokoanime:shokoserver:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "4.2.2",
              "matchCriteriaId": "100F9CC0-A263-4C38-A023-9AB537C00CB4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/ShokoAnime/ShokoServer/commit/6c57ba0f073d6be5a4f508c46c2ce36727cbce80",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/ShokoAnime/ShokoServer/security/advisories/GHSA-mwcv-ghjq-8f2g",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ]
}