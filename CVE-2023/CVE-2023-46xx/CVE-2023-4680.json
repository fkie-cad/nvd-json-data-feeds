{
  "id": "CVE-2023-4680",
  "sourceIdentifier": "security@hashicorp.com",
  "published": "2023-09-15T00:15:07.967",
  "lastModified": "2024-09-26T17:15:03.190",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "HashiCorp Vault and Vault Enterprise transit secrets engine allowed authorized users to specify arbitrary nonces, even with convergent encryption disabled. The encrypt endpoint, in combination with an offline attack, could be used to decrypt arbitrary ciphertext and potentially derive the authentication subkey when using transit secrets engine without convergent encryption. Introduced in 1.6.0 and fixed in 1.14.3, 1.13.7, and 1.12.11."
    },
    {
      "lang": "es",
      "value": "El motor de secretos de tr\u00e1nsito de HashiCorp Vault y Vault Enterprise permiti\u00f3 a los usuarios autorizados especificar nonces arbitrarios, incluso con el cifrado convergente deshabilitado. El endpoint de cifrado, en combinaci\u00f3n con un ataque fuera de l\u00ednea, podr\u00eda usarse para descifrar texto cifrado arbitrario y potencialmente derivar la subclave de autenticaci\u00f3n cuando se utiliza el motor de secretos de tr\u00e1nsito sin cifrado convergente. Introducido en 1.6.0 y corregido en 1.14.3, 1.13.7 y 1.12.11."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 6.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.2
      },
      {
        "source": "security@hashicorp.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 6.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    },
    {
      "source": "security@hashicorp.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-323"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.6.0",
              "versionEndExcluding": "1.12.11",
              "matchCriteriaId": "88214AA6-BE16-44D0-8BF3-961AA4F4912C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.6.0",
              "versionEndExcluding": "1.12.11",
              "matchCriteriaId": "308AEF45-E549-4EA3-8028-3A95978BF44C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.13.0",
              "versionEndExcluding": "1.13.7",
              "matchCriteriaId": "1190B84C-4AE0-4353-A7B3-64B646E4BCA5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.13.0",
              "versionEndExcluding": "1.13.7",
              "matchCriteriaId": "148E1E7C-5DB9-4261-BF3B-A54C8B5F43EA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.14.0",
              "versionEndExcluding": "1.14.3",
              "matchCriteriaId": "931AAAF6-4AB0-46EB-A03F-FF98A22867C2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.14.0",
              "versionEndExcluding": "1.14.3",
              "matchCriteriaId": "778CBB0C-2739-4733-871A-9B053843FADC"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2023-28-vault-s-transit-secrets-engine-allowed-nonce-specified-without-convergent-encryption/58249",
      "source": "security@hashicorp.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}