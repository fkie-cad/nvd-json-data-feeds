{
  "id": "CVE-2023-0591",
  "sourceIdentifier": "research@onekey.com",
  "published": "2023-01-31T10:15:10.253",
  "lastModified": "2023-11-07T04:00:55.923",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "\nubireader_extract_files is vulnerable to path traversal when run against specifically crafted UBIFS files, allowing the attacker to overwrite files outside of the extraction directory (provided the process has write access to that file or directory).\n\nThis is due to the fact that a node name (dent_node.name) is considered trusted and joined to the extraction directory path during processing, then the node content is written to that joined path. By crafting a malicious UBIFS file with node names holding path traversal payloads (e.g. ../../tmp/outside.txt), it's possible to force ubi_reader to write outside of the extraction directory.\n\n\n\nThis issue affects ubi-reader before 0.8.5.\n\n"
    },
    {
      "lang": "es",
      "value": "ubireader_extract_files es vulnerable a path traversal cuando se ejecuta contra archivos UBIFS espec\u00edficamente manipulados, lo que permite al atacante sobrescribir archivos fuera del directorio de extracci\u00f3n (siempre que el proceso tenga acceso de escritura a ese archivo o directorio). Esto se debe al hecho de que un nombre de nodo (dent_node.name) se considera confiable y se une a la ruta del directorio de extracci\u00f3n durante el procesamiento; luego, el contenido del nodo se escribe en esa ruta unida. Al crear un archivo UBIFS malicioso con nombres de nodos que contienen payloads de path traversal (por ejemplo, ../../tmp/outside.txt), es posible forzar a ubi_reader a escribir fuera del directorio de extracci\u00f3n. Este problema afecta a ubi-reader antes de 0.8.5.x"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      },
      {
        "source": "research@onekey.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:N/I:H/A:N",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    },
    {
      "source": "research@onekey.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ubi_reader_project:ubi_reader:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.8.5",
              "matchCriteriaId": "44B81021-E665-42B2-A24A-74E646BCE470"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/jrspruitt/ubi_reader/pull/57",
      "source": "research@onekey.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://onekey.com/blog/security-advisory-remote-command-execution-in-binwalk/",
      "source": "research@onekey.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}