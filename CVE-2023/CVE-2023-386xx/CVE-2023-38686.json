{
  "id": "CVE-2023-38686",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-08-04T16:15:10.550",
  "lastModified": "2023-08-10T19:30:28.810",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Sydent is an identity server for the Matrix communications protocol. Prior to version 2.5.6, if configured to send emails using TLS, Sydent does not verify SMTP servers' certificates. This makes  Sydent's emails vulnerable to interception via a man-in-the-middle (MITM) attack. Attackers with privileged access to the network can intercept room invitations and address confirmation emails. This is patched in Sydent 2.5.6. When patching, make sure that Sydent trusts the certificate of the server it is connecting to. This should happen automatically when using properly issued certificates. Those who use self-signed certificates should make sure to copy their Certification Authority certificate, or their self signed certificate if using only one, to the trust store of your operating system. As a workaround, one can ensure Sydent's emails fail to send by setting the configured SMTP server to a loopback or non-routable address under one's control which does not have a listening SMTP server."
    },
    {
      "lang": "es",
      "value": "Sydent es un servidor de identidad para el protocolo de comunicaciones Matrix. Antes de la versi\u00f3n 2.5.6, si se configuraba para enviar correos electr\u00f3nicos utilizando TLS, Sydent no verificaba los certificados de los servidores SMTP. Esto hace que los correos electr\u00f3nicos de Sydent sean vulnerables a la interceptaci\u00f3n a trav\u00e9s de un ataque man-in-the-middle (MITM). Los atacantes con acceso privilegiado a la red pueden interceptar invitaciones a salas y correos electr\u00f3nicos de confirmaci\u00f3n de direcciones. Esto se ha parcheado en Sydent 2.5.6. Al aplicar el parche, aseg\u00farese de que Sydent conf\u00eda en el certificado del servidor al que se conecta. Esto deber\u00eda ocurrir autom\u00e1ticamente si se utilizan certificados emitidos correctamente. Aquellos que utilicen certificados autofirmados deben asegurarse de copiar su certificado de Autoridad de Certificaci\u00f3n, o su certificado autofirmado si s\u00f3lo utilizan uno, al almac\u00e9n de confianza de su sistema operativo. Como soluci\u00f3n alternativa, puede asegurarse de que los correos electr\u00f3nicos de Sydent no se env\u00eden configurando el servidor SMTP a una direcci\u00f3n de bucle de retorno o no enrutable bajo su control que no tenga un servidor SMTP a la escucha."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:N",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 9.3,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.8
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:matrix:sydent:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.5.6",
              "matchCriteriaId": "591FD375-A95C-4A68-A63F-E7DC33B4533A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.python.org/3/library/ssl.html?highlight=ssl#security-considerations",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/matrix-org/sydent/commit/1cd748307c6b168b66154e6c4db715d4b9551261",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/matrix-org/sydent/pull/574",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/matrix-org/sydent/releases/tag/v2.5.6",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/matrix-org/sydent/security/advisories/GHSA-p6hw-wm59-3g5g",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/python/cpython/issues/91826",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking"
      ]
    },
    {
      "url": "https://peps.python.org/pep-0476/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}