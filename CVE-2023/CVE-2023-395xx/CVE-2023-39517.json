{
  "id": "CVE-2023-39517",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-06-21T20:15:12.307",
  "lastModified": "2024-09-26T13:36:19.963",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Joplin is a free, open source note taking and to-do application. A Cross site scripting (XSS) vulnerability in affected versions allows clicking on an untrusted image link to execute arbitrary shell commands. The HTML sanitizer (`packages/renderer/htmlUtils.ts::sanitizeHtml`) preserves `<map>` `<area>` links. However, unlike `<a>` links, the `target` and `href` attributes are not removed. Additionally, because the note preview pane isn't sandboxed to prevent top navigation, links with `target` set to `_top` can replace the toplevel electron page. Because any toplevel electron page, with Joplin's setup, has access to `require` and can require node libraries, a malicious replacement toplevel page can import `child_process` and execute arbitrary shell commands. This issue has been fixed in commit 7c52c3e9a81a52ef1b42a951f9deb9d378d59b0f which is included in release version 2.12.8. Users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Joplin es una aplicaci\u00f3n gratuita y de c\u00f3digo abierto para tomar notas y tareas pendientes. Una vulnerabilidad de Cross-Site Scripting (XSS) en las versiones afectadas permite hacer clic en un enlace de imagen que no es de confianza para ejecutar comandos de shell arbitrarios. El sanitizante HTML (`packages/renderer/htmlUtils.ts::sanitizeHtml`) conserva los enlaces `` ``. Sin embargo, a diferencia de los enlaces `<a rel=\"nofollow\">`, los atributos `target` y `href` no se eliminan. Adem\u00e1s, debido a que el panel de vista previa de notas no est\u00e1 protegido para evitar la navegaci\u00f3n superior, los enlaces con \"destino\" configurado en \"_top\" pueden reemplazar la p\u00e1gina electr\u00f3nica de nivel superior. Debido a que cualquier p\u00e1gina electr\u00f3nica de nivel superior, con la configuraci\u00f3n de Joplin, tiene acceso a `require` y puede requerir librer\u00edas de nodos, una p\u00e1gina de nivel superior de reemplazo maliciosa puede importar `child_process` y ejecutar comandos de shell arbitrarios. Este problema se solucion\u00f3 en el commit 7c52c3e9a81a52ef1b42a951f9deb9d378d59b0f que se incluye en la versi\u00f3n 2.12.8. Se recomienda a los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad.</a>"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 8.2,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 5.3
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:joplin_project:joplin:*:*:*:*:*:-:*:*",
              "versionEndExcluding": "2.12.8",
              "matchCriteriaId": "23F5CA99-69DB-4D33-AE9A-E4BEAD09F57A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://developer.mozilla.org/en-US/docs/Web/HTML/Element/iframe#sandbox",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/laurent22/joplin/commit/7c52c3e9a81a52ef1b42a951f9deb9d378d59b0f",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/laurent22/joplin/security/advisories/GHSA-2h88-m32f-qh5m",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}