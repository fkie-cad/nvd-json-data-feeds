{
  "id": "CVE-2023-22745",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-01-19T23:15:26.907",
  "lastModified": "2023-01-26T20:25:23.487",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "tpm2-tss is an open source software implementation of the Trusted Computing Group (TCG) Trusted Platform Module (TPM) 2 Software Stack (TSS2). In affected versions `Tss2_RC_SetHandler` and `Tss2_RC_Decode` both index into `layer_handler` with an 8 bit layer number, but the array only has `TPM2_ERROR_TSS2_RC_LAYER_COUNT` entries, so trying to add a handler for higher-numbered layers or decode a response code with such a layer number reads/writes past the end of the buffer. This Buffer overrun, could result in arbitrary code execution. An example attack would be a MiTM bus attack that returns 0xFFFFFFFF for the RC. Given the common use case of TPM modules an attacker must have local access to the target machine with local system privileges which allows access to the TPM system. Usually TPM access requires administrative privilege."
    },
    {
      "lang": "es",
      "value": "tpm2-tss es una implementaci\u00f3n de software de c\u00f3digo abierto de la pila de software (TSS2) del m\u00f3dulo de plataforma segura (TPM) 2 de Trusted Computing Group (TCG). En las versiones afectadas, `Tss2_RC_SetHandler` y `Tss2_RC_Decode` indexan en `layer_handler` con un n\u00famero de capa de 8 bits, pero la matriz solo tiene entradas `TPM2_ERROR_TSS2_RC_LAYER_COUNT`, por lo que intentar agregar un controlador para capas con n\u00fameros m\u00e1s altos o decodificar un c\u00f3digo de respuesta con dicho n\u00famero de capa lee/escribe m\u00e1s all\u00e1 del final del b\u00fafer. Este desbordamiento del b\u00fafer podr\u00eda provocar la ejecuci\u00f3n de c\u00f3digo arbitrario. Un ataque de ejemplo ser\u00eda un ataque de bus MiTM que devuelve 0xFFFFFFFF para el RC. Dado el caso de uso com\u00fan de los m\u00f3dulos TPM, un atacante debe tener acceso local a la m\u00e1quina de destino con privilegios del sistema local que permitan el acceso al sistema TPM. Por lo general, el acceso a TPM requiere privilegios administrativos."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 6.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 6.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-120"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-120"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:tpm2_software_stack_project:tpm2_software_stack:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "4.0.0",
              "matchCriteriaId": "07A6A7AC-2EB7-4E1D-8DE1-F6043F2C263F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/tpm2-software/tpm2-tss/commit/306490c8d848c367faa2d9df81f5e69dab46ffb5",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tpm2-software/tpm2-tss/security/advisories/GHSA-4j3v-fh23-vx67",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}