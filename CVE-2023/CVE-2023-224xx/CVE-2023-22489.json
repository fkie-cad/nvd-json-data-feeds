{
  "id": "CVE-2023-22489",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-01-13T19:15:12.037",
  "lastModified": "2023-11-07T04:07:00.813",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Flarum is a discussion platform for websites. If the first post of a discussion is permanently deleted but the discussion stays visible, any actor who can view the discussion is able to create a new reply via the REST API, no matter the reply permission or lock status. This includes users that don't have a validated email. Guests cannot successfully create a reply because the API will fail with a 500 error when the user ID 0 is inserted into the database. This happens because when the first post of a discussion is permanently deleted, the `first_post_id` attribute of the discussion becomes `null` which causes access control to be skipped for all new replies. Flarum automatically makes discussions with zero comments invisible so an additional condition for this vulnerability is that the discussion must have at least one approved reply so that `discussions.comment_count` is still above zero after the post deletion. This can open the discussion to uncontrolled spam or just unintentional replies if users still had their tab open before the vulnerable discussion was locked and then post a reply when they shouldn't be able to. In combination with the email notification settings, this could also be used as a way to send unsolicited emails. Versions between `v1.3.0` and `v1.6.3` are impacted. The vulnerability has been fixed and published as flarum/core v1.6.3. All communities running Flarum should upgrade as soon as possible. There are no known workarounds.\n"
    },
    {
      "lang": "es",
      "value": "Flarum es una plataforma de discusi\u00f3n para sitios web. Si la primera publicaci\u00f3n de una discusi\u00f3n se elimina permanentemente pero la discusi\u00f3n permanece visible, cualquier actor que pueda ver la discusi\u00f3n podr\u00e1 crear una nueva respuesta a trav\u00e9s de la API REST, sin importar el permiso de respuesta o el estado de bloqueo. Esto incluye a los usuarios que no tienen un correo electr\u00f3nico validado. Los invitados no pueden crear correctamente una respuesta porque la API fallar\u00e1 con un error 500 cuando se inserte el ID de usuario 0 en la base de datos. Esto sucede porque cuando la primera publicaci\u00f3n de una discusi\u00f3n se elimina permanentemente, el atributo \"first_post_id\" de la discusi\u00f3n se vuelve \"nulo\", lo que hace que se omita el control de acceso para todas las respuestas nuevas. Flarum autom\u00e1ticamente hace invisibles las discusiones sin comentarios, por lo que una condici\u00f3n adicional para esta vulnerabilidad es que la discusi\u00f3n debe tener al menos una respuesta aprobada para que `discussions.comment_count` siga siendo superior a cero despu\u00e9s de la eliminaci\u00f3n de la publicaci\u00f3n. Esto puede abrir la discusi\u00f3n a spam no controlado o simplemente a respuestas no intencionales si los usuarios todav\u00eda ten\u00edan su pesta\u00f1a abierta antes de que se bloqueara la discusi\u00f3n vulnerable y luego publicar una respuesta cuando no deber\u00edan poder hacerlo. En combinaci\u00f3n con la configuraci\u00f3n de notificaci\u00f3n por correo electr\u00f3nico, esto tambi\u00e9n podr\u00eda usarse como una forma de enviar correos electr\u00f3nicos no solicitados. Las versiones entre `v1.3.0` y `v1.6.3` se ven afectadas. La vulnerabilidad ha sido reparada y publicada como flarum/core v1.6.3. Todas las comunidades que ejecutan Flarum deber\u00edan actualizar lo antes posible. No se conocen workarounds."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 3.5,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 3.5,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-862"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:flarum:flarum:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.3.0",
              "versionEndExcluding": "1.6.2",
              "matchCriteriaId": "0D9F27FD-AE4D-472E-8DF4-1EE22EBE7FCC"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/flarum/framework/commit/12f14112a0ecd1484d97330b82beb2a145919015",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/releases/tag/v1.6.3",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flarum/framework/security/advisories/GHSA-hph3-hv3c-7725",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}