{
  "id": "CVE-2023-41329",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-09-06T21:15:14.517",
  "lastModified": "2023-09-12T20:45:24.907",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "WireMock is a tool for mocking HTTP services. The proxy mode of WireMock, can be protected by the network restrictions configuration, as documented in Preventing proxying to and recording from specific target addresses. These restrictions can be configured using the domain names, and in such a case the configuration is vulnerable to the DNS rebinding attacks. A similar patch was applied in WireMock 3.0.0-beta-15 for the WireMock Webhook Extensions. The root cause of the attack is a defect in the logic which allows for a race condition triggered by a DNS server whose address expires in between the initial validation and the outbound network request that might go to a domain that was supposed to be prohibited. Control over a DNS service is required to exploit this attack, so it has high execution complexity and limited impact. This issue has been addressed in version 2.35.1 of wiremock-jre8 and wiremock-jre8-standalone, version 3.0.3 of wiremock and wiremock-standalone, version 2.6.1 of the python version of wiremock, and versions 2.35.1-1 and 3.0.3-1 of the wiremock/wiremock Docker container. Users are advised to upgrade. Users unable to upgrade should either configure firewall rules to define the list of permitted destinations or to configure WireMock to use IP addresses instead of the domain names."
    },
    {
      "lang": "es",
      "value": "WireMock es una herramienta para imitar servicios HTTP. El modo proxy de WireMock se puede proteger mediante la configuraci\u00f3n de restricciones de red, como se documenta en Preventing proxying y la grabaci\u00f3n desde direcciones de destino espec\u00edficas. Estas restricciones se pueden configurar utilizando los nombres de dominio y, en tal caso, la configuraci\u00f3n es vulnerable a los ataques de vinculaci\u00f3n de DNS. Se aplic\u00f3 un parche similar en WireMock 3.0.0-beta-15 para las extensiones WireMock Webhook. La causa principal del ataque es un defecto en la l\u00f3gica que permite una condici\u00f3n de ejecuci\u00f3n desencadenada por un servidor DNS cuya direcci\u00f3n expira entre la validaci\u00f3n inicial y la solicitud de red saliente que podr\u00eda ir a un dominio que se supon\u00eda estaba prohibido. Se requiere control sobre un servicio DNS para explotar este ataque, por lo que tiene una alta complejidad de ejecuci\u00f3n y un impacto limitado. Este problema se solucion\u00f3 en la versi\u00f3n 2.35.1 de wiremock-jre8 y wiremock-jre8-standalone, la versi\u00f3n 3.0.3 de wiremock y wiremock-standalone, la versi\u00f3n 2.6.1 de la versi\u00f3n Python de wiremock y las versiones 2.35.1-1 y 3.0.3-1 del contenedor Docker wiremock/wiremock. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar deben configurar reglas de firewall para definir la lista de destinos permitidos o configurar WireMock para usar direcciones IP en lugar de nombres de dominio."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 6.6,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.7,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:A/AC:H/PR:H/UI:N/S:U/C:L/I:L/A:L",
          "attackVector": "ADJACENT_NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 3.9,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 3.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-290"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:python_wiremock:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.6.1",
              "matchCriteriaId": "C996BA43-2702-4ECA-AB34-F6E7FA0811A2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:studio:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "2.32.0-17",
              "matchCriteriaId": "94D6D047-97F7-4326-AAF8-09ACB980D549"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:wiremock:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.35.1",
              "matchCriteriaId": "C970946B-2D32-441B-B920-43B29BDB31AD"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:wiremock:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.0.0",
              "versionEndExcluding": "3.0.3",
              "matchCriteriaId": "5E2F15FC-7298-49C1-9C37-6B0AE0C5B272"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:wiremock_docker:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.0.0",
              "versionEndExcluding": "2.35.1-1",
              "matchCriteriaId": "6D536C73-6C99-428A-9F41-A6452708B6D9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wiremock:wiremock_docker:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.0.0",
              "versionEndExcluding": "3.0.3-1",
              "matchCriteriaId": "6ED4EACC-77AA-476D-83C4-94F1646D0AEA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/wiremock/wiremock/security/advisories/GHSA-pmxq-pj47-j8j4",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://wiremock.org/docs/configuration/#preventing-proxying-to-and-recording-from-specific-target-addresses",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    }
  ]
}