{
  "id": "CVE-2023-48223",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-11-20T18:15:07.047",
  "lastModified": "2023-11-29T20:51:09.670",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "fast-jwt provides fast JSON Web Token (JWT) implementation. Prior to version 3.3.2, the fast-jwt library does not properly prevent JWT algorithm confusion for all public key types. The 'publicKeyPemMatcher' in 'fast-jwt/src/crypto.js' does not properly match all common PEM formats for public keys. To exploit this vulnerability, an attacker needs to craft a malicious JWT token containing the HS256 algorithm, signed with the public RSA key of the victim application. This attack will only work if the victim application utilizes a public key containing the `BEGIN RSA PUBLIC KEY` header. Applications using the RS256 algorithm, a public key with a `BEGIN RSA PUBLIC KEY` header, and calling the verify function without explicitly providing an algorithm, are vulnerable to this algorithm confusion attack which allows attackers to sign arbitrary payloads which will be accepted by the verifier. Version 3.3.2 contains a patch for this issue. As a workaround, change line 29 of `blob/master/src/crypto.js` to include a regular expression."
    },
    {
      "lang": "es",
      "value": "fast-jwt proporciona una implementaci\u00f3n r\u00e1pida de JSON Web Token (JWT). Antes de la versi\u00f3n 3.3.2, la librer\u00eda fast-jwt no evita adecuadamente la confusi\u00f3n del algoritmo JWT para todos los tipos de claves p\u00fablicas. El 'publicKeyPemMatcher' en 'fast-jwt/src/crypto.js' no coincide correctamente con todos los formatos PEM comunes para claves p\u00fablicas. Para explotar esta vulnerabilidad, un atacante necesita crear un token JWT malicioso que contenga el algoritmo HS256, firmado con la clave RSA p\u00fablica de la aplicaci\u00f3n v\u00edctima. Este ataque solo funcionar\u00e1 si la aplicaci\u00f3n v\u00edctima utiliza una clave p\u00fablica que contenga el encabezado \"BEGIN RSA PUBLIC KEY\". Las aplicaciones que utilizan el algoritmo RS256, una clave p\u00fablica con un encabezado \"BEGIN RSA PUBLIC KEY\", y que llaman a la funci\u00f3n de verificaci\u00f3n sin proporcionar expl\u00edcitamente un algoritmo, son vulnerables a este ataque de confusi\u00f3n de algoritmo que permite a los atacantes firmar payloads arbitrarios que ser\u00e1n aceptadas por el verificador. La versi\u00f3n 3.3.2 contiene un parche para este problema. Como workaround, cambie la l\u00ednea 29 de `blob/master/src/crypto.js` para incluir una expresi\u00f3n regular."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nearform:fast-jwt:*:*:*:*:*:node.js:*:*",
              "versionEndExcluding": "3.3.2",
              "matchCriteriaId": "04216FDF-08CB-4312-9068-BE70476DD1C4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/nearform/fast-jwt/blob/master/src/crypto.js#L29",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/nearform/fast-jwt/releases/tag/v3.3.2",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/nearform/fast-jwt/security/advisories/GHSA-c2ff-88x2-x9pg",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}