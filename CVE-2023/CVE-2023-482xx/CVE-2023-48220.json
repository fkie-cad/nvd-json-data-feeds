{
  "id": "CVE-2023-48220",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-02-20T18:15:50.350",
  "lastModified": "2024-02-20T19:50:53.960",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "Decidim is a participatory democracy framework. Starting in version 0.4.rc3 and prior to version 2.0.9 of the `devise_invitable` gem, the invites feature allows users to accept the invitation for an unlimited amount of time through the password reset functionality. This issue creates vulnerable dependencies starting in version 0.0.1.alpha3 and prior to versions 0.26.9, 0.27.5, and 0.28.0 of the `decidim,` `decidim-admin`, and `decidim-system` gems. When using the password reset functionality, the `devise_invitable` gem always accepts the pending invitation if the user has been invited. The only check done is if the user has been invited but the code does not ensure that the pending invitation is still valid as defined by the `invite_for` expiry period. Decidim sets this configuration to `2.weeks` so this configuration should be respected. The bug is in the `devise_invitable` gem and should be fixed there and the dependency should be upgraded in Decidim once the fix becomes available. `devise_invitable` to version `2.0.9` and above fix this issue. Versions 0.26.9, 0.27.5, and 0.28.0 of the `decidim,` `decidim-admin`, and `decidim-system` gems contain this fix. As a workaround, invitations can be cancelled directly from the database."
    },
    {
      "lang": "es",
      "value": "Decidim es un framework de democracia participativa. A partir de la versi\u00f3n 0.4.rc3 y antes de la versi\u00f3n 2.0.9 de la gema `devise_invitable`, la funci\u00f3n de invitaciones permite a los usuarios aceptar la invitaci\u00f3n por un per\u00edodo de tiempo ilimitado a trav\u00e9s de la funci\u00f3n de restablecimiento de contrase\u00f1a. Este problema crea dependencias vulnerables a partir de la versi\u00f3n 0.0.1.alpha3 y anteriores a las versiones 0.26.9, 0.27.5 y 0.28.0 de las gemas `decidim`, `decidim-admin` y `decidim-system`. Cuando se utiliza la funci\u00f3n de restablecimiento de contrase\u00f1a, la gema `devise_invitable` siempre acepta la invitaci\u00f3n pendiente si el usuario ha sido invitado. La \u00fanica verificaci\u00f3n realizada es si el usuario ha sido invitado pero el c\u00f3digo no garantiza que la invitaci\u00f3n pendiente siga siendo v\u00e1lida seg\u00fan lo definido por el per\u00edodo de vencimiento de `invite_for`. Decidim establece esta configuraci\u00f3n en `2.weeks` por lo que se debe respetar esta configuraci\u00f3n. El error est\u00e1 en la gema `devise_invitable` y deber\u00eda solucionarse all\u00ed y la dependencia deber\u00eda actualizarse en Decidim una vez que la soluci\u00f3n est\u00e9 disponible. `devise_invitable` a la versi\u00f3n `2.0.9` y superiores solucionan este problema. Las versiones 0.26.9, 0.27.5 y 0.28.0 de las gemas `decidim`, `decidim-admin` y `decidim-system` contienen esta soluci\u00f3n. Como workaround, las invitaciones se pueden cancelar directamente desde la base de datos."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-672"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/decidim/decidim/blob/d2d390578050772d1bdb6d731395f1afc39dcbfc/decidim-core/config/initializers/devise.rb#L134",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/commit/073e60e2e4224dd81815a784002ebba30f2ebb34",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/commit/b12800717a689c295a9ea680a38ca9f823d2c454",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.26.9",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.27.5",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/releases/tag/v0.28.0",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/decidim/decidim/security/advisories/GHSA-w3q8-m492-4pwp",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/scambra/devise_invitable/blob/41f58970ff76fb64382a9b9ea1bd530f7c3adab2/lib/devise_invitable/models.rb#L198",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/scambra/devise_invitable/commit/94d859c7de0829bf63f679ae5dd3cab2b866a098",
      "source": "security-advisories@github.com"
    }
  ]
}