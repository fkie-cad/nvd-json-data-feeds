{
  "id": "CVE-2023-50260",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-04-19T15:15:50.040",
  "lastModified": "2024-04-19T16:19:49.043",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Wazuh is a free and open source platform used for threat prevention, detection, and response. A wrong validation in the `host_deny` script allows to write any string in the `hosts.deny` file, which can end in an arbitrary command execution on the target system. This vulnerability is part of the active response feature, which can automatically triggers actions in response to alerts. By default, active responses are limited to a set of pre defined executables. This is enforced by only allowing executables stored under `/var/ossec/active-response/bin` to be run as an active response. However, the `/var/ossec/active-response/bin/host_deny` can be exploited. `host_deny` is used to add IP address to the `/etc/hosts.deny` file to block incoming connections on a service level by using TCP wrappers. Attacker can inject arbitrary command into the `/etc/hosts.deny` file and execute arbitrary command by using the spawn directive. The active response can be triggered by writing events either to the local `execd` queue on server or to the `ar` queue which forwards the events to agents. So, it can leads to LPE on server as root and RCE on agent as root. This vulnerability is fixed in 4.7.2."
    },
    {
      "lang": "es",
      "value": "Wazuh es una plataforma gratuita y de c\u00f3digo abierto que se utiliza para la prevenci\u00f3n, detecci\u00f3n y respuesta a amenazas. Una validaci\u00f3n incorrecta en el script `host_deny` permite escribir cualquier cadena en el archivo `hosts.deny`, lo que puede terminar en la ejecuci\u00f3n de un comando arbitrario en el sistema de destino. Esta vulnerabilidad es parte de la funci\u00f3n de respuesta activa, que puede desencadenar acciones autom\u00e1ticamente en respuesta a alertas. De forma predeterminada, las respuestas activas est\u00e1n limitadas a un conjunto de ejecutables predefinidos. Esto se aplica permitiendo que solo los ejecutables almacenados en `/var/ossec/active-response/bin` se ejecuten como una respuesta activa. Sin embargo, el `/var/ossec/active-response/bin/host_deny` puede ser explotado. `host_deny` se usa para agregar una direcci\u00f3n IP al archivo `/etc/hosts.deny` para bloquear conexiones entrantes en un nivel de servicio mediante el uso de contenedores TCP. El atacante puede inyectar un comando arbitrario en el archivo `/etc/hosts.deny` y ejecutar un comando arbitrario utilizando la directiva spawn. La respuesta activa se puede activar escribiendo eventos en la cola \"execd\" local en el servidor o en la cola \"ar\" que reenv\u00eda los eventos a los agentes. Por lo tanto, puede conducir a LPE en el servidor como ra\u00edz y a RCE en el agente como ra\u00edz. Esta vulnerabilidad se soluciona en 4.7.2."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/wazuh/wazuh/security/advisories/GHSA-mjq2-xf8g-68vw",
      "source": "security-advisories@github.com"
    }
  ]
}