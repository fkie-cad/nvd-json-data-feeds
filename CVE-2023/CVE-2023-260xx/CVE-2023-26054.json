{
  "id": "CVE-2023-26054",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-03-06T19:15:10.390",
  "lastModified": "2023-09-15T21:15:09.607",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "BuildKit is a toolkit for converting source code to build artifacts in an efficient, expressive and repeatable manner. In affected versions when the user sends a build request that contains a Git URL that contains credentials and the build creates a provenance attestation describing that build, these credentials could be visible from the provenance attestation. Git URL can be passed in two ways: 1) Invoking build directly from a URL with credentials. 2) If the client sends additional version control system (VCS) info hint parameters on builds from a local source. Usually, that would mean reading the origin URL from `.git/config` file. When a build is performed under specific conditions where credentials were passed to BuildKit they may be visible to everyone who has access to provenance attestation. Provenance attestations and VCS info hints were added in version v0.11.0. Previous versions are not vulnerable. In v0.10, when building directly from Git URL, the same URL could be visible in `BuildInfo` structure that is a predecessor of Provenance attestations. Previous versions are not vulnerable. This bug has been fixed in v0.11.4. Users are advised to upgrade. Users unable to upgrade may disable VCS info hints by setting `BUILDX_GIT_INFO=0`. `buildctl` does not set VCS hints based on `.git` directory, and values would need to be passed manually with `--opt`."
    },
    {
      "lang": "es",
      "value": "BuildKit es un conjunto de herramientas para convertir c\u00f3digo fuente para crear artefactos de manera eficiente, expresiva y repetible. En las versiones afectadas, cuando el usuario env\u00eda una solicitud de compilaci\u00f3n que contiene una URL de Git que contiene credenciales y la compilaci\u00f3n crea una atestaci\u00f3n de procedencia que describe esa compilaci\u00f3n, estas credenciales podr\u00edan ser visibles desde la atestaci\u00f3n de procedencia. La URL de Git se puede pasar de dos maneras: 1) Invocando la compilaci\u00f3n directamente desde una URL con credenciales. 2) Si el cliente env\u00eda par\u00e1metros de sugerencias de informaci\u00f3n del sistema de control de versiones (VCS) adicionales en compilaciones desde una fuente local. Por lo general, eso significar\u00eda leer la URL de origen del archivo `.git/config`. Cuando se realiza una compilaci\u00f3n en condiciones espec\u00edficas en las que se pasaron credenciales a BuildKit, es posible que sean visibles para todos los que tengan acceso a la certificaci\u00f3n de procedencia. En la versi\u00f3n v0.11.0 se agregaron certificaciones de procedencia y sugerencias de informaci\u00f3n de VCS. Las versiones anteriores no son vulnerables. En la versi\u00f3n 0.10, al compilar directamente desde la URL de Git, la misma URL podr\u00eda ser visible en la estructura `BuildInfo` que es una predecesora de las certificaciones de procedencia. Las versiones anteriores no son vulnerables. Este error se ha solucionado en v0.11.4. Se recomienda a los usuarios que actualicen. Los usuarios que no puedan actualizar pueden desactivar las sugerencias de informaci\u00f3n de VCS configurando `BUILDX_GIT_INFO=0`. `buildctl` no establece sugerencias de VCS basadas en el directorio `.git` y los valores deber\u00edan pasarse manualmente con `--opt`."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mobyproject:buildkit:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.10.0",
              "versionEndExcluding": "0.11.4",
              "matchCriteriaId": "B20CBA03-7DD3-4756-AE19-BE0B45272C1F"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/moby/buildkit/commit/75123c696506bdbca1ed69906479e200f1b62604",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/moby/buildkit/security/advisories/GHSA-gc89-7gcr-jxqc",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/LYZOKMMVX4SIEHPJW3SJUQGMO5YZCPHC/",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/XNF4OLYZRQE75EB5TW5N42FSXHBXGWFE/",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce@lists.fedoraproject.org/message/ZTE4ITXXPIWZEQ4HYQCB6N6GZIMWXDAI/",
      "source": "security-advisories@github.com"
    }
  ]
}