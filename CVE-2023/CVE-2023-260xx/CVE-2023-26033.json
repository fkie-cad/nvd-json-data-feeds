{
  "id": "CVE-2023-26033",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-02-25T00:15:11.170",
  "lastModified": "2023-03-06T18:54:30.003",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Gentoo soko is the code that powers packages.gentoo.org. Versions prior to 1.0.1 are vulnerable to SQL Injection, leading to a Denial of Service. If the user selects (in user preferences) the \"Recently Visited Packages\" view for the index page, the value of the `search_history` cookie is used as a base64 encoded comma separated list of atoms. These are string loaded directly into the SQL query with `atom = '%s'` format string. As a result, any user can modify the browser's cookie value and inject most SQL queries. A proof of concept malformed cookie was generated that wiped the database or changed it's content. On the database, only public data is stored, so there is no confidentiality issues to site users. If it is known that the database was modified, a full restoration of data is possible by performing a full database wipe and performing full update of all components. This issue is patched with commit id 5ae9ca83b73. Version 1.0.1 contains the patch. If users are unable to upgrade immediately, the following workarounds may be applied: (1.) Use a proxy to always drop the `search_history` cookie until upgraded. The impact on user experience is low. (2.) Sanitize to the value of `search_history` cookie after base64 decoding it."
    },
    {
      "lang": "es",
      "value": "Gentoo soko es el c\u00f3digo que impulsa a packages.gentoo.org. Las versiones anteriores a la 1.0.1 son vulnerables a la inyecci\u00f3n SQL, lo que provoca una denegaci\u00f3n de servicio. Si el usuario selecciona (en las preferencias del usuario) la vista \"Paquetes visitados recientemente\" para la p\u00e1gina de \u00edndice, el valor de la cookie `search_history` se utiliza como una lista de \u00e1tomos separados por comas codificados en base64. Estas son cadenas cargadas directamente en la consulta SQL con una cadena de formato `atom = '%s'`. Como resultado, cualquier usuario puede modificar el valor de la cookie del navegador e inyectar la mayor\u00eda de las consultas SQL. Se gener\u00f3 una cookie de prueba de concepto con formato incorrecto que borr\u00f3 la base de datos o cambi\u00f3 su contenido. En la base de datos, s\u00f3lo se almacenan datos p\u00fablicos, por lo que no hay problemas de confidencialidad para los usuarios del sitio. Si se sabe que la base de datos fue modificada, es posible realizar una restauraci\u00f3n completa de los datos realizando un borrado completo de la base de datos y una actualizaci\u00f3n completa de todos los componentes. Este problema se solucion\u00f3 en el commit con ID 5ae9ca83b73. La versi\u00f3n 1.0.1 contiene el parche. Si los usuarios no pueden actualizar inmediatamente, se pueden aplicar los siguientes wokarounds: (1.) Utilice un proxy para descartar siempre la cookie `search_history` hasta que se actualice. El impacto en la experiencia del usuario es bajo. (2.) desinfectar el valor de la cookie `search_history` despu\u00e9s de decodificarla en base64."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:gentoo:soko:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.0.1",
              "matchCriteriaId": "4BFAD223-9E9C-4854-B1F3-0A17CD7F5E43"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/gentoo/soko/security/advisories/GHSA-gp8g-jfq9-5q2g",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://gitweb.gentoo.org/sites/soko.git/commit/?id=5ae9ca83b735804f2bd405592983a73d7fcc42f4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    }
  ]
}