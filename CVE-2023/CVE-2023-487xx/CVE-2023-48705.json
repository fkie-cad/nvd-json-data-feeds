{
  "id": "CVE-2023-48705",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2023-11-22T16:15:09.627",
  "lastModified": "2023-11-29T02:25:23.870",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Nautobot is a Network Source of Truth and Network Automation Platform built as a web application All users of Nautobot versions earlier than 1.6.6 or 2.0.5 are potentially affected by a cross-site scripting vulnerability. Due to incorrect usage of Django's `mark_safe()` API when rendering certain types of user-authored content; including custom links, job buttons, and computed fields; it is possible that users with permission to create or edit these types of content could craft a malicious payload (such as JavaScript code) that would be executed when rendering pages containing this content. The maintainers have fixed the incorrect uses of `mark_safe()` (generally by replacing them with appropriate use of `format_html()` instead) to prevent such malicious data from being executed. Users on Nautobot 1.6.x LTM should upgrade to v1.6.6 and users on Nautobot 2.0.x should upgrade to v2.0.5. Appropriate object permissions can and should be applied to restrict which users are permitted to create or edit the aforementioned types of user-authored content. Other than that, there is no direct workaround available."
    },
    {
      "lang": "es",
      "value": "Nautobot es una plataforma de automatizaci\u00f3n de red y fuente de verdad de red creada como una aplicaci\u00f3n web. Todos los usuarios de versiones de Nautobot anteriores a 1.6.6 o 2.0.5 se ven potencialmente afectados por una vulnerabilidad de cross-site scripting. Debido al uso incorrecto de la API `mark_safe()` de Django al representar ciertos tipos de contenido escrito por el usuario; incluidos enlaces personalizados, botones de trabajo y campos calculados; Es posible que los usuarios con permiso para crear o editar este tipo de contenido puedan crear un payload malicioso (como c\u00f3digo JavaScript) que se ejecutar\u00eda al representar p\u00e1ginas que contengan este contenido. Los mantenedores han solucionado los usos incorrectos de `mark_safe()` (generalmente reemplaz\u00e1ndolos con el uso apropiado de `format_html()`) para evitar que se ejecuten dichos datos maliciosos. Los usuarios de Nautobot 1.6.x LTM deben actualizar a v1.6.6 y los usuarios de Nautobot 2.0.x deben actualizar a v2.0.5. Se pueden y se deben aplicar permisos de objetos apropiados para restringir qu\u00e9 usuarios pueden crear o editar los tipos de contenido escritos por el usuario antes mencionados. Aparte de eso, no existe ning\u00fan workaround directo disponible."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:H/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW",
          "baseScore": 7.1,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.3,
        "impactScore": 5.3
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:networktocode:nautobot:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.6.6",
              "matchCriteriaId": "BB340A94-5C6A-45D2-B2DA-641084D4B9E0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:networktocode:nautobot:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.0.0",
              "versionEndExcluding": "2.0.5",
              "matchCriteriaId": "AEA9BE2A-BB72-4EFE-A376-B91223E0F6F0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.html.format_html",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://docs.djangoproject.com/en/3.2/ref/utils/#django.utils.safestring.mark_safe",
      "source": "security-advisories@github.com",
      "tags": [
        "Technical Description"
      ]
    },
    {
      "url": "https://github.com/nautobot/nautobot/commit/362850f5a94689a4c75e3188bf6de826c3b012b2",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nautobot/nautobot/commit/54abe23331b6c3d0d82bf1b028c679b1d200920d",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nautobot/nautobot/pull/4832",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nautobot/nautobot/pull/4833",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://github.com/nautobot/nautobot/security/advisories/GHSA-cf9f-wmhp-v4pr",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}