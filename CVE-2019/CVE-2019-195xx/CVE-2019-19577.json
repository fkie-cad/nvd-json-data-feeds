{
  "id": "CVE-2019-19577",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2019-12-11T18:16:19.270",
  "lastModified": "2023-11-07T03:07:42.043",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in Xen through 4.12.x allowing x86 AMD HVM guest OS users to cause a denial of service or possibly gain privileges by triggering data-structure access during pagetable-height updates. When running on AMD systems with an IOMMU, Xen attempted to dynamically adapt the number of levels of pagetables (the pagetable height) in the IOMMU according to the guest's address space size. The code to select and update the height had several bugs. Notably, the update was done without taking a lock which is necessary for safe operation. A malicious guest administrator can cause Xen to access data structures while they are being modified, causing Xen to crash. Privilege escalation is thought to be very difficult but cannot be ruled out. Additionally, there is a potential memory leak of 4kb per guest boot, under memory pressure. Only Xen on AMD CPUs is vulnerable. Xen running on Intel CPUs is not vulnerable. ARM systems are not vulnerable. Only systems where guests are given direct access to physical devices are vulnerable. Systems which do not use PCI pass-through are not vulnerable. Only HVM guests can exploit the vulnerability. PV and PVH guests cannot. All versions of Xen with IOMMU support are vulnerable."
    },
    {
      "lang": "es",
      "value": "Se detect\u00f3 un problema en Xen versiones hasta 4.12.x permitiendo a usuarios de Sistema Operativo Invitado HVM de AMD en x86 causar una denegaci\u00f3n de servicio o posiblemente conseguir privilegios al activar el acceso a la estructura de datos durante las actualizaciones de altura de la tabla de p\u00e1ginas. Al ejecutarse en sistemas AMD con una IOMMU, Xen intent\u00f3 adaptar din\u00e1micamente el n\u00famero de niveles de tablas de p\u00e1ginas (la altura de la tabla de p\u00e1ginas) en la IOMMU de acuerdo con el tama\u00f1o del espacio de direcciones del invitado. El c\u00f3digo para seleccionar y actualizar la altura ten\u00eda varios errores. Notablemente, la actualizaci\u00f3n se realiz\u00f3 sin tomar un bloqueo que es necesario para una operaci\u00f3n segura. Un administrador invitado malicioso puede causar que Xen acceda a las estructuras de datos mientras se est\u00e1n modificando, provocando que Xen se bloquee. Se cree que una escalada de privilegios es muy dif\u00edcil, pero no se puede descartar. Adem\u00e1s, se presenta una p\u00e9rdida potencial de memoria de 4 kb por arranque de invitado, bajo presi\u00f3n de memoria. Solo Xen en las CPU AMD es vulnerable. Xen que se ejecuta en CPU de Intel no es vulnerable. Los sistemas ARM no son vulnerables. Solo los sistemas donde los invitados tienen acceso directo a dispositivos f\u00edsicos son vulnerables. Los sistemas que no utilizan la transferencia PCI no son vulnerables. Solo los invitados de HVM pueden explotar la vulnerabilidad. Los invitados PV y PVH no pueden. Todas las versiones de Xen con soporte de IOMMU son vulnerables."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:P/AC:L/PR:H/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "PHYSICAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.2,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 6.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.2
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 3.9,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        },
        {
          "lang": "en",
          "value": "CWE-662"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "4.12.1",
              "matchCriteriaId": "44BCD11F-9BBA-47D2-94DF-C1E52317A7B3"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:31:*:*:*:*:*:*:*",
              "matchCriteriaId": "80F0FA5D-8D3B-4C0E-81E2-87998286AF33"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://lists.opensuse.org/opensuse-security-announce/2020-01/msg00011.html",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/34HBFTYNMQMWIO2GGK7DB6KV4M6R5YPV/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/D5R73AYE53QA32KTMHUVKCX6E52CIS43/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://seclists.org/bugtraq/2020/Jan/21",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://security.gentoo.org/glsa/202003-56",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://www.debian.org/security/2020/dsa-4602",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://xenbits.xen.org/xsa/advisory-311.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}