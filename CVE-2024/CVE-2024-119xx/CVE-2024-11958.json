{
  "id": "CVE-2024-11958",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2025-03-20T10:15:26.030",
  "lastModified": "2025-07-29T18:57:39.893",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A SQL injection vulnerability exists in the `duckdb_retriever` component of the run-llama/llama_index repository, specifically in the latest version. The vulnerability arises from the construction of SQL queries without using prepared statements, allowing an attacker to inject arbitrary SQL code. This can lead to remote code execution (RCE) by installing the shellfs extension and executing malicious commands."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de inyecci\u00f3n SQL en el componente `duckdb_retriever` del repositorio run-llama/llama_index, concretamente en la \u00faltima versi\u00f3n. Esta vulnerabilidad surge de la construcci\u00f3n de consultas SQL sin usar sentencias preparadas, lo que permite a un atacante inyectar c\u00f3digo SQL arbitrario. Esto puede provocar la ejecuci\u00f3n remota de c\u00f3digo (RCE) al instalar la extensi\u00f3n shellfs y ejecutar comandos maliciosos."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-89"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:llamaindex:llamaindex:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.4.0",
              "matchCriteriaId": "9E4975FF-6556-41BF-9800-9AB131D9C41C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/run-llama/llama_index/commit/35bd221e948e40458052d30c6ef2779bc965b6d0",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/8ddf66e1-f74c-4d53-992b-76bc45cacac1",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}