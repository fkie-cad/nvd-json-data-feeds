{
  "id": "CVE-2024-47606",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-12-12T02:03:32.220",
  "lastModified": "2024-12-12T02:03:32.220",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "GStreamer is a library for constructing graphs of media-handling components. An integer underflow has been detected in the function qtdemux_parse_theora_extension within qtdemux.c. The vulnerability occurs due to an underflow of the gint size variable, which causes size to hold a large unintended value when cast to an unsigned integer. This 32-bit negative value is then cast to a 64-bit unsigned integer (0xfffffffffffffffa) in a subsequent call to gst_buffer_new_and_alloc. The function gst_buffer_new_allocate then attempts to allocate memory, eventually calling _sysmem_new_block. The function _sysmem_new_block adds alignment and header size to the (unsigned) size, causing the overflow of the 'slice_size' variable. As a result, only 0x89 bytes are allocated, despite the large input size. When the following memcpy call occurs in gst_buffer_fill, the data from the input file will overwrite the content of the GstMapInfo info structure. Finally, during the call to gst_memory_unmap, the overwritten memory may cause a function pointer hijack, as the mem->allocator->mem_unmap_full function is called with a corrupted pointer. This function pointer overwrite could allow an attacker to alter the execution flow of the program, leading to arbitrary code execution. This vulnerability is fixed in 1.24.10."
    },
    {
      "lang": "es",
      "value": "GStreamer es una librer\u00eda para construir gr\u00e1ficos de componentes de manejo de medios. Se ha detectado un desbordamiento de enteros en la funci\u00f3n qtdemux_parse_theora_extension dentro de qtdemux.c. La vulnerabilidad ocurre debido a un desbordamiento de la variable gint size, que hace que size contenga un valor grande no deseado cuando se convierte en un entero sin signo. Este valor negativo de 32 bits se convierte luego en un entero sin signo de 64 bits (0xfffffffffffffffa) en una llamada posterior a gst_buffer_new_and_alloc. La funci\u00f3n gst_buffer_new_allocate luego intenta asignar memoria, llamando finalmente a _sysmem_new_block. La funci\u00f3n _sysmem_new_block agrega alineaci\u00f3n y tama\u00f1o de encabezado al tama\u00f1o (sin signo), lo que causa el desbordamiento de la variable 'slice_size'. Como resultado, solo se asignan 0x89 bytes, a pesar del gran tama\u00f1o de entrada. Cuando se produce la siguiente llamada a memcpy en gst_buffer_fill, los datos del archivo de entrada sobrescribir\u00e1n el contenido de la estructura de informaci\u00f3n GstMapInfo. Por \u00faltimo, durante la llamada a gst_memory_unmap, la memoria sobrescrita puede provocar un secuestro del puntero de funci\u00f3n, ya que se llama a la funci\u00f3n mem-&gt;allocator-&gt;mem_unmap_full con un puntero da\u00f1ado. Esta sobrescritura del puntero de funci\u00f3n podr\u00eda permitir a un atacante alterar el flujo de ejecuci\u00f3n del programa, lo que provocar\u00eda la ejecuci\u00f3n de c\u00f3digo arbitrario. Esta vulnerabilidad se corrigi\u00f3 en la versi\u00f3n 1.24.10."
    }
  ],
  "metrics": {
    "cvssMetricV40": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "4.0",
          "vectorString": "CVSS:4.0/AV:L/AC:L/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:N/SI:N/SA:N/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:X/AU:X/R:X/V:X/RE:X/U:X",
          "baseScore": 8.6,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "attackRequirements": "NONE",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "vulnerableSystemConfidentiality": "HIGH",
          "vulnerableSystemIntegrity": "HIGH",
          "vulnerableSystemAvailability": "HIGH",
          "subsequentSystemConfidentiality": "NONE",
          "subsequentSystemIntegrity": "NONE",
          "subsequentSystemAvailability": "NONE",
          "exploitMaturity": "NOT_DEFINED",
          "confidentialityRequirements": "NOT_DEFINED",
          "integrityRequirements": "NOT_DEFINED",
          "availabilityRequirements": "NOT_DEFINED",
          "modifiedAttackVector": "NOT_DEFINED",
          "modifiedAttackComplexity": "NOT_DEFINED",
          "modifiedAttackRequirements": "NOT_DEFINED",
          "modifiedPrivilegesRequired": "NOT_DEFINED",
          "modifiedUserInteraction": "NOT_DEFINED",
          "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED",
          "modifiedVulnerableSystemIntegrity": "NOT_DEFINED",
          "modifiedVulnerableSystemAvailability": "NOT_DEFINED",
          "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED",
          "modifiedSubsequentSystemIntegrity": "NOT_DEFINED",
          "modifiedSubsequentSystemAvailability": "NOT_DEFINED",
          "safety": "NOT_DEFINED",
          "automatable": "NOT_DEFINED",
          "recovery": "NOT_DEFINED",
          "valueDensity": "NOT_DEFINED",
          "vulnerabilityResponseEffort": "NOT_DEFINED",
          "providerUrgency": "NOT_DEFINED"
        }
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-190"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://gitlab.freedesktop.org/gstreamer/gstreamer/-/merge_requests/8032.patch",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://gstreamer.freedesktop.org/security/sa-2024-0014.html",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://securitylab.github.com/advisories/GHSL-2024-166_Gstreamer/",
      "source": "security-advisories@github.com"
    }
  ]
}