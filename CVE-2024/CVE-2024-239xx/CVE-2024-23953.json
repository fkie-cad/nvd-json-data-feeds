{
  "id": "CVE-2024-23953",
  "sourceIdentifier": "security@apache.org",
  "published": "2025-01-28T09:15:09.187",
  "lastModified": "2025-02-18T19:15:15.100",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Use of Arrays.equals() in LlapSignerImpl in\u00a0Apache Hive to compare message signatures\u00a0allows attacker to forge a valid signature for an arbitrary message byte by byte. The attacker should be an authorized user of the product to perform this attack.\u00a0Users are recommended to upgrade to version 4.0.0, which fixes this issue.\n\nThe problem occurs when an application doesn\u2019t use a constant-time algorithm for validating a signature.\u00a0The method Arrays.equals()\u00a0returns false\u00a0right away when it sees that one of the input\u2019s bytes are different. It means that the comparison time depends on the contents of the arrays. This little thing may allow an attacker to forge a valid signature for an arbitrary message byte by byte.\u00a0So it might allow malicious users to submit splits/work with selected signatures to LLAP without running as a privileged user, potentially leading to DDoS attack.\n\nMore details in the reference section."
    },
    {
      "lang": "es",
      "value": "El uso de Arrays.equals() en LlapSignerImpl en Apache Hive para comparar firmas de mensajes permite a un atacante falsificar una firma v\u00e1lida para un mensaje arbitrario byte a byte. El atacante debe ser un usuario autorizado del producto para realizar este ataque. Se recomienda a los usuarios que actualicen a la versi\u00f3n 4.0.0, que soluciona este problema. El problema ocurre cuando una aplicaci\u00f3n no utiliza un algoritmo de tiempo constante para validar una firma. El m\u00e9todo Arrays.equals() devuelve falso de inmediato cuando ve que uno de los bytes de entrada es diferente. Significa que el tiempo de comparaci\u00f3n depende del contenido de las matrices. Esta peque\u00f1a cosa puede permitir a un atacante falsificar una firma v\u00e1lida para un mensaje arbitrario byte a byte. Por lo tanto, podr\u00eda permitir que los usuarios malintencionados env\u00eden divisiones/trabajos con firmas seleccionadas a LLAP sin ejecutarse como un usuario privilegiado, lo que podr\u00eda conducir a un ataque DDoS. M\u00e1s detalles en la secci\u00f3n de referencia."
    }
  ],
  "metrics": {},
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-208"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://blog.gypsyengineer.com/en/security/preventing-timing-attacks-with-codeql.html",
      "source": "security@apache.org"
    },
    {
      "url": "https://cqr.company/web-vulnerabilities/timing-attacks/",
      "source": "security@apache.org"
    },
    {
      "url": "https://github.com/apache/hive",
      "source": "security@apache.org"
    },
    {
      "url": "https://github.com/apache/hive/commit/b418e3c9f479ba8e7d31e6470306111002ffa809",
      "source": "security@apache.org"
    },
    {
      "url": "https://issues.apache.org/jira/browse/HIVE-28030",
      "source": "security@apache.org"
    },
    {
      "url": "https://lists.apache.org/thread/0nloywj49nbtlc6l3c6363qvq7o1ztb7",
      "source": "security@apache.org"
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2025/01/28/3",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}