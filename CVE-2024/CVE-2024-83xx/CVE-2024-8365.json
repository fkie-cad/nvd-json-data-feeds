{
  "id": "CVE-2024-8365",
  "sourceIdentifier": "security@hashicorp.com",
  "published": "2024-09-02T05:15:17.823",
  "lastModified": "2024-09-04T14:37:03.543",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Vault Community Edition and Vault Enterprise experienced a regression where functionality that HMAC\u2019d sensitive headers in the configured audit device, specifically client tokens and token accessors, was removed. This resulted in the plaintext values of client tokens and token accessors being stored in the audit log. This vulnerability, CVE-2024-8365, was fixed in Vault Community Edition and Vault Enterprise 1.17.5 and Vault Enterprise 1.16.9."
    },
    {
      "lang": "es",
      "value": "Vault Community Edition y Vault Enterprise experimentaron una regresi\u00f3n en la que se elimin\u00f3 la funcionalidad que codificaba mediante HMAC los encabezados confidenciales en el dispositivo de auditor\u00eda configurado, espec\u00edficamente los tokens de cliente y los descriptores de acceso de token. Esto provoc\u00f3 que los valores de texto sin formato de los tokens de cliente y los descriptores de acceso de token se almacenaran en el registro de auditor\u00eda. Esta vulnerabilidad, CVE-2024-8365, se solucion\u00f3 en Vault Community Edition y Vault Enterprise 1.17.5 y Vault Enterprise 1.16.9."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      },
      {
        "source": "security@hashicorp.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:R/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.2,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.7,
        "impactScore": 4.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-532"
        }
      ]
    },
    {
      "source": "security@hashicorp.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-532"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "1.16.9",
              "matchCriteriaId": "42D075A3-0E7A-4EC6-96AF-55CD4B5E0722"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:-:*:*:*",
              "versionEndExcluding": "1.17.5",
              "matchCriteriaId": "7249EEB1-D26D-4924-A69A-17C63F7B0693"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:hashicorp:vault:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "1.17.0",
              "versionEndExcluding": "1.17.5",
              "matchCriteriaId": "61BDF0C9-6DA7-496D-8181-6EDF20271239"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.hashicorp.com/t/hcsec-2024-18-vault-leaks-client-token-and-token-accessor-in-audit-devices/",
      "source": "security@hashicorp.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}