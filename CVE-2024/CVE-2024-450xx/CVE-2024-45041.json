{
  "id": "CVE-2024-45041",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-09-09T15:15:11.940",
  "lastModified": "2024-09-18T17:31:53.903",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "External Secrets Operator is a Kubernetes operator that integrates external secret management systems. The external-secrets has a deployment called default-external-secrets-cert-controller, which is bound with a same-name ClusterRole. This ClusterRole has \"get/list\" verbs of secrets resources. It also has path/update verb of validatingwebhookconfigurations resources.  This can be used to abuse the SA token of the deployment to retrieve or get ALL secrets in the whole cluster, capture and log all data from requests attempting to update Secrets, or make a webhook deny all Pod create and update requests. This vulnerability is fixed in 0.10.2."
    },
    {
      "lang": "es",
      "value": "External Secrets Operator es un operador de Kubernetes que integra sistemas de administraci\u00f3n de secretos externos. external-secrets tiene una implementaci\u00f3n llamada default-external-secrets-cert-controller, que est\u00e1 vinculada con un ClusterRole del mismo nombre. Este ClusterRole tiene verbos de \"obtenci\u00f3n/enumeraci\u00f3n\" de recursos de secretos. Tambi\u00e9n tiene verbos de ruta/actualizaci\u00f3n de recursos de configuraci\u00f3n de webhook de validaci\u00f3n. Esto se puede usar para abusar del token SA de la implementaci\u00f3n para recuperar u obtener TODOS los secretos en todo el cl\u00faster, capturar y registrar todos los datos de las solicitudes que intentan actualizar secretos o hacer que un webhook deniegue todas las solicitudes de creaci\u00f3n y actualizaci\u00f3n de pods. Esta vulnerabilidad se corrigi\u00f3 en la versi\u00f3n 0.10.2."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH",
          "baseScore": 8.3,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-732"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:external-secrets:external_secrets_operator:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.10.2",
              "matchCriteriaId": "E9FE8A81-3B52-4ACB-A0C0-32008302E35A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/external-secrets/external-secrets/commit/428a452fd2ad45935312f2c2c0d40bc37ce6e67c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/external-secrets/external-secrets/security/advisories/GHSA-qwgc-rr35-h4x9",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}