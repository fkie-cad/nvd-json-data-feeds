{
  "id": "CVE-2024-46848",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-09-27T13:15:16.657",
  "lastModified": "2024-09-30T12:45:57.823",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nperf/x86/intel: Limit the period on Haswell\n\nRunning the ltp test cve-2015-3290 concurrently reports the following\nwarnings.\n\nperfevents: irq loop stuck!\n  WARNING: CPU: 31 PID: 32438 at arch/x86/events/intel/core.c:3174\n  intel_pmu_handle_irq+0x285/0x370\n  Call Trace:\n   <NMI>\n   ? __warn+0xa4/0x220\n   ? intel_pmu_handle_irq+0x285/0x370\n   ? __report_bug+0x123/0x130\n   ? intel_pmu_handle_irq+0x285/0x370\n   ? __report_bug+0x123/0x130\n   ? intel_pmu_handle_irq+0x285/0x370\n   ? report_bug+0x3e/0xa0\n   ? handle_bug+0x3c/0x70\n   ? exc_invalid_op+0x18/0x50\n   ? asm_exc_invalid_op+0x1a/0x20\n   ? irq_work_claim+0x1e/0x40\n   ? intel_pmu_handle_irq+0x285/0x370\n   perf_event_nmi_handler+0x3d/0x60\n   nmi_handle+0x104/0x330\n\nThanks to Thomas Gleixner's analysis, the issue is caused by the low\ninitial period (1) of the frequency estimation algorithm, which triggers\nthe defects of the HW, specifically erratum HSW11 and HSW143. (For the\ndetails, please refer https://lore.kernel.org/lkml/87plq9l5d2.ffs@tglx/)\n\nThe HSW11 requires a period larger than 100 for the INST_RETIRED.ALL\nevent, but the initial period in the freq mode is 1. The erratum is the\nsame as the BDM11, which has been supported in the kernel. A minimum\nperiod of 128 is enforced as well on HSW.\n\nHSW143 is regarding that the fixed counter 1 may overcount 32 with the\nHyper-Threading is enabled. However, based on the test, the hardware\nhas more issues than it tells. Besides the fixed counter 1, the message\n'interrupt took too long' can be observed on any counter which was armed\nwith a period < 32 and two events expired in the same NMI. A minimum\nperiod of 32 is enforced for the rest of the events.\nThe recommended workaround code of the HSW143 is not implemented.\nBecause it only addresses the issue for the fixed counter. It brings\nextra overhead through extra MSR writing. No related overcounting issue\nhas been reported so far."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: perf/x86/intel: Limitar el per\u00edodo en Haswell La ejecuci\u00f3n de la prueba ltp cve-2015-3290 al mismo tiempo informa las siguientes advertencias. perfevents: \u00a1bucle irq atascado! ADVERTENCIA: CPU: 31 PID: 32438 en arch/x86/events/intel/core.c:3174 intel_pmu_handle_irq+0x285/0x370 Rastreo de llamadas:  ? __warn+0xa4/0x220 ? intel_pmu_handle_irq+0x285/0x370 ? __report_bug+0x123/0x130 ? intel_pmu_handle_irq+0x285/0x370 ? __report_bug+0x123/0x130 ? intel_pmu_handle_irq+0x285/0x370 ? report_bug+0x3e/0xa0 ? handle_bug+0x3c/0x70 ? exc_invalid_op+0x18/0x50 ? asm_exc_invalid_op+0x1a/0x20 ? irq_work_claim+0x1e/0x40 ? intel_pmu_handle_irq+0x285/0x370 perf_event_nmi_handler+0x3d/0x60 nmi_handle+0x104/0x330 Gracias al an\u00e1lisis de Thomas Gleixner, el problema es causado por el bajo per\u00edodo inicial (1) del algoritmo de estimaci\u00f3n de frecuencia, que desencadena los defectos del HW, espec\u00edficamente las erratas HSW11 y HSW143. (Para conocer los detalles, consulte https://lore.kernel.org/lkml/87plq9l5d2.ffs@tglx/) El HSW11 requiere un per\u00edodo mayor a 100 para el evento INST_RETIRED.ALL, pero el per\u00edodo inicial en el modo freq es 1. La errata es la misma que la del BDM11, que ha sido compatible con el kernel. Tambi\u00e9n se aplica un per\u00edodo m\u00ednimo de 128 en HSW. HSW143 se refiere a que el contador fijo 1 puede sobrecontar 32 con Hyper-Threading habilitado. Sin embargo, seg\u00fan la prueba, el hardware tiene m\u00e1s problemas de los que indica. Adem\u00e1s del contador fijo 1, se puede observar el mensaje \"la interrupci\u00f3n tard\u00f3 demasiado\" en cualquier contador que se haya armado con un per\u00edodo &lt;32 y dos eventos hayan expirado en el mismo NMI. Se aplica un per\u00edodo m\u00ednimo de 32 para el resto de los eventos. El c\u00f3digo de workaround recomendado del HSW143 no est\u00e1 implementado. Porque solo soluciona el problema del contador fijo. Implica una sobrecarga adicional a trav\u00e9s de la escritura adicional del MSR. Hasta el momento, no se ha informado de ning\u00fan problema de conteo excesivo relacionado."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/0eaf812aa1506704f3b78be87036860e5d0fe81d",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/15210b7c8caff4929f25d049ef8404557f8ae468",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/25dfc9e357af8aed1ca79b318a73f2c59c1f0b2b",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/8717dc35c0e5896f4110f4b3882f7ff787a5f73d",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}