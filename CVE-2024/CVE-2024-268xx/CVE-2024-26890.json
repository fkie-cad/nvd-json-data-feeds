{
  "id": "CVE-2024-26890",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-04-17T11:15:10.423",
  "lastModified": "2024-04-17T12:48:07.510",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nBluetooth: btrtl: fix out of bounds memory access\n\nThe problem is detected by KASAN.\nbtrtl driver uses private hci data to store 'struct btrealtek_data'.\nIf btrtl driver is used with btusb, then memory for private hci data\nis allocated in btusb. But no private data is allocated after hci_dev,\nwhen btrtl is used with hci_h5.\n\nThis commit adds memory allocation for hci_h5 case.\n\n ==================================================================\n BUG: KASAN: slab-out-of-bounds in btrtl_initialize+0x6cc/0x958 [btrtl]\n Write of size 8 at addr ffff00000f5a5748 by task kworker/u9:0/76\n\n Hardware name: Pine64 PinePhone (1.2) (DT)\n Workqueue: hci0 hci_power_on [bluetooth]\n Call trace:\n  dump_backtrace+0x9c/0x128\n  show_stack+0x20/0x38\n  dump_stack_lvl+0x48/0x60\n  print_report+0xf8/0x5d8\n  kasan_report+0x90/0xd0\n  __asan_store8+0x9c/0xc0\n  \t [btrtl]\n  h5_btrtl_setup+0xd0/0x2f8 [hci_uart]\n  h5_setup+0x50/0x80 [hci_uart]\n  hci_uart_setup+0xd4/0x260 [hci_uart]\n  hci_dev_open_sync+0x1cc/0xf68 [bluetooth]\n  hci_dev_do_open+0x34/0x90 [bluetooth]\n  hci_power_on+0xc4/0x3c8 [bluetooth]\n  process_one_work+0x328/0x6f0\n  worker_thread+0x410/0x778\n  kthread+0x168/0x178\n  ret_from_fork+0x10/0x20\n\n Allocated by task 53:\n  kasan_save_stack+0x3c/0x68\n  kasan_save_track+0x20/0x40\n  kasan_save_alloc_info+0x68/0x78\n  __kasan_kmalloc+0xd4/0xd8\n  __kmalloc+0x1b4/0x3b0\n  hci_alloc_dev_priv+0x28/0xa58 [bluetooth]\n  hci_uart_register_device+0x118/0x4f8 [hci_uart]\n  h5_serdev_probe+0xf4/0x178 [hci_uart]\n  serdev_drv_probe+0x54/0xa0\n  really_probe+0x254/0x588\n  __driver_probe_device+0xc4/0x210\n  driver_probe_device+0x64/0x160\n  __driver_attach_async_helper+0x88/0x158\n  async_run_entry_fn+0xd0/0x388\n  process_one_work+0x328/0x6f0\n  worker_thread+0x410/0x778\n  kthread+0x168/0x178\n  ret_from_fork+0x10/0x20\n\n Last potentially related work creation:\n  kasan_save_stack+0x3c/0x68\n  __kasan_record_aux_stack+0xb0/0x150\n  kasan_record_aux_stack_noalloc+0x14/0x20\n  __queue_work+0x33c/0x960\n  queue_work_on+0x98/0xc0\n  hci_recv_frame+0xc8/0x1e8 [bluetooth]\n  h5_complete_rx_pkt+0x2c8/0x800 [hci_uart]\n  h5_rx_payload+0x98/0xb8 [hci_uart]\n  h5_recv+0x158/0x3d8 [hci_uart]\n  hci_uart_receive_buf+0xa0/0xe8 [hci_uart]\n  ttyport_receive_buf+0xac/0x178\n  flush_to_ldisc+0x130/0x2c8\n  process_one_work+0x328/0x6f0\n  worker_thread+0x410/0x778\n  kthread+0x168/0x178\n  ret_from_fork+0x10/0x20\n\n Second to last potentially related work creation:\n  kasan_save_stack+0x3c/0x68\n  __kasan_record_aux_stack+0xb0/0x150\n  kasan_record_aux_stack_noalloc+0x14/0x20\n  __queue_work+0x788/0x960\n  queue_work_on+0x98/0xc0\n  __hci_cmd_sync_sk+0x23c/0x7a0 [bluetooth]\n  __hci_cmd_sync+0x24/0x38 [bluetooth]\n  btrtl_initialize+0x760/0x958 [btrtl]\n  h5_btrtl_setup+0xd0/0x2f8 [hci_uart]\n  h5_setup+0x50/0x80 [hci_uart]\n  hci_uart_setup+0xd4/0x260 [hci_uart]\n  hci_dev_open_sync+0x1cc/0xf68 [bluetooth]\n  hci_dev_do_open+0x34/0x90 [bluetooth]\n  hci_power_on+0xc4/0x3c8 [bluetooth]\n  process_one_work+0x328/0x6f0\n  worker_thread+0x410/0x778\n  kthread+0x168/0x178\n  ret_from_fork+0x10/0x20\n =================================================================="
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux se ha resuelto la siguiente vulnerabilidad: Bluetooth: btrtl: arreglar acceso a memoria fuera de los l\u00edmites El problema es detectado por KASAN. El controlador btrtl utiliza datos privados de hci para almacenar 'struct btrealtek_data'. Si se utiliza el controlador btrtl con btusb, entonces la memoria para los datos privados de hci se asigna en btusb. Pero no se asignan datos privados despu\u00e9s de hci_dev, cuando se usa btrtl con hci_h5. Esta confirmaci\u00f3n agrega asignaci\u00f3n de memoria para el caso hci_h5. ==================================================== ================ ERROR: KASAN: losa fuera de los l\u00edmites en btrtl_initialize+0x6cc/0x958 [btrtl] Escritura de tama\u00f1o 8 en la direcci\u00f3n ffff00000f5a5748 por tarea kworker/u9:0 /76 Nombre del hardware: Pine64 PinePhone (1.2) (DT) Cola de trabajo: hci0 hci_power_on [bluetooth] Rastreo de llamadas: dump_backtrace+0x9c/0x128 show_stack+0x20/0x38 dump_stack_lvl+0x48/0x60 print_report+0xf8/0x5d8 kasan_report+0x90/0xd0 __asan_store8 + 0x9c/0xc0 [btrtl] h5_btrtl_setup+0xd0/0x2f8 [hci_uart] h5_setup+0x50/0x80 [hci_uart] hci_uart_setup+0xd4/0x260 [hci_uart] hci_dev_open_sync+0x1cc/0xf68 [bluetooth] abierto+0x34/0x90 [bluetooth] hci_power_on+0xc4/ 0x3c8 [bluetooth] Process_one_work+0x328/0x6f0 trabajador_thread+0x410/0x778 kthread+0x168/0x178 ret_from_fork+0x10/0x20 Asignado por tarea 53: kasan_save_stack+0x3c/0x68 kasan_save_track+0x20/0x40 _alloc_info+0x68/0x78 __kasan_kmalloc+0xd4/0xd8 __kmalloc +0x1b4/0x3b0 hci_alloc_dev_priv+0x28/0xa58 [bluetooth] hci_uart_register_device+0x118/0x4f8 [hci_uart] h5_serdev_probe+0xf4/0x178 [hci_uart] serdev_drv_probe+0x54/0xa0realmente_probe+0x254/ 0x588 __driver_probe_device+0xc4/0x210 driver_probe_device+0x64/0x160 __driver_attach_async_helper+ 0x88/0x158 async_run_entry_fn+0xd0/0x388 Process_one_work+0x328/0x6f0 trabajador_thread+0x410/0x778 kthread+0x168/0x178 ret_from_fork+0x10/0x20 \u00daltima creaci\u00f3n de trabajo potencialmente relacionado: kasan_save_stack+0x3c/0x68 san_record_aux_stack+0xb0/0x150 kasan_record_aux_stack_noalloc+0x14/0x20 __queue_work +0x33c/0x960 queue_work_on+0x98/0xc0 hci_recv_frame+0xc8/0x1e8 [bluetooth] h5_complete_rx_pkt+0x2c8/0x800 [hci_uart] h5_rx_payload+0x98/0xb8 [hci_uart] h5_recv+0x158/0x3d8 [ hci_uart] hci_uart_receive_buf+0xa0/0xe8 [hci_uart] ttyport_receive_buf +0xac/0x178 Flush_to_ldisc+0x130/0x2c8 Process_one_work+0x328/0x6f0 trabajador_thread+0x410/0x778 kthread+0x168/0x178 ret_from_fork+0x10/0x20 Pen\u00faltima creaci\u00f3n de trabajo potencialmente relacionado: kasan_save_stack+0x3c/0x68 _record_aux_stack+0xb0/0x150 kasan_record_aux_stack_noalloc+0x14 /0x20 __queue_work+0x788/0x960 queue_work_on+0x98/0xc0 __hci_cmd_sync_sk+0x23c/0x7a0 [bluetooth] __hci_cmd_sync+0x24/0x38 [bluetooth] btrtl_initialize+0x760/0x958 [btrtl] arriba+0xd0/0x2f8 [hci_uart] h5_setup+0x50/0x80 [ hci_uart] hci_uart_setup+0xd4/0x260 [hci_uart] hci_dev_open_sync+0x1cc/0xf68 [bluetooth] hci_dev_do_open+0x34/0x90 [bluetooth] hci_power_on+0xc4/0x3c8 [bluetooth] Process_one_work+0x328/0x6f0 trabajador_thread+0x 410/0x778 kthread+0x168/0x178 ret_from_fork +0x10/0x20 ================================================ ====================="
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/0c657e641df1e77d6087688190f632cad9c0439b",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/2f232bc389a4f5943c40733582f9edf77b89e499",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/dd163fa34c483f1674aa2510accce11a224f649e",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/de4e88ec58c4202efd1f02eebb4939bbf6945358",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}