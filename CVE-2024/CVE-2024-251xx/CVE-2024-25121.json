{
  "id": "CVE-2024-25121",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-02-13T23:15:09.080",
  "lastModified": "2024-11-21T09:00:17.897",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "TYPO3 is an open source PHP based web content management system released under the GNU GPL. In affected versions of TYPO3 entities of the File Abstraction Layer (FAL) could be persisted directly via `DataHandler`. This allowed attackers to reference files in the fallback storage directly and retrieve their file names and contents. The fallback storage (\"zero-storage\") is used as a backward compatibility layer for files located outside properly configured file storages and within the public web root directory. Exploiting this vulnerability requires a valid backend user account. Users are advised to update to TYPO3 version 8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS, or 13.0.1 which fix the problem described. When persisting entities of the File Abstraction Layer directly via DataHandler, `sys_file` entities are now denied by default, and `sys_file_reference` & `sys_file_metadata` entities are not permitted to reference files in the fallback storage anymore. When importing data from secure origins, this must be explicitly enabled in the corresponding DataHandler instance by using `$dataHandler->isImporting = true;`.\n\n\n"
    },
    {
      "lang": "es",
      "value": "TYPO3 es un sistema de gesti\u00f3n de contenido web basado en PHP de c\u00f3digo abierto publicado bajo GNU GPL. En las versiones afectadas de TYPO3, las entidades de la capa de abstracci\u00f3n de archivos (FAL) se pod\u00edan conservar directamente a trav\u00e9s de `DataHandler`. Esto permiti\u00f3 a los atacantes hacer referencia a archivos en el almacenamiento alternativo directamente y recuperar sus nombres y contenidos. El almacenamiento alternativo (\"almacenamiento cero\") se utiliza como capa de compatibilidad con versiones anteriores para archivos ubicados fuera de los almacenamientos de archivos configurados correctamente y dentro del directorio ra\u00edz web p\u00fablico. Para explotar esta vulnerabilidad se requiere una cuenta de usuario backend v\u00e1lida. Se recomienda a los usuarios que actualicen a TYPO3 versi\u00f3n 8.7.57 ELTS, 9.5.46 ELTS, 10.4.43 ELTS, 11.5.35 LTS, 12.4.11 LTS o 13.0.1, que solucionan el problema descrito. Cuando se persisten entidades de la capa de abstracci\u00f3n de archivos directamente a trav\u00e9s de DataHandler, las entidades `sys_file` ahora est\u00e1n denegadas de forma predeterminada, y las entidades `sys_file_reference` y `sys_file_metadata` ya no pueden hacer referencia a archivos en el almacenamiento alternativo. Al importar datos desde or\u00edgenes seguros, esto debe habilitarse expl\u00edcitamente en la instancia de DataHandler correspondiente usando `$dataHandler-&gt;isImporting = true;`."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N",
          "baseScore": 7.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 4.2
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:N",
          "baseScore": 7.1,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 4.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        },
        {
          "lang": "en",
          "value": "CWE-284"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.0.0",
              "versionEndExcluding": "8.7.57",
              "matchCriteriaId": "D27B5B1C-F807-411B-BCA1-112C85BDC3E5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "9.0.0",
              "versionEndExcluding": "9.5.46",
              "matchCriteriaId": "E1F52D81-C2B7-4AFE-A99E-7E40E0751082"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "10.0.0",
              "versionEndExcluding": "10.4.43",
              "matchCriteriaId": "CCF72A1A-60DD-4588-8E90-B5D6D84854A9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "11.0.0",
              "versionEndExcluding": "11.5.35",
              "matchCriteriaId": "DAE0085D-3BA8-4076-BAB0-04BBB118A78D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "12.0.0",
              "versionEndExcluding": "12.4.11",
              "matchCriteriaId": "5D518ED7-F1C8-4836-B3D8-4D228A48F314"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:typo3:typo3:13.0.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "E20E3F5E-8C2B-4AC1-A3E3-B428710A5480"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2024-006",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/TYPO3/typo3/security/advisories/GHSA-rj3x-wvc6-5j66",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://typo3.org/security/advisory/typo3-core-sa-2024-006",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}