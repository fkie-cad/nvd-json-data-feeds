{
  "id": "CVE-2024-25129",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-02-22T19:15:08.600",
  "lastModified": "2024-02-23T02:42:54.547",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "The CodeQL CLI repo holds binaries for the CodeQL command line interface (CLI). Prior to version 2.16.3, an XML parser used by the CodeQL CLI to read various auxiliary files is vulnerable to an XML External Entity attack. If a vulnerable version of the CLI is used to process either a maliciously modified CodeQL database, or a specially prepared set of QL query sources, the CLI can be made to make an outgoing HTTP request to an URL that contains material read from a local file chosen by the attacker. This may result in a loss of privacy of exfiltration of secrets. Security researchers and QL authors who receive databases or QL source files from untrusted sources may be impacted. A single untrusted `.ql` or `.qll` file cannot be affected, but a zip archive or tarball containing QL sources may unpack auxiliary files that will trigger an attack when CodeQL sees them in the file system. Those using CodeQL for routine analysis of source trees with a preselected set of trusted queries are not affected. In particular, extracting XML files from a source tree into the CodeQL database does not make one vulnerable. The problem is fixed in release 2.16.3 of the CodeQL CLI. Other than upgrading, workarounds include not accepting CodeQL databases or queries from untrusted sources, or only processing such material on a machine without an Internet connection. Customers who use older releases of CodeQL for security scanning in an automated CI system and cannot upgrade for compliance reasons can continue using that version. That use case is safe. If such customers have a private query pack and use the `codeql pack create` command to precompile them before using them in the CI system, they should be using the production CodeQL release to run `codeql pack create`. That command is safe as long as the QL source it precompiled is trusted. All other development of the query pack should use an upgraded CLI."
    },
    {
      "lang": "es",
      "value": "El repositorio de CodeQL CLI contiene archivos binarios para la interfaz de l\u00ednea de comandos (CLI) de CodeQL. Antes de la versi\u00f3n 2.16.3, un analizador XML utilizado por la CLI de CodeQL para leer varios archivos auxiliares era vulnerable a un ataque de entidad externa XML. Si se utiliza una versi\u00f3n vulnerable de la CLI para procesar una base de datos CodeQL modificada maliciosamente o un conjunto especialmente preparado de fuentes de consulta QL, se puede hacer que la CLI realice una solicitud HTTP saliente a una URL que contenga material le\u00eddo de un archivo local. elegido por el atacante. Esto puede resultar en una p\u00e9rdida de privacidad o exfiltraci\u00f3n de secretos. Los investigadores de seguridad y los autores de QL que reciben bases de datos o archivos fuente de QL de fuentes que no son de confianza pueden verse afectados. Un \u00fanico archivo `.ql` o `.qll` que no sea de confianza no puede verse afectado, pero un archivo zip o tarball que contenga fuentes QL puede descomprimir archivos auxiliares que desencadenar\u00e1n un ataque cuando CodeQL los vea en el sistema de archivos. Aquellos que usan CodeQL para an\u00e1lisis rutinarios de \u00e1rboles fuente con un conjunto preseleccionado de consultas confiables no se ven afectados. En particular, extraer archivos XML de un \u00e1rbol fuente a la base de datos CodeQL no lo hace vulnerable. El problema se solucion\u00f3 en la versi\u00f3n 2.16.3 de CodeQL CLI. Adem\u00e1s de actualizar, los workarounds incluyen no aceptar bases de datos CodeQL o consultas de fuentes no confiables, o solo procesar dicho material en una m\u00e1quina sin conexi\u00f3n a Internet. Los clientes que utilicen versiones anteriores de CodeQL para el escaneo de seguridad en un sistema de CI automatizado y no puedan actualizar por motivos de cumplimiento pueden continuar usando esa versi\u00f3n. Ese caso de uso es seguro. Si dichos clientes tienen un paquete de consultas privado y usan el comando \"codeql pack create\" para precompilarlos antes de usarlos en el sistema CI, deber\u00edan usar la versi\u00f3n de producci\u00f3n de CodeQL para ejecutar \"codeql pack create\". Ese comando es seguro siempre que se conf\u00ede en la fuente QL que precompil\u00f3. Todos los dem\u00e1s desarrollos del paquete de consultas deben utilizar una CLI actualizada."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:N/UI:R/S:C/C:L/I:N/A:N",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 2.7,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-611"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/github/codeql-cli-binaries/releases/tag/v2.16.3",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/github/codeql-cli-binaries/security/advisories/GHSA-gf8p-v3g3-3wph",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/github/codeql/blob/main/java/ql/src/Security/CWE/CWE-611/XXELocal.ql",
      "source": "security-advisories@github.com"
    }
  ]
}