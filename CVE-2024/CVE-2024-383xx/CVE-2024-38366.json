{
  "id": "CVE-2024-38366",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-07-01T21:15:03.797",
  "lastModified": "2024-07-02T12:09:16.907",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "trunk.cocoapods.org is the authentication server for the CoacoaPods dependency manager. The part of trunk which verifies whether a user has a real email address on signup used a rfc-822 library which executes a shell command to validate the email domain MX records validity. It works via an DNS MX. This lookup could be manipulated to also execute a command on the trunk server, effectively giving root access to the server and the infrastructure. This issue was patched server-side with commit 001cc3a430e75a16307f5fd6cdff1363ad2f40f3 in September 2023. This RCE triggered a full user-session reset, as an attacker could have used this method to write to any Podspec in trunk."
    },
    {
      "lang": "es",
      "value": "trunk.cocoapods.org es el servidor de autenticaci\u00f3n para el administrador de dependencias de CoacoaPods. La parte del tronco que verifica si un usuario tiene una direcci\u00f3n de correo electr\u00f3nico real al registrarse utiliz\u00f3 una librer\u00eda rfc-822 que ejecuta un comando de shell para validar la validez de los registros MX del dominio de correo electr\u00f3nico. Funciona a trav\u00e9s de un DNS MX. Esta b\u00fasqueda podr\u00eda manipularse para ejecutar tambi\u00e9n un comando en el servidor troncal, otorgando efectivamente acceso ra\u00edz al servidor y a la infraestructura. Este problema se solucion\u00f3 en el lado del servidor con el commit 001cc3a430e75a16307f5fd6cdff1363ad2f40f3 en septiembre de 2023. Este RCE desencaden\u00f3 un restablecimiento completo de la sesi\u00f3n del usuario, ya que un atacante podr\u00eda haber usado este m\u00e9todo para escribir en cualquier Podspec en el tronco."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.0,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-74"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://blog.cocoapods.org/CocoaPods-Trunk-RCEs-2023",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://evasec.webflow.io/blog/eva-discovered-supply-chain-vulnerabities-in-cocoapods#2-remote-code-execution-on-the-cocoapods-trunk-server",
      "source": "security-advisories@github.com"
    },
    {
      "url": "https://github.com/CocoaPods/CocoaPods/security/advisories/GHSA-x2x4-g675-qg7c",
      "source": "security-advisories@github.com"
    }
  ]
}