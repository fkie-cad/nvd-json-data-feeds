{
  "id": "CVE-2024-38346",
  "sourceIdentifier": "security@apache.org",
  "published": "2024-07-05T14:15:02.867",
  "lastModified": "2024-07-08T15:48:17.710",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The CloudStack cluster service runs on unauthenticated port (default 9090) that can be misused to run arbitrary commands on targeted hypervisors and CloudStack management server hosts. Some of these commands were found to have command injection vulnerabilities that can result in arbitrary code execution via agents on the hosts that may run as a privileged user.\u00a0An attacker that can reach the cluster service on the unauthenticated\u00a0port (default 9090), can exploit this to perform remote code execution on CloudStack managed hosts and result in complete\u00a0compromise of the confidentiality, integrity, and availability of CloudStack managed infrastructure.\n\nUsers are recommended to restrict the network access to the cluster service port (default 9090) on a CloudStack management server host to only its peer CloudStack management server hosts.\u00a0Users are recommended to upgrade to version 4.18.2.1, 4.19.0.2 or later, which addresses this issue.\n\n"
    },
    {
      "lang": "es",
      "value": "El servicio de cl\u00faster de CloudStack se ejecuta en un puerto no autenticado (9090 predeterminado) que puede usarse indebidamente para ejecutar comandos arbitrarios en hipervisores espec\u00edficos y hosts de servidores de administraci\u00f3n de CloudStack. Se descubri\u00f3 que algunos de estos comandos ten\u00edan vulnerabilidades de inyecci\u00f3n de comandos que pueden resultar en la ejecuci\u00f3n de c\u00f3digo arbitrario a trav\u00e9s de agentes en los hosts que pueden ejecutarse como un usuario privilegiado. Un atacante que pueda acceder al servicio de cl\u00faster en el puerto no autenticado (9090 predeterminado) puede aprovechar esto para realizar la ejecuci\u00f3n remota de c\u00f3digo en hosts administrados por CloudStack y comprometer completamente la confidencialidad, integridad y disponibilidad de la infraestructura administrada por CloudStack. Se recomienda a los usuarios restringir el acceso a la red al puerto de servicio de cl\u00faster (9090 predeterminado) en un host del servidor de administraci\u00f3n de CloudStack solo a sus hosts del servidor de administraci\u00f3n de CloudStack pares. Se recomienda a los usuarios actualizar a la versi\u00f3n 4.18.2.1, 4.19.0.2 o posterior, que soluciona este problema."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@apache.org",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0.0",
              "versionEndExcluding": "4.18.2.1",
              "matchCriteriaId": "3838B737-9231-4333-9777-8B49CBACC754"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:cloudstack:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.19.0.0",
              "versionEndExcluding": "4.19.0.2",
              "matchCriteriaId": "1155DE75-1275-454F-9461-6DF70C73D1E2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2024/07/05/1",
      "source": "security@apache.org",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://cloudstack.apache.org/blog/security-release-advisory-4.19.0.2-4.18.2.1",
      "source": "security@apache.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://lists.apache.org/thread/6l51r00csrct61plkyd3qg3fj99215d1",
      "source": "security@apache.org",
      "tags": [
        "Mailing List"
      ]
    },
    {
      "url": "https://www.shapeblue.com/shapeblue-security-advisory-apache-cloudstack-security-releases-4-18-2-1-and-4-19-0-2/",
      "source": "security@apache.org",
      "tags": [
        "Release Notes"
      ]
    }
  ]
}