{
  "id": "CVE-2024-7884",
  "sourceIdentifier": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
  "published": "2024-09-05T13:15:11.390",
  "lastModified": "2024-09-12T20:47:13.387",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "When a canister method is called via ic_cdk::call* , a new Future CallFuture\u00a0is created  and can be awaited by the caller to get the execution result. Internally, the state of the Future is tracked and stored in a struct called CallFutureState.  A bug in the polling implementation of the CallFuture allows multiple references to be held for this internal state and not all references were dropped before the Future\u00a0is resolved. Since we have unaccounted references held, a copy of the internal state ended up being persisted in the canister's heap and thus causing a memory leak. \nImpact\u00a0Canisters built in Rust with ic_cdk\u00a0and ic_cdk_timers\u00a0are affected. If these canisters call a canister method, use timers or heartbeat, they will likely leak a small amount of memory on every such operation. In the worst case, this could lead to heap memory exhaustion triggered by an attacker. Motoko based canisters are not affected by the bug.\nPatchesThe patch has been backported to all minor versions between >= 0.8.0, <= 0.15.0. The patched versions available are 0.8.2, 0.9.3, 0.10.1, 0.11.6, 0.12.2, 0.13.5, 0.14.1, 0.15.1 and their previous versions have been yanked. WorkaroundsThere are no known workarounds at the moment. Developers are recommended to upgrade their canister as soon as possible to the latest available patched version of ic_cdk\u00a0to avoid running out of Wasm heap memory. \nUpgrading the canisters (without updating `ic_cdk`) also frees the leaked memory but it's only a temporary solution."
    },
    {
      "lang": "es",
      "value": "Cuando se llama a un m\u00e9todo de contenedor a trav\u00e9s de ic_cdk::call* , se crea un nuevo Future CallFuture y el llamador puede esperar para obtener el resultado de la ejecuci\u00f3n. Internamente, el estado del Future se rastrea y se almacena en una estructura llamada CallFutureState. Un error en la implementaci\u00f3n de sondeo de CallFuture permite que se mantengan m\u00faltiples referencias para este estado interno y no todas las referencias se descartaron antes de que se resolviera el Future. Dado que tenemos referencias no contabilizadas retenidas, una copia del estado interno termin\u00f3 siendo persistente en el mont\u00f3n del contenedor y, por lo tanto, caus\u00f3 una p\u00e9rdida de memoria. Impacto Los contenedores creados en Rust con ic_cdk e ic_cdk_timers se ven afectados. Si estos contenedores llaman a un m\u00e9todo de contenedor, usan temporizadores o latidos, es probable que pierdan una peque\u00f1a cantidad de memoria en cada una de esas operaciones. En el peor de los casos, esto podr\u00eda provocar el agotamiento de la memoria del mont\u00f3n activado por un atacante. Los contenedores basados en Motoko no se ven afectados por el error. ParchesEl parche ha sido retroportado a todas las versiones menores entre &gt;= 0.8.0, &lt;= 0.15.0. Las versiones parcheadas disponibles son 0.8.2, 0.9.3, 0.10.1, 0.11.6, 0.12.2, 0.13.5, 0.14.1, 0.15.1 y sus versiones anteriores han sido eliminadas. Workarounds, no hay soluciones workarounds en este momento. Se recomienda a los desarrolladores que actualicen su contenedor lo antes posible a la \u00faltima versi\u00f3n parcheada disponible de ic_cdk para evitar quedarse sin memoria del mont\u00f3n de Wasm. Actualizar los contenedores (sin actualizar `ic_cdk`) tambi\u00e9n libera la memoria filtrada, pero es solo una soluci\u00f3n temporal."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        }
      ]
    },
    {
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-401"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:*:*:*:*:*:rust:*:*",
              "versionStartIncluding": "0.8.0",
              "versionEndExcluding": "0.8.2",
              "matchCriteriaId": "B282FC5B-DCC9-4E87-97A4-212E5B8F91EA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:*:*:*:*:*:rust:*:*",
              "versionStartIncluding": "0.9.0",
              "versionEndExcluding": "0.9.3",
              "matchCriteriaId": "4D91E831-1BD4-4AC3-8F53-889BDD70FAD4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:*:*:*:*:*:rust:*:*",
              "versionStartIncluding": "0.11.0",
              "versionEndExcluding": "0.11.6",
              "matchCriteriaId": "7EB88B2F-9AFC-4290-8BE0-CEB4CE2525CE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:*:*:*:*:*:rust:*:*",
              "versionStartIncluding": "0.12.0",
              "versionEndExcluding": "0.12.2",
              "matchCriteriaId": "CD360546-4576-48E9-8F00-BF478698CEC3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:*:*:*:*:*:rust:*:*",
              "versionStartIncluding": "0.13.0",
              "versionEndExcluding": "0.13.5",
              "matchCriteriaId": "C5157DF4-58E6-4F7B-A4A7-D7D2800DF5DB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:0.10.0:*:*:*:*:rust:*:*",
              "matchCriteriaId": "D4C3CD14-0CDD-4D0A-A698-FA008BF854C0"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:0.14.0:*:*:*:*:rust:*:*",
              "matchCriteriaId": "8523743A-88F9-4D42-945A-F79BA5AB91D1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:dfinity:canister_developer_kit_for_the_internet_computer:0.15.0:*:*:*:*:rust:*:*",
              "matchCriteriaId": "0C94A6D7-8B8A-493F-BA58-2D72300F97B5"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.rs/ic-cdk/latest/ic_cdk/",
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Product"
      ]
    },
    {
      "url": "https://github.com/dfinity/cdk-rs/pull/509",
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Issue Tracking",
        "Patch"
      ]
    },
    {
      "url": "https://internetcomputer.org/docs/current/references/ic-interface-spec",
      "source": "6b35d637-e00f-4228-858c-b20ad6e1d07b",
      "tags": [
        "Product"
      ]
    }
  ]
}