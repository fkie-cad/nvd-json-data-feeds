{
  "id": "CVE-2024-2029",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-04-10T17:15:53.880",
  "lastModified": "2024-11-21T09:08:52.600",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A command injection vulnerability exists in the `TranscriptEndpoint` of mudler/localai, specifically within the `audioToWav` function used for converting audio files to WAV format for transcription. The vulnerability arises due to the lack of sanitization of user-supplied filenames before passing them to ffmpeg via a shell command, allowing an attacker to execute arbitrary commands on the host system. Successful exploitation could lead to unauthorized access, data breaches, or other detrimental impacts, depending on the privileges of the process executing the code."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de inyecci\u00f3n de comandos en el `TranscriptEndpoint` de mudler/localai, espec\u00edficamente dentro de la funci\u00f3n `audioToWav` utilizada para convertir archivos de audio al formato WAV para su transcripci\u00f3n. La vulnerabilidad surge debido a la falta de desinfecci\u00f3n de los nombres de archivo proporcionados por el usuario antes de pasarlos a ffmpeg a trav\u00e9s de un comando de shell, lo que permite a un atacante ejecutar comandos arbitrarios en el sistema host. Una explotaci\u00f3n exitosa podr\u00eda provocar acceso no autorizado, violaciones de datos u otros impactos perjudiciales, seg\u00fan los privilegios del proceso que ejecuta el c\u00f3digo."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-78"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/mudler/localai/commit/31a4c9c9d3abc58de2bdc5305419181c8b33eb1c",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://huntr.com/bounties/e092528a-ce3b-4e66-9b98-3f56d6b276b0",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://github.com/mudler/localai/commit/31a4c9c9d3abc58de2bdc5305419181c8b33eb1c",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    },
    {
      "url": "https://huntr.com/bounties/e092528a-ce3b-4e66-9b98-3f56d6b276b0",
      "source": "af854a3a-2127-422b-91ae-364da2661108"
    }
  ]
}