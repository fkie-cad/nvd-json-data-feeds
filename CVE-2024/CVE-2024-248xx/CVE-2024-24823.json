{
  "id": "CVE-2024-24823",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-02-07T18:15:54.870",
  "lastModified": "2024-02-15T15:41:48.550",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Graylog is a free and open log management platform. Starting in version 4.3.0 and prior to versions 5.1.11 and 5.2.4, reauthenticating with an existing session cookie would re-use that session id, even if for different user credentials. In this case, the pre-existing session could be used to gain elevated access to an existing Graylog login session, provided the malicious user could successfully inject their session cookie into someone else's browser. The complexity of such an attack is high, because it requires presenting a spoofed login screen and injection of a session cookie into an existing browser, potentially through a cross-site scripting attack. No such attack has been discovered. Graylog 5.1.11 and 5.2.4, and any versions of the 6.0 development branch, contain patches to not re-use sessions under any circumstances. Some workarounds are available. Using short session expiration and explicit log outs of unused sessions can help limiting the attack vector. Unpatched this vulnerability exists, but is relatively hard to exploit. A proxy could be leveraged to clear the `authentication` cookie for the Graylog server URL for the `/api/system/sessions` endpoint, as that is the only one vulnerable."
    },
    {
      "lang": "es",
      "value": "Graylog es una plataforma de gesti\u00f3n de registros abierta y gratuita. A partir de la versi\u00f3n 4.3.0 y antes de las versiones 5.1.11 y 5.2.4, la nueva autenticaci\u00f3n con una cookie de sesi\u00f3n existente reutilizar\u00eda esa identificaci\u00f3n de sesi\u00f3n, incluso si se trata de credenciales de usuario diferentes. En este caso, la sesi\u00f3n preexistente podr\u00eda usarse para obtener acceso elevado a una sesi\u00f3n de inicio de sesi\u00f3n de Graylog existente, siempre que el usuario malintencionado pueda inyectar con \u00e9xito su cookie de sesi\u00f3n en el navegador de otra persona. La complejidad de un ataque de este tipo es alta, porque requiere presentar una pantalla de inicio de sesi\u00f3n falsificada e inyectar una cookie de sesi\u00f3n en un navegador existente, potencialmente a trav\u00e9s de un ataque de cross-site scripting. No se ha descubierto ning\u00fan ataque de este tipo. Graylog 5.1.11 y 5.2.4, y cualquier versi\u00f3n de la rama de desarrollo 6.0, contienen parches para no reutilizar sesiones bajo ninguna circunstancia. Algunos workarounds est\u00e1n disponibles. El uso de una caducidad corta de la sesi\u00f3n y cierres de sesi\u00f3n expl\u00edcitos de las sesiones no utilizadas pueden ayudar a limitar el vector de ataque. Esta vulnerabilidad no est\u00e1 parcheada, pero es relativamente dif\u00edcil de explotar. Se podr\u00eda aprovechar un proxy para borrar la cookie de \"autenticaci\u00f3n\" para la URL del servidor Graylog para el endpoint \"/api/system/sessions\", ya que ese es el \u00fanico vulnerable."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.3,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:R/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.5,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-384"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.3.0",
              "versionEndExcluding": "5.1.11",
              "matchCriteriaId": "924684AB-5E3A-4A6B-B607-1DB1124848EE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:graylog:graylog:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.2.0",
              "versionEndExcluding": "5.2.4",
              "matchCriteriaId": "4A343880-1202-4534-AE60-F314473EABD9"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/Graylog2/graylog2-server/commit/1596b749db86368ba476662f23a0f0c5ec2b5097",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Graylog2/graylog2-server/commit/b93a66353f35a94a4e8f3f75ac4f5cdc5a2d4a6a",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/Graylog2/graylog2-server/security/advisories/GHSA-3xf8-g8gr-g7rh",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}