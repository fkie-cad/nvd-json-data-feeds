{
  "id": "CVE-2024-1968",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-05-20T08:15:08.850",
  "lastModified": "2024-05-20T13:00:04.957",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "In scrapy/scrapy, an issue was identified where the Authorization header is not removed during redirects that only change the scheme (e.g., HTTPS to HTTP) but remain within the same domain. This behavior contravenes the Fetch standard, which mandates the removal of Authorization headers in cross-origin requests when the scheme, host, or port changes. Consequently, when a redirect downgrades from HTTPS to HTTP, the Authorization header may be inadvertently exposed in plaintext, leading to potential sensitive information disclosure to unauthorized actors. The flaw is located in the _build_redirect_request function of the redirect middleware."
    },
    {
      "lang": "es",
      "value": " En scrapy/scrapy, se identific\u00f3 un problema por el cual el encabezado Authorization no se elimina durante las redirecciones que solo cambian el esquema (por ejemplo, HTTPS a HTTP) pero permanecen dentro del mismo dominio. Este comportamiento contraviene el est\u00e1ndar Fetch, que exige la eliminaci\u00f3n de encabezados de Autorizaci\u00f3n en solicitudes de origen cruzado cuando cambia el esquema, el host o el puerto. En consecuencia, cuando una redirecci\u00f3n degrada de HTTPS a HTTP, el encabezado de Autorizaci\u00f3n puede quedar expuesto inadvertidamente en texto sin formato, lo que lleva a una posible divulgaci\u00f3n de informaci\u00f3n confidencial a actores no autorizados. La falla se encuentra en la funci\u00f3n _build_redirect_request del middleware de redirecci\u00f3n."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/scrapy/scrapy/commit/1d0502f25bbe55a22899af915623fda1aaeb9dd8",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://huntr.com/bounties/27f6a021-a891-446a-ada5-0226d619dd1a",
      "source": "security@huntr.dev"
    }
  ]
}