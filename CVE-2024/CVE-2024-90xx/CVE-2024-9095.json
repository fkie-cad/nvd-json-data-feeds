{
  "id": "CVE-2024-9095",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2025-03-20T10:15:46.700",
  "lastModified": "2025-03-20T10:15:46.700",
  "vulnStatus": "Undergoing Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In lunary-ai/lunary version v1.4.28, the /bigquery API route lacks proper access control, allowing any logged-in user to create a Datastream to Google BigQuery and export the entire database. This includes sensitive data such as password hashes and secret API keys. The route is protected by a config check (`config.DATA_WAREHOUSE_EXPORTS_ALLOWED`), but it does not verify the user's access level or implement any access control middleware. This vulnerability can lead to the extraction of sensitive data, disruption of services, credential compromise, and service integrity breaches."
    },
    {
      "lang": "es",
      "value": "En la versi\u00f3n 1.4.28 de lunary-ai/lunary, la ruta de la API /bigquery carece de un control de acceso adecuado, lo que permite a cualquier usuario conectado crear un flujo de datos a Google BigQuery y exportar la base de datos completa. Esto incluye datos confidenciales como hashes de contrase\u00f1as y claves API secretas. La ruta est\u00e1 protegida por una comprobaci\u00f3n de configuraci\u00f3n (`config.DATA_WAREHOUSE_EXPORTS_ALLOWED`), pero no verifica el nivel de acceso del usuario ni implementa ning\u00fan middleware de control de acceso. Esta vulnerabilidad puede provocar la extracci\u00f3n de datos confidenciales, la interrupci\u00f3n de los servicios, la vulneraci\u00f3n de credenciales y la violaci\u00f3n de la integridad del servicio."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-285"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/lunary-ai/lunary/commit/a8d7b2959e87c30fbafdb12af7ffa093385dcc60",
      "source": "security@huntr.dev"
    },
    {
      "url": "https://huntr.com/bounties/e242a92e-da41-440d-b718-3de91e4b4eac",
      "source": "security@huntr.dev"
    }
  ]
}