{
  "id": "CVE-2024-50141",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-11-07T10:15:06.090",
  "lastModified": "2024-11-08T19:01:03.880",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nACPI: PRM: Find EFI_MEMORY_RUNTIME block for PRM handler and context\n\nPRMT needs to find the correct type of block to translate the PA-VA\nmapping for EFI runtime services.\n\nThe issue arises because the PRMT is finding a block of type\nEFI_CONVENTIONAL_MEMORY, which is not appropriate for runtime services\nas described in Section 2.2.2 (Runtime Services) of the UEFI\nSpecification [1]. Since the PRM handler is a type of runtime service,\nthis causes an exception when the PRM handler is called.\n\n    [Firmware Bug]: Unable to handle paging request in EFI runtime service\n    WARNING: CPU: 22 PID: 4330 at drivers/firmware/efi/runtime-wrappers.c:341\n        __efi_queue_work+0x11c/0x170\n    Call trace:\n\nLet PRMT find a block with EFI_MEMORY_RUNTIME for PRM handler and PRM\ncontext.\n\nIf no suitable block is found, a warning message will be printed, but\nthe procedure continues to manage the next PRM handler.\n\nHowever, if the PRM handler is actually called without proper allocation,\nit would result in a failure during error handling.\n\nBy using the correct memory types for runtime services, ensure that the\nPRM handler and the context are properly mapped in the virtual address\nspace during runtime, preventing the paging request error.\n\nThe issue is really that only memory that has been remapped for runtime\nby the firmware can be used by the PRM handler, and so the region needs\nto have the EFI_MEMORY_RUNTIME attribute.\n\n[ rjw: Subject and changelog edits ]"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: ACPI: PRM: Buscar bloque EFI_MEMORY_RUNTIME para el controlador PRM y el contexto PRMT necesita encontrar el tipo correcto de bloque para traducir la asignaci\u00f3n PA-VA para los servicios de tiempo de ejecuci\u00f3n EFI. El problema surge porque PRMT encuentra un bloque de tipo EFI_CONVENTIONAL_MEMORY, que no es apropiado para los servicios de tiempo de ejecuci\u00f3n como se describe en la Secci\u00f3n 2.2.2 (Servicios de tiempo de ejecuci\u00f3n) de la Especificaci\u00f3n UEFI [1]. Dado que el controlador PRM es un tipo de servicio de tiempo de ejecuci\u00f3n, esto provoca una excepci\u00f3n cuando se llama al controlador PRM. [Error de firmware]: No se puede manejar la solicitud de paginaci\u00f3n en el servicio de tiempo de ejecuci\u00f3n de EFI ADVERTENCIA: CPU: 22 PID: 4330 en drivers/firmware/efi/runtime-wrappers.c:341 __efi_queue_work+0x11c/0x170 Rastreo de llamadas: deje que PRMT encuentre un bloque con EFI_MEMORY_RUNTIME para el controlador PRM y el contexto PRM. Si no se encuentra ning\u00fan bloque adecuado, se imprimir\u00e1 un mensaje de advertencia, pero el procedimiento contin\u00faa para administrar el siguiente controlador PRM. Sin embargo, si el controlador PRM se llama realmente sin la asignaci\u00f3n adecuada, se producir\u00eda un error durante el manejo de errores. Al utilizar los tipos de memoria correctos para los servicios de tiempo de ejecuci\u00f3n, aseg\u00farese de que el controlador PRM y el contexto est\u00e9n correctamente mapeados en el espacio de direcciones virtuales durante el tiempo de ejecuci\u00f3n, lo que evita el error de solicitud de paginaci\u00f3n. El problema es que el controlador PRM solo puede usar la memoria que el firmware ha reasignado para el tiempo de ejecuci\u00f3n, por lo que la regi\u00f3n debe tener el atributo EFI_MEMORY_RUNTIME. [ rjw: Tema y ediciones del registro de cambios ]"
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/088984c8d54c0053fc4ae606981291d741c5924b",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/20e9fafb8bb6f545667d7916b0e81e68c0748810",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/795b080d9aa127215a5baf088a22fa09341a0126",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/8ce081ad842510f0e70fa6065a401660eac876d4",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/8df52929530839e878e6912e33348b54101e3250",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}