{
  "id": "CVE-2024-47883",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-10-24T21:15:13.430",
  "lastModified": "2024-10-29T15:38:11.573",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The OpenRefine fork of the MIT Simile Butterfly server is a modular web application framework. The Butterfly framework uses the `java.net.URL` class to refer to (what are expected to be) local resource files, like images or templates. This works: \"opening a connection\" to these URLs opens the local file. However, prior to version 1.2.6, if a `file:/` URL is directly given where a relative path (resource name) is expected, this is also accepted in some code paths; the app then fetches the file, from a remote machine if indicated, and uses it as if it was a trusted part of the app's codebase. This leads to multiple weaknesses and potential weaknesses. An attacker that has network access to the application could use it to gain access to files, either on the the server's filesystem (path traversal) or shared by nearby machines (server-side request forgery with e.g. SMB). An attacker that can lead or redirect a user to a crafted URL belonging to the app could cause arbitrary attacker-controlled JavaScript to be loaded in the victim's browser (cross-site scripting). If an app is written in such a way that an attacker can influence the resource name used for a template, that attacker could cause the app to fetch and execute an attacker-controlled template (remote code execution). Version 1.2.6 contains a patch."
    },
    {
      "lang": "es",
      "value": "La bifurcaci\u00f3n OpenRefine del servidor MIT Simile Butterfly es un framework de trabajo de aplicaci\u00f3n web modular. El framework Butterfly utiliza la clase `java.net.URL` para hacer referencia a (lo que se espera que sean) archivos de recursos locales, como im\u00e1genes o plantillas. Esto funciona: \"abrir una conexi\u00f3n\" a estas URL abre el archivo local. Sin embargo, antes de la versi\u00f3n 1.2.6, si se proporciona directamente una URL `file:/` donde se espera una ruta relativa (nombre del recurso), esto tambi\u00e9n se acepta en algunas rutas de c\u00f3digo; la aplicaci\u00f3n luego obtiene el archivo, desde una m\u00e1quina remota si se indica, y lo usa como si fuera una parte confiable de la base de c\u00f3digo de la aplicaci\u00f3n. Esto conduce a m\u00faltiples debilidades y debilidades potenciales. Un atacante que tenga acceso de red a la aplicaci\u00f3n podr\u00eda usarlo para obtener acceso a archivos, ya sea en el sistema de archivos del servidor (path traversal) o compartidos por m\u00e1quinas cercanas (server-side request forgery con, por ejemplo, SMB). Un atacante que pueda dirigir o redirigir a un usuario a una URL manipulada que pertenezca a la aplicaci\u00f3n podr\u00eda provocar que se cargue c\u00f3digo JavaScript arbitrario controlado por el atacante en el navegador de la v\u00edctima (cross-site scripting). Si una aplicaci\u00f3n est\u00e1 escrita de tal manera que un atacante puede influir en el nombre del recurso utilizado para una plantilla, ese atacante podr\u00eda provocar que la aplicaci\u00f3n obtenga y ejecute una plantilla controlada por el atacante (ejecuci\u00f3n de c\u00f3digo remoto). La versi\u00f3n 1.2.6 contiene un parche."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-36"
        },
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:openrefine:butterfly:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "1.2.6",
              "matchCriteriaId": "11B5F36B-35D1-4FAA-AA42-E0E498458672"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/OpenRefine/simile-butterfly/commit/537f64bfa72746f8b21d4bda461fad843435319c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://github.com/OpenRefine/simile-butterfly/security/advisories/GHSA-3p8v-w8mr-m3x8",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}