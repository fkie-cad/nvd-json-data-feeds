{
  "id": "CVE-2024-52292",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-11-13T17:15:12.303",
  "lastModified": "2024-11-19T18:27:21.567",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Craft is a content management system (CMS). The dataUrl function can be exploited if an attacker has write permissions on system notification templates. This function accepts an absolute file path, reads the file's content, and converts it into a Base64-encoded string. By embedding this function within a system notification template, the attacker can exfiltrate the Base64-encoded file content through a triggered system email notification. Once the email is received, the Base64 payload can be decoded, allowing the attacker to read arbitrary files on the server. This is fixed in 5.4.9 and 4.12.8."
    },
    {
      "lang": "es",
      "value": "Craft es un sistema de gesti\u00f3n de contenido (CMS). La funci\u00f3n dataUrl puede ser explotada si un atacante tiene permisos de escritura en las plantillas de notificaci\u00f3n del sistema. Esta funci\u00f3n acepta una ruta de archivo absoluta, lee el contenido del archivo y lo convierte en una cadena codificada en Base64. Al incorporar esta funci\u00f3n dentro de una plantilla de notificaci\u00f3n del sistema, el atacante puede extraer el contenido del archivo codificado en Base64 a trav\u00e9s de una notificaci\u00f3n de correo electr\u00f3nico del sistema activada. Una vez que se recibe el correo electr\u00f3nico, el payload Base64 puede ser decodificada, lo que permite al atacante leer archivos arbitrarios en el servidor. Esto se solucion\u00f3 en 5.4.9 y 4.12.8."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "baseScore": 7.7,
          "baseSeverity": "HIGH",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 4.0
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        },
        {
          "lang": "en",
          "value": "CWE-552"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.5.13",
              "versionEndExcluding": "4.12.8",
              "matchCriteriaId": "74204976-99F1-4762-ADBE-6291C8B713AE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:craftcms:craft_cms:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.0.0",
              "versionEndExcluding": "5.4.9",
              "matchCriteriaId": "FD307FDB-0A13-4F45-BEFE-69AD29E6C3D0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/craftcms/cms/security/advisories/GHSA-cw6g-qmjq-6w2w",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Vendor Advisory"
      ]
    }
  ]
}