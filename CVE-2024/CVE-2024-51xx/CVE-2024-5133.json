{
  "id": "CVE-2024-5133",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-06-06T19:16:05.557",
  "lastModified": "2024-06-07T14:56:05.647",
  "vulnStatus": "Awaiting Analysis",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In lunary-ai/lunary version 1.2.4, an account takeover vulnerability exists due to the exposure of password recovery tokens in API responses. Specifically, when a user initiates the password reset process, the recovery token is included in the response of the `GET /v1/users/me/org` endpoint, which lists all users in a team. This allows any authenticated user to capture the recovery token of another user and subsequently change that user's password without consent, effectively taking over the account. The issue lies in the inclusion of the `recovery_token` attribute in the users object returned by the API."
    },
    {
      "lang": "es",
      "value": "En lunary-ai/lunary versi\u00f3n 1.2.4, existe una vulnerabilidad de apropiaci\u00f3n de cuenta debido a la exposici\u00f3n de tokens de recuperaci\u00f3n de contrase\u00f1a en las respuestas de API. Espec\u00edficamente, cuando un usuario inicia el proceso de restablecimiento de contrase\u00f1a, el token de recuperaci\u00f3n se incluye en la respuesta del endpoint `GET /v1/users/me/org`, que enumera todos los usuarios de un equipo. Esto permite que cualquier usuario autenticado capture el token de recuperaci\u00f3n de otro usuario y posteriormente cambie la contrase\u00f1a de ese usuario sin consentimiento, asumiendo efectivamente el control de la cuenta. El problema radica en la inclusi\u00f3n del atributo `recovery_token` en el objeto de usuario devuelto por la API."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://huntr.com/bounties/6057598d-93c4-4a94-bb80-5bd508013c5b",
      "source": "security@huntr.dev"
    }
  ]
}