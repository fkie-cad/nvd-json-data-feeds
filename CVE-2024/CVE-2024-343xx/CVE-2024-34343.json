{
  "id": "CVE-2024-34343",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2024-08-05T21:15:38.257",
  "lastModified": "2024-09-19T19:57:52.007",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Nuxt is a free and open-source framework to create full-stack web applications and websites with Vue.js. The `navigateTo` function attempts to blockthe `javascript:` protocol, but does not correctly use API's provided by `unjs/ufo`. This library also contains parsing discrepancies.  The function first tests to see if the specified URL has a protocol. This uses the unjs/ufo package for URL parsing. This function works effectively, and returns true for a javascript: protocol. After this, the URL is parsed using the parseURL function. This function will refuse to parse poorly formatted URLs. Parsing javascript:alert(1) returns null/\"\" for all values. Next, the protocol of the URL is then checked using the isScriptProtocol function. This function simply checks the input against a list of protocols, and does not perform any parsing. The combination of refusing to parse poorly formatted URLs, and not performing additional parsing means that script checks fail as no protocol can be found. Even if a protocol was identified, whitespace is not stripped in the parseURL implementation, bypassing the isScriptProtocol checks. Certain special protocols are identified at the top of parseURL. Inserting a newline or tab into this sequence will block the special protocol check, and bypass the latter checks. This ONLY has impact after SSR has occured, the `javascript:` protocol within a location header does not trigger XSS. This issue has been addressed in release version 3.12.4 and all users are advised to upgrade. There are no known workarounds for this vulnerability."
    },
    {
      "lang": "es",
      "value": "Nuxt es un framework gratuito y de c\u00f3digo abierto para crear sitios web y aplicaciones web completos con Vue.js. La funci\u00f3n `navigateTo` intenta bloquear el protocolo `javascript:`, pero no utiliza correctamente las API proporcionadas por `unjs/ufo`. Esta biblioteca tambi\u00e9n contiene discrepancias en el an\u00e1lisis. La funci\u00f3n primero prueba para ver si la URL especificada tiene un protocolo. Esto utiliza el paquete unjs/ufo para el an\u00e1lisis de URL. Esta funci\u00f3n funciona de manera efectiva y devuelve verdadero para un protocolo javascript:. Despu\u00e9s de esto, la URL se analiza utilizando la funci\u00f3n parseURL. Esta funci\u00f3n se negar\u00e1 a analizar URL mal formateadas. El an\u00e1lisis de javascript:alert(1) devuelve null/\"\" para todos los valores. A continuaci\u00f3n, se verifica el protocolo de la URL utilizando la funci\u00f3n isScriptProtocol. Esta funci\u00f3n simplemente compara la entrada con una lista de protocolos y no realiza ning\u00fan an\u00e1lisis. La combinaci\u00f3n de negarse a analizar URL mal formateadas y no realizar an\u00e1lisis adicionales significa que las comprobaciones de secuencias de comandos fallan porque no se puede encontrar ning\u00fan protocolo. Incluso si se identific\u00f3 un protocolo, los espacios en blanco no se eliminan en la implementaci\u00f3n de parseURL, evitando las comprobaciones de isScriptProtocol. Ciertos protocolos especiales se identifican en la parte superior de parseURL. Insertar una nueva l\u00ednea o una pesta\u00f1a en esta secuencia bloquear\u00e1 la verificaci\u00f3n del protocolo especial y omitir\u00e1 las \u00faltimas comprobaciones. Esto S\u00d3LO tiene impacto despu\u00e9s de que se haya producido SSR, el protocolo `javascript:` dentro de un encabezado de ubicaci\u00f3n no activa XSS. Este problema se solucion\u00f3 en la versi\u00f3n 3.12.4 y se recomienda a todos los usuarios que actualicen. No se conocen workarounds para esta vulnerabilidad."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nuxt:nuxt:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.12.4",
              "matchCriteriaId": "BB92C785-9011-406E-A048-9FEC653045EC"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/nuxt/nuxt/security/advisories/GHSA-vf6r-87q4-2vjf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}