{
  "id": "CVE-2024-27437",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-04-05T09:15:09.443",
  "lastModified": "2024-04-10T15:16:04.823",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nvfio/pci: Disable auto-enable of exclusive INTx IRQ\n\nCurrently for devices requiring masking at the irqchip for INTx, ie.\ndevices without DisINTx support, the IRQ is enabled in request_irq()\nand subsequently disabled as necessary to align with the masked status\nflag.  This presents a window where the interrupt could fire between\nthese events, resulting in the IRQ incrementing the disable depth twice.\nThis would be unrecoverable for a user since the masked flag prevents\nnested enables through vfio.\n\nInstead, invert the logic using IRQF_NO_AUTOEN such that exclusive INTx\nis never auto-enabled, then unmask as required."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: vfio/pci: deshabilita la habilitaci\u00f3n autom\u00e1tica de INTx IRQ exclusivo. Actualmente, para dispositivos que requieren enmascaramiento en el irqchip para INTx, es decir. En dispositivos sin soporte DisINTx, la IRQ se habilita en request_irq() y posteriormente se deshabilita seg\u00fan sea necesario para alinearse con el indicador de estado enmascarado. Esto presenta una ventana donde la interrupci\u00f3n podr\u00eda dispararse entre estos eventos, lo que hace que la IRQ incremente la profundidad de desactivaci\u00f3n dos veces. Esto ser\u00eda irrecuperable para un usuario ya que el indicador enmascarado impide las habilitaciones anidadas a trav\u00e9s de vfio. En su lugar, invierta la l\u00f3gica usando IRQF_NO_AUTOEN de modo que INTx exclusivo nunca se habilite autom\u00e1ticamente, luego desenmascare seg\u00fan sea necesario."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/139dfcc4d723ab13469881200c7d80f49d776060",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/2a4a666c45107206605b7b5bc20545f8aabc4fa2",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/3b3491ad0f80d913e7d255941d4470f4a4d9bfda",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/b7a2f0955ffceffadfe098b40b50307431f45438",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/bf0bc84a20e6109ab07d5dc072067bd01eb931ec",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/fe9a7082684eb059b925c535682e68c34d487d43",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}