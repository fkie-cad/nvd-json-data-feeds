{
  "id": "CVE-2024-21878",
  "sourceIdentifier": "csirt@divd.nl",
  "published": "2024-08-12T13:38:15.107",
  "lastModified": "2024-08-23T17:52:11.777",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Improper Neutralization of Special Elements used in a Command ('Command Injection') vulnerability in Enphase IQ Gateway (formerly known as Envoy) allows OS Command Injection. This vulnerability is present in an internal script.This issue affects Envoy: from 4.x up to and including 8.x and is currently unpatched."
    },
    {
      "lang": "es",
      "value": "La neutralizaci\u00f3n inadecuada de elementos especiales utilizados en una vulnerabilidad de comando (\"Inyecci\u00f3n de comando\") en Enphase IQ Gateway (anteriormente conocido como Envoy) permite la inyecci\u00f3n de comando del sistema operativo. Esta vulnerabilidad est\u00e1 presente en un script interno. Este problema afecta a Envoy: desde 4.x hasta 8.x inclusive y actualmente no est\u00e1 parcheado."
    }
  ],
  "metrics": {
    "cvssMetricV40": [
      {
        "source": "csirt@divd.nl",
        "type": "Secondary",
        "cvssData": {
          "version": "4.0",
          "vectorString": "CVSS:4.0/AV:N/AC:H/AT:N/PR:N/UI:N/VC:H/VI:H/VA:H/SC:L/SI:L/SA:L/E:X/CR:X/IR:X/AR:X/MAV:X/MAC:X/MAT:X/MPR:X/MUI:X/MVC:X/MVI:X/MVA:X/MSC:X/MSI:X/MSA:X/S:P/AU:Y/R:I/V:C/RE:H/U:X",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "attackRequirements": "NONE",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "vulnerableSystemConfidentiality": "HIGH",
          "vulnerableSystemIntegrity": "HIGH",
          "vulnerableSystemAvailability": "HIGH",
          "subsequentSystemConfidentiality": "LOW",
          "subsequentSystemIntegrity": "LOW",
          "subsequentSystemAvailability": "LOW",
          "exploitMaturity": "NOT_DEFINED",
          "confidentialityRequirements": "NOT_DEFINED",
          "integrityRequirements": "NOT_DEFINED",
          "availabilityRequirements": "NOT_DEFINED",
          "modifiedAttackVector": "NOT_DEFINED",
          "modifiedAttackComplexity": "NOT_DEFINED",
          "modifiedAttackRequirements": "NOT_DEFINED",
          "modifiedPrivilegesRequired": "NOT_DEFINED",
          "modifiedUserInteraction": "NOT_DEFINED",
          "modifiedVulnerableSystemConfidentiality": "NOT_DEFINED",
          "modifiedVulnerableSystemIntegrity": "NOT_DEFINED",
          "modifiedVulnerableSystemAvailability": "NOT_DEFINED",
          "modifiedSubsequentSystemConfidentiality": "NOT_DEFINED",
          "modifiedSubsequentSystemIntegrity": "NOT_DEFINED",
          "modifiedSubsequentSystemAvailability": "NOT_DEFINED",
          "safety": "PRESENT",
          "automatable": "YES",
          "recovery": "IRRECOVERABLE",
          "valueDensity": "CONCENTRATED",
          "vulnerabilityResponseEffort": "HIGH",
          "providerUrgency": "NOT_DEFINED",
          "baseScore": 9.2,
          "baseSeverity": "CRITICAL"
        }
      }
    ],
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-78"
        }
      ]
    },
    {
      "source": "csirt@divd.nl",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-77"
        }
      ]
    }
  ],
  "configurations": [
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:enphase:iq_gateway_firmware:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0",
              "versionEndExcluding": "8.2.4225",
              "matchCriteriaId": "045C0178-42FE-4511-A182-AF3BA9545EF0"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:h:enphase:iq_gateway:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "75882BE4-CF58-44B5-BA30-DD13BDFF78C0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://csirt.divd.nl/CVE-2024-21878",
      "source": "csirt@divd.nl",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://csirt.divd.nl/DIVD-2024-00011",
      "source": "csirt@divd.nl",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://enphase.com/cybersecurity/advisories/ensa-2024-3",
      "source": "csirt@divd.nl",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}