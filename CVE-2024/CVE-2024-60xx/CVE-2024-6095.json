{
  "id": "CVE-2024-6095",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-07-06T18:15:02.277",
  "lastModified": "2024-07-09T17:41:10.523",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A vulnerability in the /models/apply endpoint of mudler/localai versions 2.15.0 allows for Server-Side Request Forgery (SSRF) and partial Local File Inclusion (LFI). The endpoint supports both http(s):// and file:// schemes, where the latter can lead to LFI. However, the output is limited due to the length of the error message. This vulnerability can be exploited by an attacker with network access to the LocalAI instance, potentially allowing unauthorized access to internal HTTP(s) servers and partial reading of local files. The issue is fixed in version 2.17."
    },
    {
      "lang": "es",
      "value": "Una vulnerabilidad en el endpoint /models/apply de mudler/localai versiones 2.15.0 permite Server Side Request Forgery (SSRF) y la inclusi\u00f3n parcial de archivos locales (LFI). El endpoint admite los esquemas http(s):// y file://, donde este \u00faltimo puede conducir a LFI. Sin embargo, el resultado es limitado debido a la longitud del mensaje de error. Esta vulnerabilidad puede ser aprovechada por un atacante con acceso de red a la instancia de LocalAI, lo que podr\u00eda permitir el acceso no autorizado a servidores HTTP internos y la lectura parcial de archivos locales. El problema se solucion\u00f3 en la versi\u00f3n 2.17."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:mudler:localai:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.17.0",
              "matchCriteriaId": "F0DD3929-60FF-42EA-8255-D0057E2DF8BF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/mudler/localai/commit/2fc6fe806b903ac0a70218b21b5c84443a1b0866",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/4799262d-72dc-43c8-bc99-81d0dce996dc",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}