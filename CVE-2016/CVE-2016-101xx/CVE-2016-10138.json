{
  "id": "CVE-2016-10138",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2017-01-13T09:59:00.263",
  "lastModified": "2017-03-16T01:59:00.730",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered on BLU Advance 5.0 and BLU R1 HD devices with Shanghai Adups software. The com.adups.fota.sysoper app is installed as a system app and cannot be disabled by the user. In the com.adups.fota.sysoper app's AndroidManifest.xml file, it sets the android:sharedUserId attribute to a value of android.uid.system which makes it execute as the system user, which is a very privileged user on the device. The app has an exported broadcast receiver named com.adups.fota.sysoper.WriteCommandReceiver which any app on the device can interact with. Therefore, any app can send a command embedded in an intent which will be executed by the WriteCommandReceiver component which is executing as the system user. The third-party app, utilizing the WriteCommandReceiver, can perform the following actions: call a phone number, factory reset the device, take pictures of the screen, record the screen in a video, install applications, inject events, obtain the Android log, and others. In addition, the com.adups.fota.sysoper.TaskService component will make a request to a URL of http://rebootv5.adsunflower.com/ps/fetch.do where the commands in the String array with a key of sf in the JSON Object sent back by the server will be executed as the system user. Since the connection is made via HTTP, it is vulnerable to a MITM attack."
    },
    {
      "lang": "es",
      "value": "Se descubri\u00f3 un problema en los dispositivos BLU Advance 5.0 y BLU R1 HD con software Shanghai Adups. La aplicaci\u00f3n com.adups.fota.sysoper est\u00e1 instalada como una aplicaci\u00f3n del sistema y no puede ser deshabilitada por el usuario. En el archivo AndroidManifest.xml de la aplicaci\u00f3n com.adups.fota.sysoper, establece el atributo android: sharedUserId en un valor de android.uid.system que lo hace ejecutar como el usuario del sistema, el cual es un usuario muy privilegiado en el dispositivo. La aplicaci\u00f3n tiene un receptor de difusi\u00f3n exportado llamado com.adups.fota.sysoper.WriteCommandReceiver con el que cualquier aplicaci\u00f3n del dispositivo puede interactuar. Por lo tanto, cualquier aplicaci\u00f3n puede enviar un comando incrustado en un intento que ser\u00e1 ejecutado por el componente WriteCommandReceiver que se est\u00e1 ejecutando como usuario del sistema. La aplicaci\u00f3n de terceros, utilizando el WriteCommandReceiver, puede realizar las siguientes acciones: llamar a un n\u00famero de tel\u00e9fono, restablecer el dispositivo de f\u00e1brica, tomar im\u00e1genes de la pantalla, grabar la pantalla en un v\u00eddeo, instalar aplicaciones, inyectar eventos, obtener el registro de Android y otros. Adem\u00e1s, el componente com.adups.fota.sysoper.TaskService har\u00e1 una solicitud a una URL de http://rebootv5.adsunflower.com/ps/fetch.do donde los comandos en el array String con una clave de sf en el objeto JSON enviado de vuelta por el servidor se ejecutar\u00e1 como el usuario del sistema. Dado que la conexi\u00f3n se realiza a trav\u00e9s de HTTP, es vulnerable a un ataque MITM."
    }
  ],
  "metrics": {
    "cvssMetricV30": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.2
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 3.9,
        "impactScore": 10.0,
        "acInsufInfo": true,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-310"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:adups:adups_fota:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "D8B2E488-EEE4-4C16-B1F6-BD5847A0DE1A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.securityfocus.com/bid/96853",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://www.kryptowire.com/adups_security_analysis.html",
      "source": "cve@mitre.org",
      "tags": [
        "Technical Description",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.nytimes.com/2016/11/16/us/politics/china-phones-software-security.html",
      "source": "cve@mitre.org",
      "tags": [
        "Press/Media Coverage"
      ]
    }
  ]
}