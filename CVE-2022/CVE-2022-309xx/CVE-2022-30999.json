{
  "id": "CVE-2022-30999",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-06-02T14:15:56.373",
  "lastModified": "2022-06-10T16:02:14.483",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "FriendsofFlarum (FoF) Upload is an extension that handles file uploads intelligently for your forum. If FoF Upload prior to version 1.2.3 is configured to allow the uploading of SVG files ('image/svg+xml'), navigating directly to an SVG file URI could execute arbitrary Javascript code decided by an attacker. This Javascript code could include the execution of HTTP web requests to Flarum, or any other web service. This could allow data to be leaked by an authenticated Flarum user, or, possibly, for data to be modified maliciously. This issue has been patched with v1.2.3, which now sanitizes uploaded SVG files. As a workaround, remove the ability for users to upload SVG files through FoF Upload."
    },
    {
      "lang": "es",
      "value": "FriendsofFlarum (FoF) Upload es una extensi\u00f3n que maneja las subidas de archivos de forma inteligente para su foro. Si FoF Upload versiones anteriores a 1.2.3, est\u00e1 configurado para permitir la subida de archivos SVG (\"image/svg+xml\"), la navegaci\u00f3n directa a un URI de archivo SVG podr\u00eda ejecutar c\u00f3digo Javascript arbitrario decidido por un atacante. Este c\u00f3digo Javascript podr\u00eda incluir la ejecuci\u00f3n de peticiones web HTTP a Flarum, o a cualquier otro servicio web. Esto podr\u00eda permitir la filtraci\u00f3n de datos por parte de un usuario autenticado de Flarum, o, posiblemente, la modificaci\u00f3n de datos de forma maliciosa. Este problema ha sido parcheado con la versi\u00f3n v1.2.3, que ahora sanea los archivos SVG cargados. Como mitigaci\u00f3n , elimine la posibilidad de que los usuarios suban archivos SVG mediante FoF Upload"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 8.7,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 5.8
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 3.5
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 6.8,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:friendsofflarum:upload:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.2.3",
              "matchCriteriaId": "4032D11B-9F0D-4933-B0DE-4234C95F6448"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/FriendsOfFlarum/upload/issues/68",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FriendsOfFlarum/upload/pull/318",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FriendsOfFlarum/upload/releases/tag/1.2.3",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/FriendsOfFlarum/upload/security/advisories/GHSA-fm53-mpmp-7qw2",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}