{
  "id": "CVE-2022-24128",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-03-13T18:15:07.947",
  "lastModified": "2023-11-07T22:15:10.797",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "Timescale TimescaleDB 1.x and 2.x before 2.5.2 may allow privilege escalation during extension installation. The installation process uses commands such as CREATE x IF NOT EXIST that allow an unprivileged user to precreate objects. These objects will be used by the installer (which executes as Superuser), leading to privilege escalation. In order to be able to take advantage of this, an unprivileged user would need to be able to create objects in a database and then get a Superuser to install TimescaleDB into their database. (In the fixed versions, the installation aborts when it finds that an object already exists.)"
    },
    {
      "lang": "es",
      "value": "Timescale TimescaleDB 1.x y 2.x antes de 2.5.2 pueden permitir la escalada de privilegios durante la instalaci\u00f3n de la extensi\u00f3n. El proceso de instalaci\u00f3n utiliza comandos como CREATE x IF NOT EXIST que permiten a un usuario sin privilegios precrear objetos. Estos objetos ser\u00e1n utilizados por el instalador (que se ejecuta como superusuario), lo que lleva a una escalada de privilegios. Para poder aprovecharse de esto, un usuario sin privilegios tendr\u00eda que ser capaz de crear objetos en una base de datos y luego conseguir que un Superusuario instale TimescaleDB en su base de datos. (En las versiones fijas, la instalaci\u00f3n aborta cuando encuentra que un objeto ya existe)"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.0,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 6.8,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-863"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:timescale:timescaledb:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.0.0",
              "versionEndExcluding": "2.5.2",
              "matchCriteriaId": "6DAF4ECE-BF78-442E-8587-87FB23AF7E62"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.timescale.com/timescaledb/latest/overview/release-notes/",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/timescale/timescaledb/commit/6275c2985927cfd4900b85cac5120227c8cb1f0c",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://github.com/timescale/timescaledb/commit/c8b8516e466c2bb7d2ae6a4b0b2e8e60b24b24a2",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://github.com/timescale/timescaledb/security/advisories/GHSA-fh8v-663w-79w9",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}