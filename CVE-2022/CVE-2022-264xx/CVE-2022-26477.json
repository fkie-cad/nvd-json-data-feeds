{
  "id": "CVE-2022-26477",
  "sourceIdentifier": "security@apache.org",
  "published": "2022-06-27T18:15:08.853",
  "lastModified": "2022-10-29T02:45:51.367",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "The Security Team noticed that the termination condition of the for loop in the readExternal method is a controllable variable, which, if tampered with, may lead to CPU exhaustion. As a fix, we added an upper bound and termination condition in the read and write logic. We classify it as a \"low-priority but useful improvement\". SystemDS is a distributed system and needs to serialize/deserialize data but in many code paths (e.g., on Spark broadcast/shuffle or writing to sequence files) the byte stream is anyway protected by additional CRC fingerprints. In this particular case though, the number of decoders is upper-bounded by twice the number of columns, which means an attacker would need to modify two entries in the byte stream in a consistent manner. By adding these checks robustness was strictly improved with almost zero overhead. These code changes are available in versions higher than 2.2.1."
    },
    {
      "lang": "es",
      "value": "El equipo de seguridad ha notado que la condici\u00f3n de terminaci\u00f3n del bucle for en el m\u00e9todo readExternal es una variable controlable que, si es manipulada, puede conllevar a un agotamiento de la CPU. Como correcci\u00f3n, a\u00f1adimos un l\u00edmite superior y una condici\u00f3n de terminaci\u00f3n en la l\u00f3gica de lectura y escritura. Lo clasificamos como una \"mejora de baja prioridad pero \u00fatil\". SystemDS es un sistema distribuido y necesita serializar/de serializar datos, pero en muchas rutas de c\u00f3digo (por ejemplo, en Spark broadcast/shuffle o escribiendo en archivos de secuencia) el flujo de bytes est\u00e1 de todas formas protegido por huellas digitales CRC adicionales. Sin embargo, en este caso particular, el n\u00famero de decodificadores est\u00e1 limitado por el doble del n\u00famero de columnas, lo que significa que un atacante necesitar\u00eda modificar dos entradas en el flujo de bytes de manera consistente. Al a\u00f1adir estas comprobaciones ha sido mejorado estrictamente la robustez con una sobrecarga casi nula. Estos cambios de c\u00f3digo est\u00e1n disponibles en las versiones superiores a 2.2.1"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-400"
        }
      ]
    },
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-400"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:systemds:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "2.2.1",
              "matchCriteriaId": "71D41242-66BA-47F6-AFEC-0D21EBCAC538"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.apache.org/thread/r4x2d2r6d4zykdrrx6s2l4qbxgzws0z3",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20220812-0003/",
      "source": "security@apache.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}