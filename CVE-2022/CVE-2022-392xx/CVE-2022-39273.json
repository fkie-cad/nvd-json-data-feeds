{
  "id": "CVE-2022-39273",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-10-06T18:16:15.160",
  "lastModified": "2022-12-09T16:45:29.123",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "FlyteAdmin is the control plane for the data processing platform Flyte. Users who enable the default Flyte\u2019s authorization server without changing the default clientid hashes will be exposed to the public internet. In an effort to make enabling authentication easier for Flyte administrators, the default configuration for Flyte Admin allows access for Flyte Propeller even after turning on authentication via a hardcoded hashed password. This password is also set on the default Flyte Propeller configmap in the various Flyte Helm charts. Users who enable auth but do not override this setting in Flyte Admin\u2019s configuration may unbeknownst to them be allowing public traffic in by way of this default password with attackers effectively impersonating propeller. This only applies to users who have not specified the ExternalAuthorizationServer setting. Usage of an external auth server automatically turns off this default configuration and are not susceptible to this vulnerability. This issue has been addressed in version 1.1.44. Users should manually set the staticClients in the selfAuthServer section of their configuration if they intend to rely on Admin\u2019s internal auth server. Again, users who use an external auth server are automatically protected from this vulnerability."
    },
    {
      "lang": "es",
      "value": "FlyteAdmin es el plano de control de la plataforma de procesamiento de datos Flyte. Los usuarios que habiliten el servidor de autorizaci\u00f3n de Flyte por defecto sin cambiar los hashes clientid por defecto estar\u00e1n expuestos a la Internet p\u00fablica. En un esfuerzo por hacer m\u00e1s f\u00e1cil la habilitaci\u00f3n de la autenticaci\u00f3n para los administradores de Flyte, la configuraci\u00f3n por defecto para Flyte Admin permite el acceso para Flyte Propeller incluso despu\u00e9s de activar la autenticaci\u00f3n por medio de una contrase\u00f1a hash embebida. Esta contrase\u00f1a tambi\u00e9n es establecido en el mapa de configuraci\u00f3n por defecto de Flyte Propeller en los distintos cuadros de Flyte Helm. Los usuarios que habilitan la autenticaci\u00f3n pero no anulan este ajuste en la configuraci\u00f3n de Flyte Admin pueden, sin saberlo, estar permitiendo la entrada de tr\u00e1fico p\u00fablico mediante esta contrase\u00f1a por defecto con atacantes suplantando efectivamente a Propeller. Esto s\u00f3lo es aplicado a usuarios que no han especificado la configuraci\u00f3n de ExternalAuthorizationServer. El uso de un servidor de autenticaci\u00f3n externo desactiva autom\u00e1ticamente esta configuraci\u00f3n por defecto y no son susceptibles de esta vulnerabilidad. Este problema ha sido abordado en versi\u00f3n 1.1.44. Los usuarios deben establecer manualmente los staticClients en la secci\u00f3n selfAuthServer de su configuraci\u00f3n si pretenden confiar en el servidor de autenticaci\u00f3n interno de Admin. De nuevo, los usuarios que usan un servidor de autenticaci\u00f3n externo est\u00e1n autom\u00e1ticamente protegidos de esta vulnerabilidad"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 2.5
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-798"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:flyte:flyteadmin:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.1.44",
              "matchCriteriaId": "D6C9DF17-FAEE-4B41-8305-F2E15C61D678"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.flyte.org/en/latest/deployment/cluster_config/auth_setup.html#oauth2-authorization-server",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/flyteorg/flyteadmin/pull/478",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/flyteorg/flyteadmin/security/advisories/GHSA-67x4-qr35-qvrm",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}