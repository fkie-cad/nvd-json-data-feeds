{
  "id": "CVE-2022-49669",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2025-02-26T07:01:41.870",
  "lastModified": "2025-02-27T18:15:26.203",
  "vulnStatus": "Received",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nmptcp: fix race on unaccepted mptcp sockets\n\nWhen the listener socket owning the relevant request is closed,\nit frees the unaccepted subflows and that causes later deletion\nof the paired MPTCP sockets.\n\nThe mptcp socket's worker can run in the time interval between such delete\noperations. When that happens, any access to msk->first will cause an UaF\naccess, as the subflow cleanup did not cleared such field in the mptcp\nsocket.\n\nAddress the issue explicitly traversing the listener socket accept\nqueue at close time and performing the needed cleanup on the pending\nmsk.\n\nNote that the locking is a bit tricky, as we need to acquire the msk\nsocket lock, while still owning the subflow socket one."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se ha resuelto la siguiente vulnerabilidad: mptcp: corregir la ejecuci\u00f3n en sockets mptcp no aceptados Cuando se cierra el socket de escucha que posee la solicitud relevante, libera los subflujos no aceptados y eso provoca la eliminaci\u00f3n posterior de los sockets MPTCP emparejados. El trabajador del socket mptcp puede ejecutarse en el intervalo de tiempo entre dichas operaciones de eliminaci\u00f3n. Cuando eso sucede, cualquier acceso a msk-&gt;first provocar\u00e1 un acceso UaF, ya que la limpieza del subflujo no borr\u00f3 dicho campo en el socket mptcp. Aborde el problema recorriendo expl\u00edcitamente la cola de aceptaci\u00f3n del socket de escucha en el momento del cierre y realizando la limpieza necesaria en el msk pendiente. Tenga en cuenta que el bloqueo es un poco complicado, ya que necesitamos adquirir el bloqueo del socket msk, mientras a\u00fan poseemos el del socket del subflujo."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "baseScore": 7.8,
          "baseSeverity": "HIGH",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "134c704f-9b21-4f2e-91b3-4a467353bcc0",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-416"
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/6aeed9045071f2252ff4e98fc13d1e304f33e5b0",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/a8a3e95c74e48c2c9b07b81fafda9122993f2e12",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}