{
  "id": "CVE-2022-31008",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-10-06T18:16:00.783",
  "lastModified": "2022-11-07T20:20:06.360",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "RabbitMQ is a multi-protocol messaging and streaming broker. In affected versions the shovel and federation plugins perform URI obfuscation in their worker (link) state. The encryption key used to encrypt the URI was seeded with a predictable secret. This means that in case of certain exceptions related to Shovel and Federation plugins, reasonably easily deobfuscatable data could appear in the node log. Patched versions correctly use a cluster-wide secret for that purpose. This issue has been addressed and Patched versions: `3.10.2`, `3.9.18`, `3.8.32` are available. Users unable to upgrade should disable the Shovel and Federation plugins."
    },
    {
      "lang": "es",
      "value": "RabbitMQ es un broker de mensajer\u00eda y streaming multiprotocolo. En versiones afectadas los plugins shovel y federation llevan a cabo una ofuscaci\u00f3n de URI en su estado de trabajador (enlace). La clave de cifrado usada para cifrar el URI fue sembrada con un secreto predecible. Esto significa que en caso de determinadas excepciones relacionadas con los plugins Shovel y Federation, podr\u00edan aparecer datos razonablemente f\u00e1ciles de des ofuscar en el registro del nodo. Las versiones parcheadas usan correctamente un secreto para todo el cl\u00faster a tal efecto. Este problema se ha solucionado y las versiones parcheadas: \"3.10.2\", \"3.9.18\", \"3.8.32\" est\u00e1n disponibles. Los usuarios que no puedan actualizar deber\u00e1n deshabilitar los plugins Shovel y Federation"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-330"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:vmware:rabbitmq:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.8.32",
              "matchCriteriaId": "F7ACC5FD-236D-4454-B306-C5C8F70FB5B7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:vmware:rabbitmq:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.9.0",
              "versionEndExcluding": "3.9.18",
              "matchCriteriaId": "E6E32B0B-C0C0-4D8F-9EA0-A611F9542942"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:vmware:rabbitmq:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.10.0",
              "versionEndExcluding": "3.10.2",
              "matchCriteriaId": "99B5A575-A35B-4844-A3A6-647A0DAFC7AF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/rabbitmq/rabbitmq-server/pull/4841",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/rabbitmq/rabbitmq-server/security/advisories/GHSA-v9gv-xp36-jgj8",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}