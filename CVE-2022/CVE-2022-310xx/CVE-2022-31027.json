{
  "id": "CVE-2022-31027",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-06-09T13:15:08.527",
  "lastModified": "2022-06-16T01:27:42.667",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "OAuthenticator is an OAuth token library for the JupyerHub login handler. CILogonOAuthenticator is provided by the OAuthenticator package, and lets users log in to a JupyterHub via CILogon. This is primarily used to restrict a JupyterHub only to users of a given institute. The allowed_idps configuration trait of CILogonOAuthenticator is documented to be a list of domains that indicate the institutions whose users are authorized to access this JupyterHub. This authorization is validated by ensuring that the *email* field provided to us by CILogon has a *domain* that matches one of the domains listed in `allowed_idps`.If `allowed_idps` contains `berkeley.edu`, you might expect only users with valid current credentials provided by University of California, Berkeley to be able to access the JupyterHub. However, CILogonOAuthenticator does *not* verify which provider is used by the user to login, only the email address provided. So a user can login with a GitHub account that has email set to `<something>@berkeley.edu`, and that will be treated exactly the same as someone logging in using the UC Berkeley official Identity Provider. The patch fixing this issue makes a *breaking change* in how `allowed_idps` is interpreted. It's no longer a list of domains, but configuration representing the `EntityID` of the IdPs that are allowed, picked from the [list maintained by CILogon](https://cilogon.org/idplist/). Users are advised to upgrade."
    },
    {
      "lang": "es",
      "value": "OAuthenticator es una biblioteca de tokens OAuth para el administrador de inicio de sesi\u00f3n de JupyerHub. CILogonOAuthenticator es proporcionado por el paquete OAuthenticator, y permite a usuarios iniciar sesi\u00f3n en un JupyterHub por medio de CILogon. Es usado principalmente para restringir un JupyterHub s\u00f3lo a usuarios de un determinado instituto. El rasgo de configuraci\u00f3n allowed_idps de CILogonOAuthenticator est\u00e1 documentado para ser una lista de dominios que indican las instituciones cuyos usuarios est\u00e1n autorizados a acceder a este JupyterHub. Esta autorizaci\u00f3n es comprobada al asegurarse de que el campo *email* que nos proporciona CILogon presenta un *dominio* que coincide con uno de los dominios listados en \"allowed_idps\".Si \"allowed_idps\" contiene \"berkeley.edu\", se podr\u00eda esperar que s\u00f3lo usuarios con credenciales v\u00e1lidas actuales proporcionadas por la Universidad de California, Berkeley, puedan acceder al JupyterHub. Sin embargo, CILogonOAuthenticator *no* verifica qu\u00e9 proveedor usa el usuario para iniciar sesi\u00f3n, s\u00f3lo la direcci\u00f3n de correo electr\u00f3nico proporcionada. As\u00ed que un usuario puede iniciar sesi\u00f3n con una cuenta de GitHub que tenga el correo electr\u00f3nico configurado como \"(something)@berkeley.edu\", y eso ser\u00e1 tratado exactamente igual que alguien que inicie sesi\u00f3n usando el proveedor de identidad oficial de UC Berkeley. El parche que corrige este problema hace un *cambio radical* en la interpretaci\u00f3n de \"allowed_idps\". Ya no es una lista de dominios, sino una configuraci\u00f3n que representa el \"EntityID\" de los IdPs que est\u00e1n permitidos, escogidos de la [lista mantenida por CILogon](https://cilogon.org/idplist/). Es recomendado a usuarios actualizar"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.2,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.5
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-639"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:jupyter:oauthenticator:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "15.0.0",
              "matchCriteriaId": "060B73F9-BCFA-4C4D-B119-11AD934D61EA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/jupyterhub/oauthenticator/security/advisories/GHSA-r7v4-jwx9-wx43",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}