{
  "id": "CVE-2022-31014",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-07-05T18:15:07.937",
  "lastModified": "2022-07-14T11:45:02.043",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Nextcloud server is an open source personal cloud server. Affected versions were found to be vulnerable to SMTP command injection. The impact varies based on which commands are supported by the backend SMTP server. However, the main risk here is that the attacker can then hijack an already-authenticated SMTP session and run arbitrary SMTP commands as the email user, such as sending emails to other users, changing the FROM user, and so on. As before, this depends on the configuration of the server itself, but newlines should be sanitized to mitigate such arbitrary SMTP command injection. It is recommended that the Nextcloud Server is upgraded to 22.2.8 , 23.0.5 or 24.0.1. There are no known workarounds for this issue."
    },
    {
      "lang": "es",
      "value": "El servidor Nextcloud es un servidor de nube personal de c\u00f3digo abierto.&#xa0;Se detect\u00f3 que las versiones afectadas eran vulnerables a la inyecci\u00f3n de comandos SMTP.&#xa0;El impacto var\u00eda seg\u00fan los comandos admitidos por el servidor SMTP de back-end.&#xa0;Sin embargo, el principal riesgo aqu\u00ed es que el atacante puede secuestrar una sesi\u00f3n SMTP ya autenticada y ejecutar comandos SMTP arbitrarios como usuario de correo electr\u00f3nico, como enviar correos electr\u00f3nicos a otros usuarios, cambiar el usuario FROM, etc.&#xa0;Como antes, esto depende de la configuraci\u00f3n del servidor en s\u00ed, pero las nuevas l\u00edneas deben ser saneadas para mitigar la inyecci\u00f3n de comandos SMTP arbitrarios.&#xa0;Se recomienda que el servidor Nextcloud se actualice a versiones 22.2.8, 23.0.5 o 24.0.1.&#xa0;No se conocen mitigaciones adicionales para este problema"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:N/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 3.5,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 3.5
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 6.8,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-74"
        },
        {
          "lang": "en",
          "value": "CWE-93"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "19.0.13.7",
              "matchCriteriaId": "4A0185CC-9FA8-4682-89B0-0AC93B1CBE56"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "22.2.8",
              "matchCriteriaId": "742B4BEA-1893-4A82-AE79-4CC8B1399AE2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "20.0.0",
              "versionEndExcluding": "20.0.14.6",
              "matchCriteriaId": "B3FB92C1-CC92-4F1F-AADA-38494A92F889"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "21.0.0",
              "versionEndExcluding": "21.0.9.5",
              "matchCriteriaId": "6B52C258-BA00-4EC9-AF22-68CACA53AF97"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "23.0.0",
              "versionEndExcluding": "23.0.5",
              "matchCriteriaId": "20114710-5104-469C-B4E7-367508A97217"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "36FFA245-4B23-42FC-B950-3652CD55D15F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta1:*:*:*:*:*:*",
              "matchCriteriaId": "E65E86B3-3404-4667-AA53-E88C4F8CC62E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta2:*:*:*:*:*:*",
              "matchCriteriaId": "CF679687-CEEE-431F-8ACA-8491EBCBB664"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:beta3:*:*:*:*:*:*",
              "matchCriteriaId": "7F3BA72F-455C-45F9-B4FA-08E58734D42C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc1:*:*:*:*:*:*",
              "matchCriteriaId": "6B25150A-2FE1-4BBF-B39E-0F511BA7260B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "D0DAB287-6442-407C-91B7-FDD06AB34283"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:24.0.0:rc3:*:*:*:*:*:*",
              "matchCriteriaId": "CC263DA3-D9E7-4AB8-B17F-186B9FC110EB"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-264h-3v4w-6xh2",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nextcloud/server/pull/32428",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/1516377",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}