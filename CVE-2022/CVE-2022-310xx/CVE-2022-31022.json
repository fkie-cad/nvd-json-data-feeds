{
  "id": "CVE-2022-31022",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-06-01T20:15:08.037",
  "lastModified": "2025-05-27T21:09:18.610",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Bleve is a text indexing library for go. Bleve includes HTTP utilities under bleve/http package, that are used by its sample application. These HTTP methods pave way for exploitation of a node\u2019s filesystem where the bleve index resides, if the user has used bleve\u2019s own HTTP (bleve/http) handlers for exposing the access to the indexes. For instance, the CreateIndexHandler (`http/index_create.go`) and DeleteIndexHandler (`http/index_delete.go`) enable an attacker to create a bleve index (directory structure) anywhere where the user running the server has the write permissions and to delete recursively any directory owned by the same user account. Users who have used the bleve/http package for exposing access to bleve index without the explicit \nhandling for the Role Based Access Controls(RBAC) of the index assets would be impacted by this issue. Version 2.5.0 relocated the `http/` dir used _only_ by bleve-explorer to `blevesearch/bleve-explorer`, thereby addressing the issue. However, the http package is purely intended to be used for demonstration purposes. Bleve was never designed handle the RBACs, nor it was ever advertised to be used in that way. The collaborators of this project have decided to stay away from adding any authentication or authorization to bleve project at the moment. The bleve/http package is mainly for demonstration purposes and it lacks exhaustive validation of the user inputs as well as any authentication and authorization measures. It is recommended to not use bleve/http in production use cases."
    },
    {
      "lang": "es",
      "value": "Bleve es una biblioteca de indexaci\u00f3n de texto para go. Bleve incluye utilidades HTTP bajo el paquete bleve/http, que son utilizadas por su aplicaci\u00f3n de ejemplo. Estos m\u00e9todos HTTP allanan el camino para la explotaci\u00f3n del sistema de archivos de un nodo donde reside el \u00edndice bleve, si el usuario ha utilizado los propios manejadores HTTP de bleve (bleve/http) para exponer el acceso a los \u00edndices. Por ejemplo, los manejadores CreateIndexHandler (`http/index_create.go`) y DeleteIndexHandler (`http/index_delete.go`) permiten a un atacante crear un \u00edndice bleve (estructura de directorios) en cualquier lugar en el que el usuario que ejecuta el servidor tenga permisos de escritura y borrar recursivamente cualquier directorio propiedad de la misma cuenta de usuario. Los usuarios que hayan utilizado el paquete bleve/http para exponer el acceso al \u00edndice bleve sin el manejo expl\u00edcito de los controles de acceso basados en roles (RBAC) de los activos del \u00edndice se ver\u00edan afectados por este problema. No hay ning\u00fan parche para este problema porque el paquete http est\u00e1 destinado a ser utilizado exclusivamente para fines de demostraci\u00f3n. Bleve nunca fue dise\u00f1ado para manejar los RBACs, ni nunca fue anunciado para ser usado de esa manera. Los colaboradores de este proyecto han decidido no a\u00f1adir ninguna autenticaci\u00f3n o autorizaci\u00f3n al proyecto bleve por el momento. El paquete bleve/http es principalmente para fines de demostraci\u00f3n y carece de una validaci\u00f3n exhaustiva de las entradas del usuario, as\u00ed como de cualquier medida de autenticaci\u00f3n y autorizaci\u00f3n. Se recomienda no utilizar bleve/http en casos de uso en producci\u00f3n"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "baseScore": 6.2,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.5,
        "impactScore": 3.6
      },
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:N/I:P/A:N",
          "baseScore": 2.1,
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE"
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 3.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-288"
        },
        {
          "lang": "en",
          "value": "CWE-306"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-306"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:couchbase:bleve:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.1.0",
              "matchCriteriaId": "80A74AE5-5182-4842-B9C2-373E4C432D06"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/blevesearch/bleve/commit/1c7509d6a17d36f265c90b4e8f4e3a3182fe79ff",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/blevesearch/bleve/commit/af9e3111dadfedf9d30f0448506b4a57fecc8550",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/blevesearch/bleve/commit/1c7509d6a17d36f265c90b4e8f4e3a3182fe79ff",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/blevesearch/bleve/security/advisories/GHSA-9w9f-6mg8-jp7w",
      "source": "af854a3a-2127-422b-91ae-364da2661108",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}