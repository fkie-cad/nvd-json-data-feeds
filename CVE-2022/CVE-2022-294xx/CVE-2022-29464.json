{
  "id": "CVE-2022-29464",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-04-18T22:15:09.027",
  "lastModified": "2024-07-02T17:05:29.787",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "cisaExploitAdd": "2022-04-25",
  "cisaActionDue": "2022-05-16",
  "cisaRequiredAction": "Apply updates per vendor instructions.",
  "cisaVulnerabilityName": "WSO2 Multiple Products Unrestrictive Upload of File Vulnerability",
  "descriptions": [
    {
      "lang": "en",
      "value": "Certain WSO2 products allow unrestricted file upload with resultant remote code execution. The attacker must use a /fileupload endpoint with a Content-Disposition directory traversal sequence to reach a directory under the web root, such as a ../../../../repository/deployment/server/webapps directory. This affects WSO2 API Manager 2.2.0 up to 4.0.0, WSO2 Identity Server 5.2.0 up to 5.11.0, WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 and 5.6.0, WSO2 Identity Server as Key Manager 5.3.0 up to 5.11.0, WSO2 Enterprise Integrator 6.2.0 up to 6.6.0, WSO2 Open Banking AM 1.4.0 up to 2.0.0 and WSO2 Open Banking KM 1.4.0, up to 2.0.0."
    },
    {
      "lang": "es",
      "value": "Algunos productos WSO2 permiten la carga de archivos sin restricciones con la consiguiente ejecuci\u00f3n remota de c\u00f3digo. El atacante debe utilizar un endpoint /fileupload con una secuencia de recorrido de directorio Content-Disposition para alcanzar un directorio bajo la ra\u00edz web, como un directorio ../../../../repositorio/despliegue/servidor/webapps. Esto afecta a WSO2 API Manager 2.2.0 y superior hasta 4.0.0; WSO2 Identity Server 5.2.0 y superior hasta 5.11.0; WSO2 Identity Server Analytics 5.4.0, 5.4.1, 5.5.0 y 5.6.0; WSO2 Identity Server as Key Manager 5.3.0 y superior hasta 5.10.0; y WSO2 Enterprise Integrator 6.2.0 y superior hasta 6.6.0"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "cve@mitre.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 10.0
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:api_manager:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.2.0",
              "versionEndIncluding": "4.0.0",
              "matchCriteriaId": "C0460F2B-2C36-4C93-85B6-7810E9C5B68F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:enterprise_integrator:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "6.2.0",
              "versionEndIncluding": "6.6.0",
              "matchCriteriaId": "054C6F0A-DC86-4CFC-B304-7BC93B708494"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.2.0",
              "versionEndIncluding": "5.11.0",
              "matchCriteriaId": "F16D1A0F-F00F-4471-A11A-7C3D6B83E7CB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server_analytics:5.4.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "C32F5725-22BA-417A-B2A6-F120CA377E39"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server_analytics:5.4.1:*:*:*:*:*:*:*",
              "matchCriteriaId": "B388C2B1-89EF-4D16-AD6A-675BDC6E3854"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server_analytics:5.5.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "42BFE7A0-A168-4C1E-8725-41DD500C837E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server_analytics:5.6.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "5508EC5E-BEEA-49A7-BA2E-AEF40ECCB5C8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:identity_server_as_key_manager:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.3.0",
              "versionEndIncluding": "5.10.0",
              "matchCriteriaId": "77334E1B-A4C9-40A1-8ED9-7123476817E5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:open_banking_am:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.3.0",
              "versionEndIncluding": "2.0.0",
              "matchCriteriaId": "3B9E4BCA-7BD2-442F-B99B-734232249C04"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:open_banking_iam:2.0.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "D7C241A3-8EA0-41E4-ABF3-21B9D8E7A5BE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wso2:open_banking_km:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.3.0",
              "versionEndIncluding": "1.5.0",
              "matchCriteriaId": "A8364191-344F-4F73-A9CF-2516F24E856C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/166921/WSO-Arbitrary-File-Upload-Remote-Code-Execution.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory",
        "VDB Entry"
      ]
    },
    {
      "url": "http://www.openwall.com/lists/oss-security/2022/04/22/7",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/hakivvi/CVE-2022-29464",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.docs.wso2.com/en/latest/security-announcements/security-advisories/2022/WSO2-2021-1738/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}