{
  "id": "CVE-2022-38152",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-08-31T17:15:08.297",
  "lastModified": "2023-03-01T15:50:06.887",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in wolfSSL before 5.5.0. When a TLS 1.3 client connects to a wolfSSL server and SSL_clear is called on its session, the server crashes with a segmentation fault. This occurs in the second session, which is created through TLS session resumption and reuses the initial struct WOLFSSL. If the server reuses the previous session structure (struct WOLFSSL) by calling wolfSSL_clear(WOLFSSL* ssl) on it, the next received Client Hello (that resumes the previous session) crashes the server. Note that this bug is only triggered when resuming sessions using TLS session resumption. Only servers that use wolfSSL_clear instead of the recommended SSL_free; SSL_new sequence are affected. Furthermore, wolfSSL_clear is part of wolfSSL's compatibility layer and is not enabled by default. It is not part of wolfSSL's native API."
    },
    {
      "lang": "es",
      "value": "Se ha detectado un problema en wolfSSL versiones anteriores a 5.5.0. Cuando un cliente TLS versi\u00f3n 1.3 es conectado a un servidor wolfSSL y es llamado a SSL_clear en su sesi\u00f3n, el servidor es bloqueado con un fallo de segmentaci\u00f3n. Esto ocurre en la segunda sesi\u00f3n, que es creada mediante la reanudaci\u00f3n de la sesi\u00f3n TLS y re\u00fasa la estructura inicial WOLFSSL. Si el servidor re\u00fasa la estructura de sesi\u00f3n anterior (struct WOLFSSL) llamando a wolfSSL_clear(WOLFSSL* ssl) sobre ella, el siguiente Client Hello recibido (que reanuda la sesi\u00f3n anterior) bloquea el servidor. Tenga en cuenta que este fallo s\u00f3lo es producido cuando son reanudadas las sesiones usando la reanudaci\u00f3n de sesi\u00f3n TLS. S\u00f3lo est\u00e1n afectados los servidores que usan wolfSSL_clear en lugar de la secuencia recomendada SSL_free; SSL_new. Adem\u00e1s, wolfSSL_clear forma parte de la capa de compatibilidad de wolfSSL y no est\u00e1 habilitada por defecto. No forma parte de la API nativa de wolfSSL"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-754"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:wolfssl:wolfssl:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "5.5.0",
              "matchCriteriaId": "429B1D46-A7C6-4510-89E4-88222C933D0B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://packetstormsecurity.com/files/170604/wolfSSL-Session-Resumption-Denial-Of-Service.html",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://seclists.org/fulldisclosure/2023/Jan/7",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://blog.trailofbits.com/2023/01/12/wolfssl-vulnerabilities-tlspuffin-fuzzing-ssh/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/tlspuffin/tlspuffin",
      "source": "cve@mitre.org",
      "tags": [
        "Not Applicable"
      ]
    },
    {
      "url": "https://github.com/wolfSSL/wolfssl/pull/5468",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/wolfSSL/wolfssl/releases",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://www.wolfssl.com/docs/security-vulnerabilities/",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}