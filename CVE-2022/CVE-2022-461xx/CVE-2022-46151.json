{
  "id": "CVE-2022-46151",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-12-06T01:15:09.813",
  "lastModified": "2022-12-07T15:23:27.400",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Querybook is an open source data querying UI. In affected versions user provided data is not escaped in the error field of the auth callback url in `querybook/server/app/auth/oauth_auth.py` and `querybook/server/app/auth/okta_auth.py`. This may allow attackers to perform reflected cross site scripting (XSS) if Content Security Policy (CSP) is not enabled or `unsafe-inline` is allowed. Users are advised to upgrade to the latest, patched version of querybook (version 3.14.2 or greater). Users unable to upgrade may enable CSP and not allow unsafe-inline or manually escape query parameters in a reverse proxy."
    },
    {
      "lang": "es",
      "value": "Querybook es una interfaz de usuario de consulta de datos de c\u00f3digo abierto. En las versiones afectadas, los datos proporcionados por el usuario no se escapan en el campo de error de la URL de devoluci\u00f3n de llamada de autenticaci\u00f3n en `querybook/server/app/auth/oauth_auth.py` y `querybook/server/app/auth/okta_auth.py`. Esto puede permitir a los atacantes realizar Cross-Site Scripting (XSS) Reflejado si la Pol\u00edtica de seguridad de contenido (CSP) no est\u00e1 habilitada o si se permite \"inseguro en l\u00ednea\". Se recomienda a los usuarios que actualicen a la \u00faltima versi\u00f3n parcheada de querybook (versi\u00f3n 3.14.2 o superior). Los usuarios que no puedan actualizar pueden habilitar CSP y no permitir par\u00e1metros de consulta en l\u00ednea inseguros o de escape manual en un proxy inverso."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.4
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:pinterest:querybook:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.14.2",
              "matchCriteriaId": "01CEA186-46D3-4EC5-AA59-D643B007274C"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/pinterest/querybook/commit/88a7f10495bf5ed1a556ade51a2f2794e403c063",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/pinterest/querybook/security/advisories/GHSA-mrrw-9wf7-xq6w",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    }
  ]
}