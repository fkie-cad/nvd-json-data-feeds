{
  "id": "CVE-2022-33681",
  "sourceIdentifier": "security@apache.org",
  "published": "2022-09-23T10:15:10.243",
  "lastModified": "2022-09-27T15:41:39.307",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Delayed TLS hostname verification in the Pulsar Java Client and the Pulsar Proxy make each client vulnerable to a man in the middle attack. Connections from the Pulsar Java Client to the Pulsar Broker/Proxy and connections from the Pulsar Proxy to the Pulsar Broker are vulnerable. Authentication data is sent before verifying the server\u2019s TLS certificate matches the hostname, which means authentication data could be exposed to an attacker. An attacker can only take advantage of this vulnerability by taking control of a machine 'between' the client and the server. The attacker must then actively manipulate traffic to perform the attack by providing the client with a cryptographically valid certificate for an unrelated host. Because the client sends authentication data before performing hostname verification, an attacker could gain access to the client\u2019s authentication data. The client eventually closes the connection when it verifies the hostname and identifies the targeted hostname does not match a hostname on the certificate. Because the client eventually closes the connection, the value of the intercepted authentication data depends on the authentication method used by the client. Token based authentication and username/password authentication methods are vulnerable because the authentication data can be used to impersonate the client in a separate session. This issue affects Apache Pulsar Java Client versions 2.7.0 to 2.7.4; 2.8.0 to 2.8.3; 2.9.0 to 2.9.2; 2.10.0; 2.6.4 and earlier."
    },
    {
      "lang": "es",
      "value": "El retraso en la verificaci\u00f3n del nombre de host TLS en el cliente Java Pulsar y Pulsar Proxy hace que cada cliente sea vulnerable a un ataque de hombre en el medio. Las conexiones del Cliente Java Pulsar al Broker/Proxy Pulsar y las conexiones del Proxy Pulsar al Broker Pulsar son vulnerables. Los datos de autenticaci\u00f3n son enviados antes de verificar que el certificado TLS del servidor coincide con el nombre del host, lo que significa que los datos de autenticaci\u00f3n podr\u00edan estar expuestos a un atacante. Un atacante s\u00f3lo puede aprovecharse de esta vulnerabilidad  al tomar el control de una m\u00e1quina \"entre\" el cliente y el servidor. El atacante debe entonces manipular activamente el tr\u00e1fico para llevar a cabo el ataque al proporcionar al cliente un certificado criptogr\u00e1ficamente v\u00e1lido para un host no relacionado. Como el cliente env\u00eda datos de autenticaci\u00f3n antes de llevar a cabo la verificaci\u00f3n del nombre del host, un atacante podr\u00eda acceder a los datos de autenticaci\u00f3n del cliente. El cliente acaba cerrando la conexi\u00f3n cuando verifica el nombre de host e identifica que el nombre de host objetivo no coincide con un nombre de host en el certificado. Como el cliente acaba cerrando la conexi\u00f3n, el valor de los datos de autenticaci\u00f3n interceptados depende del m\u00e9todo de autenticaci\u00f3n usado por el cliente. Los m\u00e9todos de autenticaci\u00f3n basados en tokens y de nombre de usuario/contrase\u00f1a son vulnerables porque los datos de autenticaci\u00f3n pueden usarse para suplantar al cliente en una sesi\u00f3n independiente. Este problema afecta a Apache Pulsar Java Client versiones 2.7.0 a 2.7.4; 2.8.0 a 2.8.3; 2.9.0 a 2.9.2; 2.10.0; 2.6.4 y anteriores."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    },
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "2.7.5",
              "matchCriteriaId": "1329962E-1B1C-42B1-B3E3-B647B7D2749E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.8.0",
              "versionEndExcluding": "2.8.4",
              "matchCriteriaId": "02284ABD-BFD3-4E2A-850A-CC12A7996E97"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "2.9.0",
              "versionEndExcluding": "2.9.3",
              "matchCriteriaId": "C1A2D87A-55FC-42C0-BB48-E2B5B07EE1CE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:pulsar:2.10.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "C6E2F16D-CCDD-4DC8-9745-09EA2CD4D4DB"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.apache.org/thread/fpo6x10trvn20hlk0dmnr5vlz5v4kl3d",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    }
  ]
}