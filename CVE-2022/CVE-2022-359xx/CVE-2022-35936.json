{
  "id": "CVE-2022-35936",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-08-05T13:15:08.137",
  "lastModified": "2022-08-13T00:59:12.273",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Ethermint is an Ethereum library. In Ethermint running versions before `v0.17.2`, the contract `selfdestruct` invocation permanently removes the corresponding bytecode from the internal database storage. However, due to a bug in the `DeleteAccount`function, all contracts that used the identical bytecode (i.e shared the same `CodeHash`) will also stop working once one contract invokes `selfdestruct`, even though the other contracts did not invoke the `selfdestruct` OPCODE. This vulnerability has been patched in Ethermint version v0.18.0. The patch has state machine-breaking changes for applications using Ethermint, so a coordinated upgrade procedure is required. A workaround is available. If a contract is subject to DoS due to this issue, the user can redeploy the same contract, i.e. with identical bytecode, so that the original contract's code is recovered. The new contract deployment restores the `bytecode hash -> bytecode` entry in the internal state."
    },
    {
      "lang": "es",
      "value": "Ethermint es una biblioteca de Ethereum. En las versiones de Ethermint anteriores a \"v0.17.2\", la invocaci\u00f3n del contrato \"selfdestruct\" elimina permanentemente el bytecode correspondiente del almacenamiento interno de la base de datos. Sin embargo, debido a un error en la funci\u00f3n \"DeleteAccount\", todos los contratos que usaban el mismo bytecode (es decir, compart\u00edan el mismo \"CodeHash\") tambi\u00e9n dejar\u00e1n de funcionar una vez que un contrato invoque \"selfdestruct\", aunque los dem\u00e1s contratos no hayan invocado el OPCODE \"selfdestruct\". Esta vulnerabilidad ha sido parcheada en Ethermint versi\u00f3n v0.18.0. El parche presenta cambios que rompen el estado de las aplicaciones que usan Ethermint, por lo que es requerido un procedimiento de actualizaci\u00f3n coordinado. Se presenta una mitigaci\u00f3n alternativa. Si un contrato es objeto de DoS debido a este problema, el usuario puede volver a desplegar el mismo contrato, es decir, con id\u00e9ntico bytecode, de modo que sea recuperado el c\u00f3digo del contrato original. El nuevo despliegue del contrato restaura la entrada \"bytecode hash -) bytecode\" en el estado interno"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "LOW",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "HIGH",
          "baseScore": 8.2,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-668"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:evmos:ethermint:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.18.0",
              "matchCriteriaId": "5715442E-55C7-4BFA-A571-0B2EEE375D93"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:kava:kava:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.18.0",
              "matchCriteriaId": "A675E2F4-CA8D-4126-906B-B279839377C2"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:crypto:cronos:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "0.7.0",
              "matchCriteriaId": "7F1D7275-5477-4026-83F6-AFFA244561A8"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:evmos:evmos:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "7.0.0",
              "matchCriteriaId": "6F059647-951E-4EE7-A5F8-644353B214D4"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/evmos/ethermint/blob/c9d42d667b753147977a725e98ed116c933c76cb/x/evm/keeper/statedb.go#L199-L203",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/evmos/ethermint/commit/144741832007a26dbe950512acbda4ed95b2a451",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/evmos/ethermint/security/advisories/GHSA-f92v-grc2-w2fg",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}