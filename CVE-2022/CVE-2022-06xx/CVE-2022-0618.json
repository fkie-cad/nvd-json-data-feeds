{
  "id": "CVE-2022-0618",
  "sourceIdentifier": "cve@forums.swift.org",
  "published": "2022-03-10T17:44:56.647",
  "lastModified": "2022-03-16T18:36:34.563",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "A program using swift-nio-http2 is vulnerable to a denial of service attack, caused by a network peer sending a specially crafted HTTP/2 frame. This vulnerability is caused by a logical error when parsing a HTTP/2 HEADERS or HTTP/2 PUSH_PROMISE frame where the frame contains padding information without any other data. This logical error caused confusion about the size of the frame, leading to a parsing error. This parsing error immediately crashes the entire process. Sending a HEADERS frame or PUSH_PROMISE frame with HTTP/2 padding information does not require any special permission, so any HTTP/2 connection peer may send such a frame. For clients, this means any server to which they connect may launch this attack. For servers, anyone they allow to connect to them may launch such an attack. The attack is low-effort: it takes very little resources to send an appropriately crafted frame. The impact on availability is high: receiving the frame immediately crashes the server, dropping all in-flight connections and causing the service to need to restart. It is straightforward for an attacker to repeatedly send appropriately crafted frames, so attackers require very few resources to achieve a substantial denial of service. The attack does not have any confidentiality or integrity risks in and of itself: swift-nio-http2 is parsing the frame in memory-safe code, so the crash is safe. However, sudden process crashes can lead to violations of invariants in services, so it is possible that this attack can be used to trigger an error condition that has confidentiality or integrity risks. The risk can be mitigated if untrusted peers can be prevented from communicating with the service. This mitigation is not available to many services. The issue is fixed by rewriting the parsing code to correctly handle the condition. The issue was found by automated fuzzing by oss-fuzz."
    },
    {
      "lang": "es",
      "value": "Un programa usando swift-nio-http2 es vulnerable a un ataque de denegaci\u00f3n de servicio, causado por el env\u00edo de una trama HTTP/2 especialmente dise\u00f1ada por parte de un compa\u00f1ero de red. Esta vulnerabilidad est\u00e1 causada por un error de l\u00f3gica cuando es analizada una trama HTTP/2 HEADERS o HTTP/2 PUSH_PROMISE en la que la trama contiene informaci\u00f3n de relleno sin ning\u00fan otro dato. Este error l\u00f3gico caus\u00f3 una confusi\u00f3n sobre el tama\u00f1o de la trama, conllevando un error de an\u00e1lisis. Este error de an\u00e1lisis bloquea inmediatamente todo el proceso. El env\u00edo de una trama HEADERS o PUSH_PROMISE con informaci\u00f3n de relleno HTTP/2 no requiere ning\u00fan permiso especial, por lo que cualquier par de conexi\u00f3n HTTP/2 puede enviar una trama de este tipo. Para los clientes, esto significa que cualquier servidor al que sean conectados puede lanzar este ataque. Para los servidores, cualquier persona a la que permitan conectarse puede lanzar este ataque. El ataque es de bajo esfuerzo: son necesarios muy pocos recursos para enviar una trama apropiadamente dise\u00f1ada. El impacto en la disponibilidad es alto: la recepci\u00f3n de la trama bloquea inmediatamente el servidor, arrojando todas las conexiones en curso y causando la necesidad de reiniciar el servicio. Es sencillo para un atacante enviar repetidamente tramas apropiadamente dise\u00f1adas, por lo que los atacantes necesitan muy pocos recursos para lograr una denegaci\u00f3n de servicio sustancial. El ataque no presenta ning\u00fan riesgo de confidencialidad o integridad en s\u00ed mismo: swift-nio-http2 est\u00e1 analizando la trama en c\u00f3digo seguro para la memoria, por lo que el bloqueo es seguro. Sin embargo, los bloqueos repentinas de procesos pueden conllevar a violaciones de invariantes en los servicios, por lo que es posible que este ataque pueda ser usado para desencadenar una condici\u00f3n de error que tenga riesgos de confidencialidad o integridad. El riesgo puede mitigarse si es posible evitar que los compa\u00f1eros que no son confiables puedan comunicarse con el servicio. Esta mitigaci\u00f3n no est\u00e1 disponible para muchos servicios. El problema es corregido al reescribir el c\u00f3digo de an\u00e1lisis para manejar correctamente la condici\u00f3n. El problema es encontrado mediante fuzzing automatizado por oss-fuzz"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 7.8
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 6.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-Other"
        }
      ]
    },
    {
      "source": "cve@forums.swift.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-130"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apple:swiftnio_http\\/2:*:*:*:*:*:swift:*:*",
              "versionStartIncluding": "1.0.0",
              "versionEndExcluding": "1.20.0",
              "matchCriteriaId": "1D718284-A7FD-4FF1-B6D4-BAC1CC7FED66"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/apple/swift-nio-http2/security/advisories/GHSA-q36x-r5x4-h4q6",
      "source": "cve@forums.swift.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}