{
  "id": "CVE-2022-24853",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-04-14T22:15:08.057",
  "lastModified": "2022-04-22T17:41:55.287",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Metabase is an open source business intelligence and analytics application. Metabase has a proxy to load arbitrary URLs for JSON maps as part of our GeoJSON support. While we do validation to not return contents of arbitrary URLs, there is a case where a particularly crafted request could result in file access on windows, which allows enabling an `NTLM relay attack`, potentially allowing an attacker to receive the system password hash. If you use Windows and are on this version of Metabase, please upgrade immediately. The following patches (or greater versions) are available: 0.42.4 and 1.42.4, 0.41.7 and 1.41.7, 0.40.8 and 1.40.8."
    },
    {
      "lang": "es",
      "value": "Metabase es una aplicaci\u00f3n de an\u00e1lisis e inteligencia empresarial de c\u00f3digo abierto. Metabase presenta un proxy para cargar URLs arbitrarias para mapas JSON como parte de nuestro soporte GeoJSON. Mientras comprobamos que no sea devuelto el contenido de URLs arbitrarias, se presenta un caso en el que una petici\u00f3n especialmente dise\u00f1ada podr\u00eda resultar en un acceso a un archivo en Windows, lo que permite habilitar un \"Ataque de retransmisi\u00f3n NTLM\", permitiendo potencialmente a un atacante recibir el hash de la contrase\u00f1a del sistema. Si usted usa Windows y est\u00e1 en esta versi\u00f3n de Metabase, por favor actualice inmediatamente. Los siguientes parches (o versiones superiores) est\u00e1n disponibles: versiones 0.42.4 y 1.42.4, 0.41.7 y 1.41.7, 0.40.8 y 1.40.8"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:H/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "HIGH",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 2.6
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 4.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.40.0",
              "versionEndExcluding": "0.40.8",
              "matchCriteriaId": "D78C572A-4BF8-4CA6-9154-4B89DA29AC0F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.41.0",
              "versionEndExcluding": "0.41.7",
              "matchCriteriaId": "548FFDC4-010F-4B2C-995F-41F540995B0E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.42.0",
              "versionEndExcluding": "0.42.4",
              "matchCriteriaId": "F9282AB8-E8AF-4431-9BED-D1427CDF81BE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.40.0",
              "versionEndExcluding": "1.40.8",
              "matchCriteriaId": "87B12439-8DDB-47C4-B599-CBCE18625655"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.41.0",
              "versionEndExcluding": "1.41.7",
              "matchCriteriaId": "4E19CC33-86D1-42B3-8EBC-3642FF59A5AC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:metabase:metabase:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.42.0",
              "versionEndExcluding": "1.42.4",
              "matchCriteriaId": "0661FFDD-F667-4818-8EB3-B42E9E7001F2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/metabase/metabase/security/advisories/GHSA-5cfq-582c-c38m",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://secure77.de/metabase-ntlm-relay-attack/",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.qomplx.com/qomplx-knowledge-ntlm-relay-attacks-explained/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}