{
  "id": "CVE-2022-31175",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-08-03T19:15:08.017",
  "lastModified": "2022-08-09T17:28:44.367",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "CKEditor 5 is a JavaScript rich text editor. A cross-site scripting vulnerability has been discovered affecting three optional CKEditor 5's packages in versions prior to 35.0.1. The vulnerability allowed to trigger a JavaScript code after fulfilling special conditions. The affected packages are `@ckeditor/ckeditor5-markdown-gfm`, `@ckeditor/ckeditor5-html-support`, and `@ckeditor/ckeditor5-html-embed`. The specific conditions are 1) Using one of the affected packages. In case of `ckeditor5-html-support` and `ckeditor5-html-embed`, additionally, it was required to use a configuration that allows unsafe markup inside the editor. 2) Destroying the editor instance and 3) Initializing the editor on an element and using an element other than `<textarea>` as a base. The root cause of the issue was a mechanism responsible for updating the source element with the markup coming from the CKEditor 5 data pipeline after destroying the editor. This vulnerability might affect a small percent of integrators that depend on dynamic editor initialization/destroy and use Markdown, General HTML Support or HTML embed features. The problem has been recognized and patched. The fix is available in version 35.0.1. There are no known workarounds for this issue."
    },
    {
      "lang": "es",
      "value": "CKEditor 5 es un editor de texto enriquecido en JavaScript. Se ha detectado una vulnerabilidad de tipo cross-site scripting que afecta a tres paquetes opcionales de CKEditor 5 en versiones anteriores a 35.0.1. La vulnerabilidad permit\u00eda desencadenar un c\u00f3digo JavaScript tras cumplir unas condiciones especiales. Los paquetes afectados son \"@ckeditor/ckeditor5-markdown-gfm\", \"@ckeditor/ckeditor5-html-support\", and \"@ckeditor/ckeditor5-html-embed\". Las condiciones espec\u00edficas son 1) Usar uno de los paquetes afectados. En el caso de \"ckeditor5-html-support\" and \"ckeditor5-html-embed\", Adicionalmente, se requer\u00eda usar una configuraci\u00f3n que permitiera un marcado no seguro dentro del editor. 2) Destruir la instancia del editor y 3) Inicializar el editor en un elemento y usar un elemento que no sea \"(textarea)\" como base. La causa del problema era un mecanismo responsable de la actualizaci\u00f3n del elemento fuente con el marcado procedente de la canalizaci\u00f3n de datos de CKEditor 5 despu\u00e9s de destruir el editor. Esta vulnerabilidad podr\u00eda afectar a un peque\u00f1o porcentaje de integradores que dependen de la inicializaci\u00f3n/destrucci\u00f3n din\u00e1mica del editor y que usan las funciones Markdown, General HTML Support o HTML embed. El problema ha sido reconocido y parcheado. La correcci\u00f3n est\u00e1 disponible en versi\u00f3n 35.0.1. No se presentan mitigaciones conocidas para este problema"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 5.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 3.7
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ckeditor:ckeditor5-html-embed:*:*:*:*:*:node.js:*:*",
              "versionEndExcluding": "35.0.1",
              "matchCriteriaId": "EE0D8A68-02CA-4BF9-AEFA-82B7531691CB"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ckeditor:ckeditor5-html-support:*:*:*:*:*:node.js:*:*",
              "versionEndExcluding": "35.0.1",
              "matchCriteriaId": "99D2554D-48FD-4E25-953A-9727C7C82DE5"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:ckeditor:ckeditor5-markdown-gfm:*:*:*:*:*:node.js:*:*",
              "versionEndExcluding": "35.0.1",
              "matchCriteriaId": "F2437399-6A77-4BB7-8028-59E948BFED95"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://ckeditor.com/docs/ckeditor5/latest/features/general-html-support.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor5/latest/features/html-embed.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://ckeditor.com/docs/ckeditor5/latest/features/markdown.html",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/ckeditor/ckeditor5/security/advisories/GHSA-42wq-rch8-6f6j",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}