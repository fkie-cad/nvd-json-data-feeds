{
  "id": "CVE-2022-31180",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-08-01T20:15:08.237",
  "lastModified": "2023-07-24T13:07:55.837",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Shescape is a simple shell escape package for JavaScript. Affected versions were found to have insufficient escaping of white space when interpolating output. This issue only impacts users that use the `escape` or `escapeAll` functions with the `interpolation` option set to `true`. The result is that if an attacker is able to include whitespace in their input they can: 1. Invoke shell-specific behaviour through shell-specific special characters inserted directly after whitespace. 2. Invoke shell-specific behaviour through shell-specific special characters inserted or appearing after line terminating characters. 3. Invoke arbitrary commands by inserting a line feed character. 4. Invoke arbitrary commands by inserting a carriage return character. Behaviour number 1 has been patched in [v1.5.7] which you can upgrade to now. No further changes are required. Behaviour number 2, 3, and 4 have been patched in [v1.5.8] which you can upgrade to now. No further changes are required. The best workaround is to avoid having to use the `interpolation: true` option - in most cases using an alternative is possible, see [the recipes](https://github.com/ericcornelissen/shescape#recipes) for recommendations. Alternatively, users may strip all whitespace from user input. Note that this is error prone, for example: for PowerShell this requires stripping `'\\u0085'` which is not included in JavaScript's definition of `\\s` for Regular Expressions."
    },
    {
      "lang": "es",
      "value": "Shescape es un paquete de escape de shell simple para JavaScript. Se ha detectado que las versiones afectadas no escapan suficientemente de los espacios en blanco cuando interpolan la salida. Este problema s\u00f3lo afecta a usuarios que usan las funciones \"escape\" o \"escapeAll\" con la opci\u00f3n \"interpolation\" establecida como \"true\". El resultado es que si un atacante es capaz de incluir espacios en blanco en su entrada puede 1. Invocar un comportamiento espec\u00edfico del shell a trav\u00e9s de caracteres especiales espec\u00edficos del shell insertados directamente despu\u00e9s de los espacios en blanco. 2. 2. Invocar el comportamiento espec\u00edfico del shell mediante caracteres especiales espec\u00edficos del shell insertados o que aparecen despu\u00e9s de los caracteres de terminaci\u00f3n de l\u00ednea. 3. Invocar comandos arbitrarios mediante la inserci\u00f3n de un car\u00e1cter de avance de l\u00ednea. 4. Invocar comandos arbitrarios mediante la inserci\u00f3n de un car\u00e1cter de retorno de carro. El comportamiento n\u00famero 1 ha sido parcheado en la [versi\u00f3n v1.5.7] a la que puedes actualizar ahora. No son requeridos m\u00e1s cambios. Los comportamientos n\u00famero 2, 3 y 4 han sido parcheados en la [versi\u00f3n v1.5.8] a la que puede actualizarse ahora. No son requeridos m\u00e1s cambios. La mejor mitigaci\u00f3n es evitar tener que usar la opci\u00f3n \"interpolaci\u00f3n: true\" - en la mayor\u00eda de los casos es posible usar una alternativa, vea [las recetas](https://github.com/ericcornelissen/shescape#recipes) para recomendaciones. Alternativamente, los usuarios pueden eliminar todos los espacios en blanco de la entrada del usuario. Tenga en cuenta que esto es propenso a errores, por ejemplo: para PowerShell esto requiere quitar \"'\\u0085'\" que no est\u00e1 incluido en la definici\u00f3n de JavaScript de \"\\s\" para Expresiones Regulares"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-Other"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-74"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:shescape_project:shescape:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.4.0",
              "versionEndExcluding": "1.5.8",
              "matchCriteriaId": "F0E6F72E-DC24-4C62-95BB-4323DCF5D983"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/ericcornelissen/shescape/pull/322",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ericcornelissen/shescape/pull/324",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ericcornelissen/shescape/releases/tag/v1.5.7",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ericcornelissen/shescape/releases/tag/v1.5.8",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/ericcornelissen/shescape/security/advisories/GHSA-44vr-rwwj-p88h",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}