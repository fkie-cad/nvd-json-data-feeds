{
  "id": "CVE-2022-20792",
  "sourceIdentifier": "ykramarz@cisco.com",
  "published": "2022-08-10T09:15:08.197",
  "lastModified": "2023-10-01T11:15:10.490",
  "vulnStatus": "Modified",
  "descriptions": [
    {
      "lang": "en",
      "value": "A vulnerability in the regex module used by the signature database load module of Clam AntiVirus (ClamAV) versions 0.104.0 through 0.104.2 and LTS version 0.103.5 and prior versions could allow an authenticated, local attacker to crash ClamAV at database load time, and possibly gain code execution. The vulnerability is due to improper bounds checking that may result in a multi-byte heap buffer overwflow write. An attacker could exploit this vulnerability by placing a crafted CDB ClamAV signature database file in the ClamAV database directory. An exploit could allow the attacker to run code as the clamav user."
    },
    {
      "lang": "es",
      "value": "Una vulnerabilidad en el m\u00f3dulo regex usado por el m\u00f3dulo de carga de la base de datos de firmas de Clam AntiVirus (ClamAV) versiones 0.104.0 hasta 0.104.2 y LTS versiones 0.103.5 y anteriores, podr\u00eda permitir a un atacante local autenticado bloquear ClamAV en el momento de la carga de la base de datos, y posiblemente obtener una ejecuci\u00f3n de c\u00f3digo. La vulnerabilidad es debido a una comprobaci\u00f3n inapropiada de l\u00edmites que puede resultar en una escritura de desbordamiento del b\u00fafer de la pila de varios bytes. Un atacante podr\u00eda explotar esta vulnerabilidad al colocar un archivo de base de datos de firmas CDB ClamAV dise\u00f1ado en el directorio de la base de datos de ClamAV. Una explotaci\u00f3n podr\u00eda permitir al atacante ejecutar c\u00f3digo como el usuario clamav"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      },
      {
        "source": "ykramarz@cisco.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-787"
        }
      ]
    },
    {
      "source": "ykramarz@cisco.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-125"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "0.103.5",
              "matchCriteriaId": "30AC5889-743E-433E-97A7-2657A1F5C273"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:clamav:clamav:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.104.0",
              "versionEndIncluding": "0.104.2",
              "matchCriteriaId": "FEA3B921-70F0-455E-84F0-EA08498AEB4D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://blog.clamav.net/2022/05/clamav-01050-01043-01036-released.html",
      "source": "ykramarz@cisco.com",
      "tags": [
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202310-01",
      "source": "ykramarz@cisco.com"
    }
  ]
}