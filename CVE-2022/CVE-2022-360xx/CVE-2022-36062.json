{
  "id": "CVE-2022-36062",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-09-22T18:15:10.307",
  "lastModified": "2023-02-16T03:19:29.530",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Grafana is an open-source platform for monitoring and observability. In versions prior to 8.5.13, 9.0.9, and 9.1.6, Grafana is subject to Improper Preservation of Permissions resulting in privilege escalation on some folders where Admin is the only used permission. The vulnerability impacts Grafana instances where RBAC was disabled and enabled afterwards, as the migrations which are translating legacy folder permissions to RBAC permissions do not account for the scenario where the only user permission in the folder is Admin, as a result RBAC adds permissions for Editors and Viewers which allow them to edit and view folders accordingly. This issue has been patched in versions 8.5.13, 9.0.9, and 9.1.6. A workaround when the impacted folder/dashboard is known is to remove the additional permissions manually."
    },
    {
      "lang": "es",
      "value": "Grafana es una plataforma de c\u00f3digo abierto para la monitorizaci\u00f3n y la observaci\u00f3n. En versiones anteriores a 8.5.13, 9.0.9 y 9.1.6, Grafana est\u00e1 sujeta a una Preservaci\u00f3n inapropiada de Permisos, lo que resulta en una escalada de privilegios en algunas carpetas donde Admin es el \u00fanico permiso usado. La vulnerabilidad afecta a las instancias de Grafana en las que se deshabilit\u00f3 RBAC y se habilit\u00f3 despu\u00e9s, ya que las migraciones que traducen los permisos de carpetas heredadas a permisos RBAC no tienen en cuenta el escenario en el que el \u00fanico permiso de usuario en la carpeta es Admin, como resultado RBAC a\u00f1ade permisos para Editores y Visualizadores que les permiten editar y ver carpetas en consecuencia. Este problema ha sido parcheado en las versiones 8.5.13, 9.0.9 y 9.1.6. Una soluci\u00f3n cuando se conoce la carpeta/el tablero afectado es eliminar los permisos adicionales manualmente"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 3.8,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 1.2,
        "impactScore": 2.5
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 7.6,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 4.7
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-281"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "8.5.13",
              "matchCriteriaId": "60D90629-8174-4FC3-8D43-17655EF93F5E"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "9.0.0",
              "versionEndExcluding": "9.0.9",
              "matchCriteriaId": "FD0963EA-4EDA-417B-9CF2-609E4157AD8C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "9.1.0",
              "versionEndExcluding": "9.1.6",
              "matchCriteriaId": "E40D636D-3D90-46E1-84F2-13F186F55DB7"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/grafana/grafana/security/advisories/GHSA-p978-56hq-r492",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Release Notes",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20221215-0001/",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}