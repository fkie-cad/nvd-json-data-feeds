{
  "id": "CVE-2022-36099",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-09-08T21:15:08.167",
  "lastModified": "2023-06-27T20:52:09.843",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "XWiki Platform Wiki UI Main Wiki is software for managing subwikis on XWiki Platform, a generic wiki platform. Starting with version 5.3-milestone-2 and prior to versions 13.10.6 and 14.4, it's possible to inject arbitrary wiki syntax including Groovy, Python and Velocity script macros via the request (URL parameter) using the `XWikiServerClassSheet` if the user has view access to this sheet and another page that has been saved with programming rights, a standard condition on a public read-only XWiki installation or a private XWiki installation where the user has an account. This allows arbitrary Groovy/Python/Velocity code execution which allows bypassing all rights checks and thus both modification and disclosure of all content stored in the XWiki installation. Also, this could be used to impact the availability of the wiki. This has been patched in versions 13.10.6 and 14.4. As a workaround, edit the affected document `XWiki.XWikiServerClassSheet` or `WikiManager.XWikiServerClassSheet` and manually perform the changes from the patch fixing the issue. On XWiki versions 12.0 and later, it is also possible to import the document `XWiki.XWikiServerClassSheet` from the xwiki-platform-wiki-ui-mainwiki package version 14.4 using the import feature of the administration application as there have been no other changes to this document since XWiki 12.0."
    },
    {
      "lang": "es",
      "value": "XWiki Platform Wiki UI Main Wiki es un software para administrar subwikis en XWiki Platform, una plataforma wiki gen\u00e9rica.&#xa0;A partir de la versi\u00f3n 5.3-milestone-2 y anteriores a 13.10.6 y 14.4, es posible inyectar sintaxis wiki arbitraria, incluidas macros de secuencias de comandos de Groovy, Python y Velocity por medio de la petici\u00f3n (par\u00e1metro de URL) utilizando \"XWikiServerClassSheet\" si el usuario presenta acceso de visualizaci\u00f3n a esta hoja y otra p\u00e1gina que ha sido guardada con derechos de programaci\u00f3n, una condici\u00f3n est\u00e1ndar en una instalaci\u00f3n de XWiki p\u00fablica de solo lectura o una instalaci\u00f3n de XWiki privada donde el usuario presenta una cuenta.&#xa0;Esto permite una ejecuci\u00f3n arbitraria de c\u00f3digo Groovy/Python/Velocity, lo que permite omitir todas las verificaciones de derechos y, por lo tanto, modificar y divulgar todo el contenido almacenado en la instalaci\u00f3n de XWiki.&#xa0;Adem\u00e1s, esto podr\u00eda usarse para afectar la disponibilidad de la wiki.&#xa0;Esto ha sido parcheado en las versiones 13.10.6 y 14.4.&#xa0;Como mitigaci\u00f3n, edite el documento afectado \"XWiki.XWikiServerClassSheet\" o \"WikiManager.XWikiServerClassSheet\" y realice manualmente los cambios del parche que corrigen el problema.&#xa0;En XWiki versiones 12.0 y posteriores, tambi\u00e9n es posible importar el documento \"XWiki.XWikiServerClassSheet\" desde el paquete xwiki-platform-wiki-ui-mainwiki versi\u00f3n 14.4 usando la funci\u00f3n de importaci\u00f3n de la aplicaci\u00f3n de administraci\u00f3n ya que no ha habido otros cambios en este documento desde XWiki versi\u00f3n 12.0"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.9,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 6.0
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-116"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-94"
        },
        {
          "lang": "en",
          "value": "CWE-95"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.4",
              "versionEndExcluding": "13.10.6",
              "matchCriteriaId": "35F7BA8F-C552-4CAA-8AF5-7C7DBD703797"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "14.0",
              "versionEndExcluding": "14.4",
              "matchCriteriaId": "78E9227E-5BAE-44FD-B327-13434E0AF974"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:xwiki:xwiki:5.3:milestone2:*:*:*:*:*:*",
              "matchCriteriaId": "067AAD11-1AB2-4688-8D81-F2464CD2FA14"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/xwiki/xwiki-platform/commit/fc77f9f53bc65a4a9bfae3d5686615309c0c76cc",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/xwiki/xwiki-platform/security/advisories/GHSA-xr6m-2p4m-jvqf",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://jira.xwiki.org/browse/XWIKI-19746",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}