{
  "id": "CVE-2022-36025",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-09-24T02:15:09.587",
  "lastModified": "2022-09-28T14:41:56.287",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Besu is a Java-based Ethereum client. In versions newer than 22.1.3 and prior to 22.7.1, Besu is subject to an Incorrect Conversion between Numeric Types. An error in 32 bit signed and unsigned types in the calculation of available gas in the CALL operations (including DELEGATECALL) results in incorrect gas being passed into called contracts and incorrect gas being returned after call execution. Where the amount of gas makes a difference in the success or failure, or if the gas is a negative 64 bit value, the execution will result in a different state root than expected, resulting in a consensus failure in networks with multiple EVM implementations. In networks with a single EVM implementation this can be used to execute with significantly more gas than then transaction requested, possibly exceeding gas limitations. This issue is patched in version 22.7.1. As a workaround, reverting to version 22.1.3 or earlier will prevent incorrect execution."
    },
    {
      "lang": "es",
      "value": "Besu es un cliente Ethereum basado en Java. En las versiones m\u00e1s recientes que 22.1.3 y anteriores a 22.7.1, Besu est\u00e1 sujeto a una Conversi\u00f3n Incorrecta entre Tipos Num\u00e9ricos. Un error en los tipos con signo y sin signo de 32 bits en el c\u00e1lculo del gas disponible en las operaciones CALL (incluyendo DELEGATECALL) provoca que sea pasado gas incorrecto a los contratos llamados y que sea devuelto gas incorrecto tras la ejecuci\u00f3n de la llamada. Cuando la cantidad de gas marca una diferencia en el \u00e9xito o el fracaso, o si el gas es un valor negativo de 64 bits, la ejecuci\u00f3n resultar\u00e1 a un root state diferente a lo esperado, resultando en un fallo de consenso en redes con m\u00faltiples implementaciones de EVM. En redes con una sola implementaci\u00f3n de EVM, esto puede ser usado para ejecutar con un gas significativamente mayor que la transacci\u00f3n solicitada, posiblemente excediendo las limitaciones de gas. Este problema est\u00e1 parcheado en versi\u00f3n 22.7.1. Como mitigaci\u00f3n, volver a versi\u00f3n 22.1.3 o anterior evitar\u00e1 una ejecuci\u00f3n incorrecta.\n"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-681"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-196"
        },
        {
          "lang": "en",
          "value": "CWE-681"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:besu:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "22.4.1",
              "versionEndExcluding": "22.7.1",
              "matchCriteriaId": "CF3DBB75-E403-452E-814C-B97287A514AE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:besu:22.4.0:-:*:*:*:*:*:*",
              "matchCriteriaId": "0E64BDC7-01F3-4D3D-9946-F00E39AEF72A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:besu:22.4.0:rc2:*:*:*:*:*:*",
              "matchCriteriaId": "43631E60-9030-4927-95DC-9B0BBC022BD1"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/hyperledger/besu/security/advisories/GHSA-4456-w38r-m53x",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}