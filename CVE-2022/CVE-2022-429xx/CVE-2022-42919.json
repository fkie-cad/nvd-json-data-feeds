{
  "id": "CVE-2022-42919",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-11-07T00:15:09.697",
  "lastModified": "2023-11-07T03:53:41.527",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Python 3.9.x before 3.9.16 and 3.10.x before 3.10.9 on Linux allows local privilege escalation in a non-default configuration. The Python multiprocessing library, when used with the forkserver start method on Linux, allows pickles to be deserialized from any user in the same machine local network namespace, which in many system configurations means any user on the same machine. Pickles can execute arbitrary code. Thus, this allows for local user privilege escalation to the user that any forkserver process is running as. Setting multiprocessing.util.abstract_sockets_supported to False is a workaround. The forkserver start method for multiprocessing is not the default start method. This issue is Linux specific because only Linux supports abstract namespace sockets. CPython before 3.9 does not make use of Linux abstract namespace sockets by default. Support for users manually specifying an abstract namespace socket was added as a bugfix in 3.7.8 and 3.8.3, but users would need to make specific uncommon API calls in order to do that in CPython before 3.9."
    },
    {
      "lang": "es",
      "value": "Python 3.9.x anterior a la versi\u00f3n 3.9.16 y 3.10.x anterior a la versi\u00f3n 3.10.9 en Linux permite la escalada de privilegios locales en una configuraci\u00f3n no predeterminada. La librer\u00eda de multiprocesamiento Python, cuando se usa con el m\u00e9todo de inicio forkserver en Linux, permite deserializar pickles de cualquier usuario en el mismo espacio de nombres de red local de la m\u00e1quina, lo que en muchas configuraciones del sistema significa cualquier usuario en la misma m\u00e1quina. Pickles puede ejecutar c\u00f3digo arbitrario. Por lo tanto, esto permite escalar los privilegios del usuario local al usuario con el que se ejecuta cualquier proceso de forkserver. Como workaround se puede configurar multiprocessing.util.abstract_sockets_supported a False. El m\u00e9todo de inicio de forkserver para multiprocesamiento no es el m\u00e9todo de inicio predeterminado. Este problema es espec\u00edfico de Linux porque solo Linux admite sockets de espacios de nombres abstractos. CPython anterior a 3.9 no utiliza sockets de espacio de nombres abstractos de Linux de forma predeterminada. Se a\u00f1adi\u00f3 soporte para usuarios que especifican manualmente un socket de espacio de nombres abstracto como correcci\u00f3n de errores en 3.7.8 y 3.8.3, pero los usuarios tendr\u00edan que realizar llamadas API poco comunes espec\u00edficas para poder hacerlo en CPython antes de 3.9."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:python:python:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.7.3",
              "versionEndIncluding": "3.7.15",
              "matchCriteriaId": "D90DBA72-F261-408A-B8DD-5D2DD7E5985F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:python:python:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.8.3",
              "versionEndIncluding": "3.8.15",
              "matchCriteriaId": "78F6D00F-54D9-4B4F-91CB-20F262F83570"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:python:python:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.9.0",
              "versionEndExcluding": "3.9.16",
              "matchCriteriaId": "E28B140D-129A-4B9F-AC2B-F121E7EAD70C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:python:python:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.10.0",
              "versionEndExcluding": "3.10.9",
              "matchCriteriaId": "95E57263-9F7E-489E-9578-D89B584095B2"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
              "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:36:*:*:*:*:*:*:*",
              "matchCriteriaId": "5C675112-476C-4D7C-BCB9-A2FB2D0BC9FD"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:37:*:*:*:*:*:*:*",
              "matchCriteriaId": "E30D0E6F-4AE8-4284-8716-991DFA48CC5D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/python/cpython/compare/v3.10.8...v3.10.9",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/python/cpython/compare/v3.9.15...v3.9.16",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes"
      ]
    },
    {
      "url": "https://github.com/python/cpython/issues/97514",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/python/cpython/issues/97514#issuecomment-1310277840",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/FKGCQPIVHEAIJ77R3RSNSQWYBUDVWDKU/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/P2LHWWEI5OBQ6RELULMVU6KMDYG4WZXH/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/PI5DYIED6U26BGX5IRZWNCP6TY4M2ZGZ/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/QLUGZSEAO3MBWGKCUSMKQIRYJZKJCIOB/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/R6KGIRHSENZ4QAB234Z36HVIDTRJ3MFI/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/RDK3ZZBRYFO47ET3N4BNTKVXN47U6ICY/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/VCRKBB5Y5EWTJUNC7LK665WO64DDXSTN/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/XX6LLAXGZVZ327REY6MDZRMMP47LJ53P/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://security.gentoo.org/glsa/202305-02",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20221209-0006/",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}