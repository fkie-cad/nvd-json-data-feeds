{
  "id": "CVE-2022-23093",
  "sourceIdentifier": "secteam@freebsd.org",
  "published": "2024-02-15T06:15:45.240",
  "lastModified": "2024-02-15T06:23:39.303",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "ping reads raw IP packets from the network to process responses in the pr_pack() function.  As part of processing a response ping has to\u00a0reconstruct the IP header, the ICMP header and if present a \"quoted\u00a0packet,\" which represents the packet that generated an ICMP error.  The\u00a0quoted packet again has an IP header and an ICMP header.\n\nThe pr_pack() copies received IP and ICMP headers into stack buffers\u00a0for further processing.  In so doing, it fails to take into account the possible presence of IP option headers following the IP header in either the response or the quoted packet.  When IP options are present, pr_pack() overflows the destination buffer by up to 40 bytes.\n\nThe memory safety bugs described above can be triggered by a remote\u00a0host, causing the ping program to crash.\n\nThe ping process runs in a capability mode sandbox on all affected\u00a0versions of FreeBSD and is thus very constrained in how it can interact\u00a0with the rest of the system at the point where the bug can occur."
    },
    {
      "lang": "es",
      "value": "ping lee paquetes IP sin procesar de la red para procesar las respuestas en la funci\u00f3n pr_pack(). Como parte del procesamiento de una respuesta de ping, se debe reconstruir el encabezado IP, el encabezado ICMP y, si est\u00e1 presente, un \"paquete citado\", que representa el paquete que gener\u00f3 un error ICMP. El paquete citado nuevamente tiene un encabezado IP y un encabezado ICMP. pr_pack() copia los encabezados IP e ICMP recibidos en b\u00faferes de pila para su posterior procesamiento. Al hacerlo, no tiene en cuenta la posible presencia de encabezados de opciones de IP despu\u00e9s del encabezado de IP, ya sea en la respuesta o en el paquete citado. Cuando las opciones de IP est\u00e1n presentes, pr_pack() desborda el b\u00fafer de destino hasta en 40 bytes. Los errores de seguridad de la memoria descritos anteriormente pueden ser desencadenados por un host remoto, lo que provoca que el programa ping falle. El proceso de ping se ejecuta en un modo sandbox de capacidad en todas las versiones afectadas de FreeBSD y, por lo tanto, est\u00e1 muy limitado en cuanto a c\u00f3mo puede interactuar con el resto del sistema en el punto donde puede ocurrir el error."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://security.freebsd.org/advisories/FreeBSD-SA-22:15.ping.asc",
      "source": "secteam@freebsd.org"
    }
  ]
}