{
  "id": "CVE-2022-33915",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2022-06-17T13:15:17.083",
  "lastModified": "2022-07-05T19:43:40.247",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Versions of the Amazon AWS Apache Log4j hotpatch package before log4j-cve-2021-44228-hotpatch-1.3.5 are affected by a race condition that could lead to a local privilege escalation. This Hotpatch package is not a replacement for updating to a log4j version that mitigates CVE-2021-44228 or CVE-2021-45046; it provides a temporary mitigation to CVE-2021-44228 by hotpatching the local Java virtual machines. To do so, it iterates through all running Java processes, performs several checks, and executes the Java virtual machine with the same permissions and capabilities as the running process to load the hotpatch. A local user could cause the hotpatch script to execute a binary with elevated privileges by running a custom java process that performs exec() of an SUID binary after the hotpatch has observed the process path and before it has observed its effective user ID."
    },
    {
      "lang": "es",
      "value": "Las versiones del paquete hotpatch de Amazon AWS Apache Log4j anteriores a log4j-cve-2021-44228-hotpatch-1.3.5, est\u00e1n afectadas por una condici\u00f3n de carrera que podr\u00eda conllevar a una escalada de privilegios local. Este paquete Hotpatch no sustituye a la actualizaci\u00f3n a una versi\u00f3n de log4j que mitigue la CVE-2021-44228 o la CVE-2021-45046; proporciona una mitigaci\u00f3n temporal de la CVE-2021-44228 mediante la aplicaci\u00f3n de parches en caliente a las m\u00e1quinas virtuales Java locales. Para ello, recorre todos los procesos Java en ejecuci\u00f3n, lleva a cabo varias comprobaciones y ejecuta la m\u00e1quina virtual Java con los mismos permisos y capacidades que el proceso en ejecuci\u00f3n para cargar el hotpatch. Un usuario local podr\u00eda causar que el script del hotpatch ejecute un binario con altos privilegios al ejecutar un proceso java personalizado que lleve a cabo exec() de un binario SUID despu\u00e9s de que el hotpatch haya observado la ruta del proceso y antes de que haya observado su ID de usuario efectivo"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.0,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 5.9
      },
      {
        "source": "cve@mitre.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.0,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.0,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
          "accessVector": "LOCAL",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 4.4
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 3.4,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-362"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:amazon:hotpatch:*:*:*:*:*:log4j:*:*",
              "versionEndExcluding": "1.3.5",
              "matchCriteriaId": "C243BF13-0F47-4086-9FF8-A7B1A3573086"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://alas.aws.amazon.com/AL2/ALAS-2022-1806.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://alas.aws.amazon.com/ALAS-2022-1601.html",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}