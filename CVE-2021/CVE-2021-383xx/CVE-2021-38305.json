{
  "id": "CVE-2021-38305",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2021-08-09T21:15:08.567",
  "lastModified": "2021-08-17T18:46:13.463",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "23andMe Yamale before 3.0.8 allows remote attackers to execute arbitrary code via a crafted schema file. The schema parser uses eval as part of its processing, and tries to protect from malicious expressions by limiting the builtins that are passed to the eval. When processing the schema, each line is run through Python's eval function to make the validator available. A well-constructed string within the schema rules can execute system commands; thus, by exploiting the vulnerability, an attacker can run arbitrary code on the image that invokes Yamale."
    },
    {
      "lang": "es",
      "value": "23andMe Yamale versiones anteriores a 3.0.8, permite a atacantes remotos ejecutar c\u00f3digo arbitrario por medio de un archivo de esquema dise\u00f1ado. El analizador de esquemas usa la funci\u00f3n eval como parte de su procesamiento, e intenta protegerse de las expresiones maliciosas al limitar las funciones integradas que son pasadas a la funci\u00f3n eval. Cuando se procesa el esquema, cada l\u00ednea se ejecuta mediante la funci\u00f3n eval de Python para que el comprobador est\u00e9 disponible. Una cadena bien construida dentro de las reglas del esquema puede ejecutar comandos del sistema; as\u00ed, al explotar la vulnerabilidad, un atacante puede ejecutar c\u00f3digo arbitrario en la imagen que invoca Yamale"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:C/I:C/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 9.3
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.6,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-434"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:23andme:yamale:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.0.8",
              "matchCriteriaId": "04256644-FBB7-43AC-BEA5-5F1BA9F069A2"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/23andMe/Yamale/pull/165",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/23andMe/Yamale/releases/tag/3.0.8",
      "source": "cve@mitre.org",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    }
  ]
}