{
  "id": "CVE-2021-41131",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-10-19T18:15:07.967",
  "lastModified": "2021-10-22T20:44:11.547",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "python-tuf is a Python reference implementation of The Update Framework (TUF). In both clients (`tuf/client` and `tuf/ngclient`), there is a path traversal vulnerability that in the worst case can overwrite files ending in `.json` anywhere on the client system on a call to `get_one_valid_targetinfo()`. It occurs because the rolename is used to form the filename, and may contain path traversal characters (ie `../../name.json`). The impact is mitigated by a few facts: It only affects implementations that allow arbitrary rolename selection for delegated targets metadata, The attack requires the ability to A) insert new metadata for the path-traversing role and B) get the role delegated by an existing targets metadata, The written file content is heavily restricted since it needs to be a valid, signed targets file. The file extension is always .json. A fix is available in version 0.19 or newer. There are no workarounds that do not require code changes. Clients can restrict the allowed character set for rolenames, or they can store metadata in files named in a way that is not vulnerable: neither of these approaches is possible without modifying python-tuf."
    },
    {
      "lang": "es",
      "value": "python-tuf es una implementaci\u00f3n de referencia en Python de The Update Framework (TUF). En ambos clientes (\"tuf/client\" y \"tuf/ngclient\"), se presenta una vulnerabilidad en la ruta de acceso que, en el peor de los casos, puede sobrescribir los archivos que terminan en \".json\" en cualquier parte del sistema cliente en una llamada a \"get_one_valid_targetinfo()\". Ocurre porque el rolename es usado para formar el nombre del archivo, y puede contener caracteres de salto de ruta (por ejemplo \"../../nombre.json\"). El impacto est\u00e1 mitigado por algunos hechos: S\u00f3lo afecta a las implementaciones que permiten la selecci\u00f3n arbitraria de nombres de rol para los metadatos de los objetivos delegados, El ataque requiere la capacidad de A) insertar nuevos metadatos para el rol que atraviesa la ruta y B) conseguir el rol delegado por un metadato de objetivos existente, El contenido del archivo escrito est\u00e1 fuertemente restringido ya que necesita ser un archivo de objetivos v\u00e1lido y firmado. La extensi\u00f3n del archivo es siempre .json. Se presenta una correcci\u00f3n disponible en la versi\u00f3n 0.19 o m\u00e1s reciente. No se presentan soluciones que no requieran cambios en el c\u00f3digo. Los clientes pueden restringir el conjunto de caracteres permitidos para los nombres de rol, o pueden almacenar metadatos en archivos con nombres que no sean vulnerables: ninguno de estos enfoques es posible sin modificar python-tuf"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:N/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.7,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 5.8
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:C/C:L/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 4.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:C/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 8.8
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 8.6,
        "impactScore": 9.2,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:linuxfoundation:the_update_framework:*:*:*:*:*:python:*:*",
              "versionEndIncluding": "0.18.1",
              "matchCriteriaId": "6F0BDA96-F4FA-4C50-904E-56E5E3BE4B13"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/theupdateframework/python-tuf/commit/4ad7ae48fda594b640139c3b7eae21ed5155a102",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theupdateframework/python-tuf/issues/1527",
      "source": "security-advisories@github.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/theupdateframework/python-tuf/security/advisories/GHSA-wjw6-2cqr-j4qr",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}