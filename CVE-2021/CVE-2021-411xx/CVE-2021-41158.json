{
  "id": "CVE-2021-41158",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-10-26T14:15:08.007",
  "lastModified": "2022-10-24T16:06:20.397",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "FreeSWITCH is a Software Defined Telecom Stack enabling the digital transformation from proprietary telecom switches to a software implementation that runs on any commodity hardware. Prior to version 1.10.7, an attacker can perform a SIP digest leak attack against FreeSWITCH and receive the challenge response of a gateway configured on the FreeSWITCH server. This is done by challenging FreeSWITCH's SIP requests with the realm set to that of the gateway, thus forcing FreeSWITCH to respond with the challenge response which is based on the password of that targeted gateway. Abuse of this vulnerability allows attackers to potentially recover gateway passwords by performing a fast offline password cracking attack on the challenge response. The attacker does not require special network privileges, such as the ability to sniff the FreeSWITCH's network traffic, to exploit this issue. Instead, what is required for this attack to work is the ability to cause the victim server to send SIP request messages to the malicious party. Additionally, to exploit this issue, the attacker needs to specify the correct realm which might in some cases be considered secret. However, because many gateways are actually public, this information can easily be retrieved. The vulnerability appears to be due to the code which handles challenges in `sofia_reg.c`, `sofia_reg_handle_sip_r_challenge()` which does not check if the challenge is originating from the actual gateway. The lack of these checks allows arbitrary UACs (and gateways) to challenge any request sent by FreeSWITCH with the realm of the gateway being targeted. This issue is patched in version 10.10.7. Maintainers recommend that one should create an association between a SIP session for each gateway and its realm to make a check be put into place for this association when responding to challenges."
    },
    {
      "lang": "es",
      "value": "FreeSWITCH es una Pila de Telecomunicaciones Definida por Software que permite la transformaci\u00f3n digital de los switches de telecomunicaciones propietarios a una implementaci\u00f3n de software que se ejecuta en cualquier hardware b\u00e1sico. En versiones anteriores a 1.10.7, un atacante puede llevar a cabo un ataque de filtrado de compendio SIP contra FreeSWITCH y recibir la respuesta de desaf\u00edo de una pasarela configurada en el servidor FreeSWITCH. Esto es realizado al desafiar las peticiones SIP de FreeSWITCH con el reino configurado como el de la pasarela, forzando as\u00ed a FreeSWITCH a responder con la respuesta de desaf\u00edo que es basada en la contrase\u00f1a de esa pasarela objetivo. El abuso de esta vulnerabilidad permite a atacantes recuperar potencialmente las contrase\u00f1as de la puerta de enlace llevando a cabo un r\u00e1pido ataque de descifrado de contrase\u00f1as fuera de l\u00ednea en la respuesta de desaf\u00edo. El atacante no requiere privilegios de red especiales, como la capacidad de husmear el tr\u00e1fico de red de FreeSWITCH, para explotar este problema. En cambio, lo que es requerido para que este ataque funcione es la capacidad de causar que el servidor v\u00edctima env\u00ede mensajes de petici\u00f3n SIP a la parte maliciosa. Adem\u00e1s, para explotar este problema, el atacante necesita especificar el reino correcto, que en algunos casos podr\u00eda considerarse secreto. Sin embargo, como muchas pasarelas son realmente p\u00fablicas, esta informaci\u00f3n puede ser f\u00e1cilmente recuperada. La vulnerabilidad parece deberse al c\u00f3digo que maneja los retos en \"sofia_reg.c\", \"sofia_reg_handle_sip_r_challenge()\" que no comprueba si el reto se origina en la pasarela real. La falta de estas comprobaciones permite que UACs arbitrarias (y pasarelas) desaf\u00eden cualquier petici\u00f3n enviada por FreeSWITCH con el reino de la pasarela a la que se dirige. Este problema est\u00e1 parcheado en la versi\u00f3n 10.10.7. Los mantenedores recomiendan que se cree una asociaci\u00f3n entre una sesi\u00f3n SIP para cada pasarela y su reino para hacer una comprobaci\u00f3n de esta asociaci\u00f3n cuando se responda a los desaf\u00edos"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-346"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-200"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:freeswitch:freeswitch:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.10.7",
              "matchCriteriaId": "AC84E752-644B-4E28-8E03-DA7B5C9C2521"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://seclists.org/fulldisclosure/2021/Oct/40",
      "source": "security-advisories@github.com",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/releases/tag/v1.10.7",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/signalwire/freeswitch/security/advisories/GHSA-3v3f-99mv-qvj4",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}