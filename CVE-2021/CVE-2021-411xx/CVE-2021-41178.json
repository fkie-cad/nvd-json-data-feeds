{
  "id": "CVE-2021-41178",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-10-25T22:15:07.913",
  "lastModified": "2022-10-25T20:53:24.923",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Nextcloud is an open-source, self-hosted productivity platform. Prior to versions 20.0.13, 21.0.5, and 22.2.0, a file traversal vulnerability makes an attacker able to download arbitrary SVG images from the host system, including user provided files. This could also be leveraged into a XSS/phishing attack, an attacker could upload a malicious SVG file that mimics the Nextcloud login form and send a specially crafted link to victims. The XSS risk here is mitigated due to the fact that Nextcloud employs a strict Content-Security-Policy disallowing execution of arbitrary JavaScript. It is recommended that the Nextcloud Server be upgraded to 20.0.13, 21.0.5 or 22.2.0. There are no known workarounds aside from upgrading."
    },
    {
      "lang": "es",
      "value": "Nextcloud es una plataforma de productividad de c\u00f3digo abierto y auto-alojada. Antes de las versiones 20.0.13, 21.0.5 y 22.2.0, una vulnerabilidad de salto de archivos hace que un atacante pueda descargar im\u00e1genes SVG arbitrarias del sistema anfitri\u00f3n, incluyendo archivos proporcionados por el usuario. Esto tambi\u00e9n podr\u00eda ser aprovechado en un ataque de tipo XSS/phishing, un atacante podr\u00eda subir un archivo SVG malicioso que imita el formulario de inicio de sesi\u00f3n de Nextcloud y enviar un enlace especialmente dise\u00f1ado a las v\u00edctimas. El riesgo de un ataque de tipo XSS en este caso est\u00e1 mitigado debido a que Nextcloud emplea una estricta Pol\u00edtica de Seguridad de Contenidos que no permite la ejecuci\u00f3n de JavaScript arbitrario. Es recomendado actualizar el servidor Nextcloud a la versi\u00f3n 20.0.13, 21.0.5 o 22.2.0. No se presentan soluciones conocidas aparte de la actualizaci\u00f3n"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 3.6
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-23"
        },
        {
          "lang": "en",
          "value": "CWE-434"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "20.0.3",
              "versionEndExcluding": "20.0.13",
              "matchCriteriaId": "8CF59A46-813A-4F63-A748-B4B1787475A6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "21.0.1",
              "versionEndExcluding": "21.0.5",
              "matchCriteriaId": "B8DBD42A-4D0B-4E74-9658-29325664880A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "22.1.1",
              "versionEndExcluding": "22.2.0",
              "matchCriteriaId": "FABD6E21-6B12-460A-AA56-85C83D641E4E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-jp9c-vpr3-m5rf",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/nextcloud/server/pull/28726",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/1302155",
      "source": "security-advisories@github.com",
      "tags": [
        "Permissions Required"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-17",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}