{
  "id": "CVE-2021-28710",
  "sourceIdentifier": "security@xen.org",
  "published": "2021-11-21T15:15:07.597",
  "lastModified": "2023-11-07T03:32:20.603",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "certain VT-d IOMMUs may not work in shared page table mode For efficiency reasons, address translation control structures (page tables) may (and, on suitable hardware, by default will) be shared between CPUs, for second-level translation (EPT), and IOMMUs. These page tables are presently set up to always be 4 levels deep. However, an IOMMU may require the use of just 3 page table levels. In such a configuration the lop level table needs to be stripped before inserting the root table's address into the hardware pagetable base register. When sharing page tables, Xen erroneously skipped this stripping. Consequently, the guest is able to write to leaf page table entries."
    },
    {
      "lang": "es",
      "value": "determinadas IOMMUs de VT-d pueden no funcionar en modo de tabla de p\u00e1ginas compartida Por razones de eficiencia, las estructuras de control de traducci\u00f3n de direcciones (tablas de p\u00e1ginas) pueden (y, en el hardware adecuado, por defecto) ser compartidas entre las CPUs, para la traducci\u00f3n de segundo nivel (EPT), y las IOMMUs. Estas tablas de p\u00e1ginas est\u00e1n actualmente configuradas para tener siempre 4 niveles de profundidad. Sin embargo, una IOMMU puede requerir el uso de s\u00f3lo 3 niveles de tabla de p\u00e1ginas. En una configuraci\u00f3n de este tipo, la tabla de nivel inferior debe ser eliminada antes de insertar la direcci\u00f3n de la tabla root en el registro base de la tabla de p\u00e1ginas del hardware. Cuando son compartidas las tablas de p\u00e1ginas, Xen omite err\u00f3neamente este despojo. En consecuencia, el hu\u00e9sped es capaz de escribir en las entradas de la tabla de p\u00e1ginas hoja"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.0,
        "impactScore": 6.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:M/Au:N/C:C/I:C/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 6.9
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 3.4,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:4.15.0:*:*:*:*:*:x86:*",
              "matchCriteriaId": "C3BFD203-8E25-46AF-AF43-DAFB86BDFE0D"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:35:*:*:*:*:*:*:*",
              "matchCriteriaId": "80E516C0-98A4-4ADE-B69F-66A772E2BAAA"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/I7ZGWVVRI4XY2XSTBI3XEMWBXPDVX6OT/",
      "source": "security@xen.org"
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-23",
      "source": "security@xen.org",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://xenbits.xenproject.org/xsa/advisory-390.txt",
      "source": "security@xen.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}