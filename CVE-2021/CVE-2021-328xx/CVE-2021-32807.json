{
  "id": "CVE-2021-32807",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-07-30T22:15:07.967",
  "lastModified": "2022-12-02T19:36:56.347",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "The module `AccessControl` defines security policies for Python code used in restricted code within Zope applications. Restricted code is any code that resides in Zope's object database, such as the contents of `Script (Python)` objects. The policies defined in `AccessControl` severely restrict access to Python modules and only exempt a few that are deemed safe, such as Python's `string` module. However, full access to the `string` module also allows access to the class `Formatter`, which can be overridden and extended within `Script (Python)` in a way that provides access to other unsafe Python libraries. Those unsafe Python libraries can be used for remote code execution. By default, you need to have the admin-level Zope \"Manager\" role to add or edit `Script (Python)` objects through the web. Only sites that allow untrusted users to add/edit these scripts through the web - which would be a very unusual configuration to begin with - are at risk. The problem has been fixed in AccessControl 4.3 and 5.2. Only AccessControl versions 4 and 5 are vulnerable, and only on Python 3, not Python 2.7. As a workaround, a site administrator can restrict adding/editing `Script (Python)` objects through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing these scripts through the web should be restricted to trusted users only. This is the default configuration in Zope."
    },
    {
      "lang": "es",
      "value": "El m\u00f3dulo \"AccessControl\" define las pol\u00edticas de seguridad para el c\u00f3digo Python usado en el c\u00f3digo restringido dentro de las aplicaciones de Zope. El c\u00f3digo restringido es cualquier c\u00f3digo que reside en la base de datos de objetos de Zope, como el contenido de los objetos \"Script (Python)\". Las pol\u00edticas definidas en \"AccessControl\" restringen severamente el acceso a los m\u00f3dulos de Python y s\u00f3lo eximen a unos pocos que se consideran seguros, como el m\u00f3dulo \"string\" de Python. Sin embargo, el acceso completo al m\u00f3dulo \"string\" tambi\u00e9n permite el acceso a la clase \"Formatter\", que puede ser sobrescrita y extendida dentro de \"Script (Python)\" de manera que proporciona acceso a otras bibliotecas no seguras de Python. Estas bibliotecas no seguras de Python pueden ser usadas para una ejecuci\u00f3n de c\u00f3digo remota . Por defecto, necesitas tener el rol de \"Manager\" de Zope a nivel de administrador para a\u00f1adir o editar objetos \"Script (Python)\" mediante la web. S\u00f3lo los sitios que permiten a usuarios no confiables a\u00f1adir/editar estos scripts a trav\u00e9s de la web - lo que ser\u00eda una configuraci\u00f3n muy inusual para empezar - est\u00e1n en riesgo. El problema se ha corregido en AccessControl versiones 4.3 y 5.2. S\u00f3lo las versiones 4 y 5 de AccessControl son vulnerables, y s\u00f3lo en Python 3, no en Python 2.7. Como soluci\u00f3n, un administrador del sitio puede restringir la adici\u00f3n/edici\u00f3n de objetos \"Script (Python)\" mediante la web usando los mecanismos est\u00e1ndar de permisos de usuario/rol de Zope. A unos usuarios que no son de confianza no se les deber\u00eda asignar el rol de Administrador de Zope y a\u00f1adir/editar estos scripts mediante la web deber\u00eda estar restringido s\u00f3lo a usuarios de confianza. Esta es la configuraci\u00f3n predeterminada en Zope"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:H/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.2,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.2,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:H/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "HIGH",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 4.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 0.7,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.5
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-1321"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-915"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zope:accesscontrol:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0",
              "versionEndExcluding": "4.3",
              "matchCriteriaId": "8538D35C-EA69-4A87-8DBB-D6522F8C7422"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zope:accesscontrol:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.0",
              "versionEndExcluding": "5.2",
              "matchCriteriaId": "34F2C931-DCB6-4326-BBDF-2E9B13946D55"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/zopefoundation/AccessControl/blob/master/CHANGES.rst#51-2021-07-30",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zopefoundation/AccessControl/commit/b42dd4badf803bb9fb71ac34cd9cb0c249262f2c",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zopefoundation/AccessControl/security/advisories/GHSA-qcx9-j53g-ccgf",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}