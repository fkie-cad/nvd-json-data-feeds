{
  "id": "CVE-2021-32802",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-09-07T22:15:08.563",
  "lastModified": "2022-09-27T14:16:07.013",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Nextcloud server is an open source, self hosted personal cloud. Nextcloud supports rendering image previews for user provided file content. For some image types, the Nextcloud server was invoking a third-party library that wasn't suited for untrusted user-supplied content. There are several security concerns with passing user-generated content to this library, such as Server-Side-Request-Forgery, file disclosure or potentially executing code on the system. The risk depends on your system configuration and the installed library version. It is recommended that the Nextcloud Server is upgraded to 20.0.12, 21.0.4 or 22.1.0. These versions do not use this library anymore. As a workaround users may disable previews by setting `enable_previews` to `false` in `config.php`."
    },
    {
      "lang": "es",
      "value": "El servidor Nextcloud es una nube personal de c\u00f3digo abierto y autoalojada. Nextcloud admite la representaci\u00f3n de vistas previas de im\u00e1genes para el contenido de archivos proporcionados por el usuario. Para algunos tipos de im\u00e1genes, el servidor Nextcloud estaba invocando una biblioteca de terceros que no era adecuada para el contenido no confiable proporcionado por el usuario. Se presentan varios problemas de seguridad al pasar contenido generado por el usuario a esta biblioteca, como un ataque de tipo Server-Side-Request-Forgery, una divulgaci\u00f3n de archivos o una posible ejecuci\u00f3n de c\u00f3digo en el sistema. El riesgo depende de la configuraci\u00f3n del sistema y de la versi\u00f3n de la biblioteca instalada. Es recomendado actualizar el servidor Nextcloud a versi\u00f3n 20.0.12, 21.0.4 o 22.1.0. Estas versiones ya no usan esta biblioteca. Como soluci\u00f3n alternativa, los usuarios pueden deshabilitar las vistas previas al ajustar \"enable_previews\" a \"false\" en \"config.php\""
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "LOW",
          "baseScore": 9.3,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "COMPLETE",
          "integrityImpact": "COMPLETE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 10.0
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 10.0,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-829"
        }
      ]
    },
    {
      "source": "nvd@nist.gov",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-829"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "20.0.12",
              "matchCriteriaId": "68C08D05-1FEC-4A5B-8925-B8D910541CEE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "21.0.0",
              "versionEndExcluding": "21.0.4",
              "matchCriteriaId": "B1D99183-A99E-4C56-991A-D4287EEDFE79"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:nextcloud:nextcloud_server:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "22.0.0",
              "versionEndExcluding": "22.1.0",
              "matchCriteriaId": "655A23FE-6908-4F26-878C-29F9F2D269A6"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://docs.nextcloud.com/server/21/admin_manual/configuration_files/previews_configuration.html#disabling-previews",
      "source": "security-advisories@github.com",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/nextcloud/security-advisories/security/advisories/GHSA-m682-v4g9-wrq7",
      "source": "security-advisories@github.com",
      "tags": [
        "Mitigation",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://hackerone.com/reports/1261413",
      "source": "security-advisories@github.com",
      "tags": [
        "Permissions Required",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202208-17",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}