{
  "id": "CVE-2021-32674",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-06-08T18:15:08.307",
  "lastModified": "2022-01-21T14:42:58.327",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Zope is an open-source web application server. This advisory extends the previous advisory at https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36 with additional cases of TAL expression traversal vulnerabilities. Most Python modules are not available for using in TAL expressions that you can add through-the-web, for example in Zope Page Templates. This restriction avoids file system access, for example via the 'os' module. But some of the untrusted modules are available indirectly through Python modules that are available for direct use. By default, you need to have the Manager role to add or edit Zope Page Templates through the web. Only sites that allow untrusted users to add/edit Zope Page Templates through the web are at risk. The problem has been fixed in Zope 5.2.1 and 4.6.1. The workaround is the same as for https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36: A site administrator can restrict adding/editing Zope Page Templates through the web using the standard Zope user/role permission mechanisms. Untrusted users should not be assigned the Zope Manager role and adding/editing Zope Page Templates through the web should be restricted to trusted users only."
    },
    {
      "lang": "es",
      "value": "Zope es un servidor de aplicaciones web de c\u00f3digo abierto. Este aviso ampl\u00eda el aviso anterior en https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36 con casos adicionales de vulnerabilidades de cruce de expresiones TAL. La mayor\u00eda de los m\u00f3dulos de Python no est\u00e1n disponibles para su uso en expresiones TAL que se pueden a\u00f1adir a trav\u00e9s de la web, por ejemplo en las plantillas de p\u00e1ginas de Zope. Esta restricci\u00f3n evita el acceso al sistema de archivos, por ejemplo a trav\u00e9s del m\u00f3dulo 'os'. Pero algunos de los m\u00f3dulos no confiables est\u00e1n disponibles indirectamente a trav\u00e9s de los m\u00f3dulos de Python que est\u00e1n disponibles para su uso directo. Por defecto, es necesario tener el rol de Administrador para a\u00f1adir o editar Plantillas de P\u00e1gina Zope a trav\u00e9s de la web. S\u00f3lo los sitios que permiten a los usuarios no confiables a\u00f1adir/editar Plantillas de P\u00e1gina Zope a trav\u00e9s de la web est\u00e1n en riesgo. El problema se ha solucionado en Zope versiones 5.2.1 y 4.6.1. La soluci\u00f3n es la misma que para https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36: Un administrador del sitio puede restringir la adici\u00f3n/edici\u00f3n de Plantillas de P\u00e1gina Zope a trav\u00e9s de la web utilizando los mecanismos est\u00e1ndar de permisos de usuario/rol de Zope. A los usuarios que no sean de confianza no se les debe asignar el rol de Gestor de Zope y a\u00f1adir/editar Plantillas de P\u00e1gina Zope a trav\u00e9s de la web debe estar restringido s\u00f3lo a los usuarios de confianza"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "security-advisories@github.com",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "nvd@nist.gov",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.5
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-22"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zope:zope:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "4.6.1",
              "matchCriteriaId": "712BA8E7-7A6A-45C3-956C-50A504307324"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zope:zope:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "5.0.0",
              "versionEndExcluding": "5.2.1",
              "matchCriteriaId": "A81939E1-6719-4032-960C-4B181E9E4E28"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/zopefoundation/Zope/commit/1d897910139e2c0b11984fc9b78c1da1365bec21",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-5pr9-v234-jw36",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zopefoundation/Zope/security/advisories/GHSA-rpcg-f9q6-2mq6",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://pypi.org/project/Zope/",
      "source": "security-advisories@github.com",
      "tags": [
        "Product"
      ]
    }
  ]
}