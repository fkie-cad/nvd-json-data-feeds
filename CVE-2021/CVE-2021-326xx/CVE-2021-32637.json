{
  "id": "CVE-2021-32637",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-05-28T17:15:07.493",
  "lastModified": "2021-06-09T16:36:44.157",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Authelia is a a single sign-on multi-factor portal for web apps. This affects uses who are using nginx ngx_http_auth_request_module with Authelia, it allows a malicious individual who crafts a malformed HTTP request to bypass the authentication mechanism. It additionally could theoretically affect other proxy servers, but all of the ones we officially support except nginx do not allow malformed URI paths. The problem is rectified entirely in v4.29.3. As this patch is relatively straightforward we can back port this to any version upon request. Alternatively we are supplying a git patch to 4.25.1 which should be relatively straightforward to apply to any version, the git patches for specific versions can be found in the references. The most relevant workaround is upgrading. You can also add a block which fails requests that contains a malformed URI in the internal location block."
    },
    {
      "lang": "es",
      "value": "Authelia es un portal multifactor de inicio de sesi\u00f3n \u00fanico para aplicaciones web.&#xa0;Esto afecta a usuarios que usan la funci\u00f3n nginx ngx_http_auth_request_module con Authelia, permite a un individuo  malicioso que dise\u00f1a una petici\u00f3n HTTP malformada omitir el mecanismo de autenticaci\u00f3n.&#xa0;Adem\u00e1s, podr\u00eda afectar te\u00f3ricamente a otros servidores proxy, pero todos los que admitimos oficialmente, excepto nginx, no permiten rutas URI malformadas.&#xa0;El problema es rectificado por completo en la versi\u00f3n v4.29.3.&#xa0;Como este parche es relativamente sencillo, podemos realizar un backport a cualquier versi\u00f3n a pedido.&#xa0;Alternativamente, estamos proporcionando un parche de git para la versi\u00f3n 4.25.1, que deber\u00eda ser relativamente sencillo de aplicar a cualquier versi\u00f3n, los parches de git para versiones espec\u00edficas se pueden encontrar en las referencias.&#xa0;La soluci\u00f3n alternativa m\u00e1s relevante es la actualizaci\u00f3n. Tambi\u00e9n puede a\u00f1adir un bloque que falle las peticiones que contengan un URI malformado en el bloque de localizaci\u00f3n interna"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 10.0,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 6.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 7.5
        },
        "baseSeverity": "HIGH",
        "exploitabilityScore": 10.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:authelia:authelia:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0.0",
              "versionEndExcluding": "4.25.1",
              "matchCriteriaId": "B34C028E-DCF0-40E5-8482-F37539F864B8"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:authelia:authelia:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.26.0",
              "versionEndExcluding": "4.29.3",
              "matchCriteriaId": "E0370876-3F55-4A4F-82F7-D2E5B5C5C78D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/authelia/authelia/commit/c62dbd43d6e69ae81530e7c4f8763857f8ff1dda",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/authelia/authelia/security/advisories/GHSA-68wm-pfjf-wqp6",
      "source": "security-advisories@github.com",
      "tags": [
        "Exploit",
        "Mitigation",
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}