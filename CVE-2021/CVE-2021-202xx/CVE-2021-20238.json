{
  "id": "CVE-2021-20238",
  "sourceIdentifier": "secalert@redhat.com",
  "published": "2022-04-01T23:15:08.727",
  "lastModified": "2023-06-26T18:00:49.937",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "It was found in OpenShift Container Platform 4 that ignition config, served by the Machine Config Server, can be accessed externally from clusters without authentication. The MCS endpoint (port 22623) provides ignition configuration used for bootstrapping Nodes and can include some sensitive data, e.g. registry pull secrets. There are two scenarios where this data can be accessed. The first is on Baremetal, OpenStack, Ovirt, Vsphere and KubeVirt deployments which do not have a separate internal API endpoint and allow access from outside the cluster to port 22623 from the standard OpenShift API Virtual IP address. The second is on cloud deployments when using unsupported network plugins, which do not create iptables rules that prevent to port 22623. In this scenario, the ignition config is exposed to all pods within the cluster and cannot be accessed externally."
    },
    {
      "lang": "es",
      "value": "Se ha encontrado en OpenShift Container Platform 4 que la configuraci\u00f3n de encendido, servida por el Machine Config Server, puede ser accedida externamente desde los clusters sin autenticaci\u00f3n. El endpoint del MCS (puerto 22623) proporciona la configuraci\u00f3n de ignici\u00f3n usada para el arranque de los nodos y puede incluir algunos datos confidenciales, por ejemplo, secretos de extracci\u00f3n del registro. Se presentan dos escenarios en los que puede accederse a estos datos. El primero es en los despliegues de Baremetal, OpenStack, Ovirt, Vsphere y KubeVirt que no presentan un endpoint de API interno separado y permiten el acceso desde fuera del cl\u00faster al puerto 22623 desde la direcci\u00f3n IP virtual de la API est\u00e1ndar de OpenShift. La segunda es en los despliegues en la nube cuando son usados plugins de red no soportados, que no crean reglas iptables que impidan al puerto 22623. En este escenario, la configuraci\u00f3n de encendido est\u00e1 expuesta a todos los pods dentro del cl\u00faster y no puede accederse externamente"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.7,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-306"
        }
      ]
    },
    {
      "source": "secalert@redhat.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-287"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:redhat:openshift_container_platform:4.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "932D137F-528B-4526-9A89-CD59FA1AB0FE"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:redhat:openshift_machine-config-operator:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "4.9.0",
              "matchCriteriaId": "3548B998-6051-40A8-9F7B-6ABD7973FDD8"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=1926568",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Mitigation",
        "Vendor Advisory"
      ]
    }
  ]
}