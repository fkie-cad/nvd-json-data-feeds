{
  "id": "CVE-2021-21704",
  "sourceIdentifier": "security@php.net",
  "published": "2021-10-04T04:15:07.737",
  "lastModified": "2022-10-25T14:58:32.663",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In PHP versions 7.3.x below 7.3.29, 7.4.x below 7.4.21 and 8.0.x below 8.0.8, when using Firebird PDO driver extension, a malicious database server could cause crashes in various database functions, such as getAttribute(), execute(), fetch() and others by returning invalid response data that is not parsed correctly by the driver. This can result in crashes, denial of service or potentially memory corruption."
    },
    {
      "lang": "es",
      "value": "En PHP versiones 7.3.x  por debajo de 7.3.29, 7.4.x y por debajo de 7.4.21 y 8.0.x por debajo de 8.0.8, cuando es usada la extensi\u00f3n del controlador PDO de Firebird, un servidor de base de datos malicioso podr\u00eda causar bloqueos en varias funciones de la base de datos, como getAttribute(), execute(), fetch() y otras, al devolver datos de respuesta no v\u00e1lidos que no son analizados correctamente por el controlador. Esto puede resultar en fallos, denegaci\u00f3n de servicio o potencialmente una corrupci\u00f3n de memoria"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      },
      {
        "source": "security@php.net",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:L/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 5.0,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 3.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-787"
        }
      ]
    },
    {
      "source": "security@php.net",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-125"
        },
        {
          "lang": "en",
          "value": "CWE-190"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "7.3.0",
              "versionEndExcluding": "7.3.29",
              "matchCriteriaId": "82BE8E00-14C8-415D-9FDC-7E77C455097D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "7.4.0",
              "versionEndExcluding": "7.4.21",
              "matchCriteriaId": "C48354D3-01BE-417B-916B-CCB7639C9BA2"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:php:php:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.0.0",
              "versionEndExcluding": "8.0.8",
              "matchCriteriaId": "08BF11AE-E859-4498-AA46-72689B4BE396"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:netapp:clustered_data_ontap:-:*:*:*:*:*:*:*",
              "matchCriteriaId": "1FE996B1-6951-4F85-AA58-B99A379D2163"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugs.php.net/bug.php?id=76448",
      "source": "security@php.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugs.php.net/bug.php?id=76449",
      "source": "security@php.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugs.php.net/bug.php?id=76450",
      "source": "security@php.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://bugs.php.net/bug.php?id=76452",
      "source": "security@php.net",
      "tags": [
        "Exploit",
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.gentoo.org/glsa/202209-20",
      "source": "security@php.net",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20211029-0006/",
      "source": "security@php.net",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}