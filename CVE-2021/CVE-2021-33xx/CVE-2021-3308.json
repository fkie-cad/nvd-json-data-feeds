{
  "id": "CVE-2021-3308",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2021-01-26T20:15:12.303",
  "lastModified": "2023-11-07T03:37:57.983",
  "vulnStatus": "Modified",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in Xen 4.12.3 through 4.12.4 and 4.13.1 through 4.14.x. An x86 HVM guest with PCI pass through devices can force the allocation of all IDT vectors on the system by rebooting itself with MSI or MSI-X capabilities enabled and entries setup. Such reboots will leak any vectors used by the MSI(-X) entries that the guest might had enabled, and hence will lead to vector exhaustion on the system, not allowing further PCI pass through devices to work properly. HVM guests with PCI pass through devices can mount a Denial of Service (DoS) attack affecting the pass through of PCI devices to other guests or the hardware domain. In the latter case, this would affect the entire host."
    },
    {
      "lang": "es",
      "value": "Se detect\u00f3 un problema en Xen versiones 4.12.3 hasta 4.12.4 y versiones 4.13.1 hasta 4.14.x. Un invitado HVM x86 con PCI pasando a trav\u00e9s de los dispositivos puede forzar la asignaci\u00f3n de todos los vectores IDT en el sistema al reiniciarse con las capacidades MSI o MSI-X habilitadas y la configuraci\u00f3n de entradas. Dichos reinicios filtrar\u00e1n todos los vectores usados por las entradas MSI(-X) que el invitado podr\u00eda haber habilitado y, por lo tanto, conllevar\u00e1n al agotamiento del vector en el sistema, lo que no permitir\u00e1 que otros dispositivos PCI pasen a funcionar correctamente. Los invitados HVM con PCI pasando a trav\u00e9s de los dispositivos pueden montar un ataque de denegaci\u00f3n de servicio (DoS) que afecta el paso de dispositivos PCI para otros invitados o al dominio del hardware. En el \u00faltimo caso, esto afectar\u00eda a todo el host"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:N/I:N/A:C",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "COMPLETE",
          "baseScore": 4.9
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 3.9,
        "impactScore": 6.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "NVD-CWE-noinfo"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.13.1",
              "versionEndIncluding": "4.14.1",
              "matchCriteriaId": "E098391E-2E24-44B7-8F28-7343DF9E58E6"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:4.12.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "050028D1-C44E-4101-8FBA-9822AF11BCC3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:xen:xen:4.12.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "BFFFC008-78C6-4256-8B78-AB9E1D374D93"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:o:fedoraproject:fedora:32:*:*:*:*:*:*:*",
              "matchCriteriaId": "36D96259-24BD-44E2-96D9-78CE1D41F956"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/01/26/4",
      "source": "cve@mitre.org",
      "tags": [
        "Mailing List",
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "http://xenbits.xen.org/xsa/advisory-360.html",
      "source": "cve@mitre.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.fedoraproject.org/archives/list/package-announce%40lists.fedoraproject.org/message/S5C42TMQYB6SDVT2MPFEWY65A6RSUVBN/",
      "source": "cve@mitre.org"
    },
    {
      "url": "https://security.gentoo.org/glsa/202107-30",
      "source": "cve@mitre.org",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}