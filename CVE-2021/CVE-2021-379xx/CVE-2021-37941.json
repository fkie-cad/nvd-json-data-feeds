{
  "id": "CVE-2021-37941",
  "sourceIdentifier": "bressers@elastic.co",
  "published": "2021-12-08T22:15:08.677",
  "lastModified": "2021-12-14T00:23:16.513",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "A local privilege escalation issue was found with the APM Java agent, where a user on the system could attach a malicious file to an application running with the APM Java agent. Using this vector, a malicious or compromised user account could use the agent to run commands at a higher level of permissions than they possess. This vulnerability affects users that have set up the agent via the attacher cli 3, the attach API 2, as well as users that have enabled the profiling_inferred_spans_enabled option"
    },
    {
      "lang": "es",
      "value": "Se encontr\u00f3 un problema de escalada de privilegios local con el agente Java de APM, donde un usuario en el sistema podr\u00eda adjuntar un archivo malicioso a una aplicaci\u00f3n que es ejecutada con el agente Java de APM. Usando este vector, una cuenta de usuario maliciosa o comprometida podr\u00eda usar el agente para ejecutar comandos con un nivel de permisos superior al que posee. Esta vulnerabilidad afecta a los usuarios que han configurado el agente por medio del attacher cli 3, el attach API 2, as\u00ed como a usuarios que han habilitado la opci\u00f3n profiling_inferred_spans_enabled"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 7.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:M/Au:N/C:P/I:P/A:P",
          "accessVector": "LOCAL",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 4.4
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 3.4,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    },
    {
      "source": "bressers@elastic.co",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-269"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:elastic:apm_agent:*:*:*:*:*:java:*:*",
              "versionStartIncluding": "1.10.0",
              "versionEndIncluding": "1.26.0",
              "matchCriteriaId": "0C491DFB-BE96-42E3-A4A5-F7A03E61735A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.elastic.co/t/apm-java-agent-security-update/289627",
      "source": "bressers@elastic.co",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}