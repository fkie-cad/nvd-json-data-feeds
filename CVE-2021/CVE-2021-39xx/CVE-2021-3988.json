{
  "id": "CVE-2021-3988",
  "sourceIdentifier": "security@huntr.dev",
  "published": "2024-11-15T11:15:06.877",
  "lastModified": "2024-11-19T15:43:01.723",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A Cross-site Scripting (XSS) vulnerability exists in janeczku/calibre-web, specifically in the file `edit_books.js`. The vulnerability occurs when editing book properties, such as uploading a cover or a format. The affected code directly inserts user input into the DOM without proper sanitization, allowing attackers to execute arbitrary JavaScript code. This can lead to various attacks, including stealing cookies. The issue is present in the code handling the `#btn-upload-cover` change event."
    },
    {
      "lang": "es",
      "value": "Existe una vulnerabilidad de Cross-site Scripting (XSS) en janeczku/calibre-web, espec\u00edficamente en el archivo `edit_books.js`. La vulnerabilidad se produce al editar las propiedades de un libro, como cargar una portada o un formato. El c\u00f3digo afectado inserta directamente la entrada del usuario en el DOM sin la limpieza adecuada, lo que permite a los atacantes ejecutar c\u00f3digo JavaScript arbitrario. Esto puede dar lugar a varios ataques, incluido el robo de cookies. El problema est\u00e1 presente en el c\u00f3digo que maneja el evento de cambio `#btn-upload-cover`."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      }
    ],
    "cvssMetricV30": [
      {
        "source": "security@huntr.dev",
        "type": "Secondary",
        "cvssData": {
          "version": "3.0",
          "vectorString": "CVSS:3.0/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:N/A:N",
          "baseScore": 5.7,
          "baseSeverity": "MEDIUM",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE"
        },
        "exploitabilityScore": 2.1,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@huntr.dev",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:janeczku:calibre-web:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "0.6.15",
              "matchCriteriaId": "CB86DF8E-5F67-41CA-B657-D8E0A61CD22A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/janeczku/calibre-web/commit/7ad419dc8c12180e842a82118f4866ac3d074bc5",
      "source": "security@huntr.dev",
      "tags": [
        "Patch"
      ]
    },
    {
      "url": "https://huntr.com/bounties/fa4c8fd1-7846-4dad-9112-2c07461f0609",
      "source": "security@huntr.dev",
      "tags": [
        "Exploit"
      ]
    }
  ]
}