{
  "id": "CVE-2021-3422",
  "sourceIdentifier": "prodsec@splunk.com",
  "published": "2022-03-25T19:15:08.983",
  "lastModified": "2022-04-11T19:51:47.967",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The lack of validation of a key-value field in the Splunk-to-Splunk protocol results in a denial-of-service in Splunk Enterprise instances configured to index Universal Forwarder traffic. The vulnerability impacts Splunk Enterprise versions before 7.3.9, 8.0 versions before 8.0.9, and 8.1 versions before 8.1.3. It does not impact Universal Forwarders. When Splunk forwarding is secured using TLS or a Token, the attack requires compromising the certificate or token, or both. Implementation of either or both reduces the severity to Medium."
    },
    {
      "lang": "es",
      "value": "La falta de validaci\u00f3n de un campo clave-valor en el protocolo Splunk-to-Splunk resulta en una denegaci\u00f3n de servicio en las instancias de Splunk Enterprise configuradas para indexar el tr\u00e1fico de Universal Forwarder. La vulnerabilidad afecta a las versiones de Splunk Enterprise anteriores a la 7.3.9, a las versiones 8.0 anteriores a la 8.0.9 y a las versiones 8.1 anteriores a la 8.1.3. No afecta a los Universal Forwarders. Cuando el reenv\u00edo de Splunk est\u00e1 asegurado usando TLS o un Token, el ataque requiere comprometer el certificado o el token, o ambos. La implementaci\u00f3n de uno o ambos reduce la severidad a Media"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      },
      {
        "source": "prodsec@splunk.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:N/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-20"
        }
      ]
    },
    {
      "source": "prodsec@splunk.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-125"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:splunk:splunk:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "7.3.9",
              "matchCriteriaId": "C665B104-D5C6-409F-90D4-814E4B5D5EB9"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:splunk:splunk:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "8.0",
              "versionEndExcluding": "8.0.9",
              "matchCriteriaId": "72AD8803-DF95-453E-90D0-70A74E5CA98D"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:splunk:splunk:*:*:*:*:enterprise:*:*:*",
              "versionStartIncluding": "8.1",
              "versionEndExcluding": "8.1.3",
              "matchCriteriaId": "445E103F-DBC2-4E74-94EF-9302EA945C27"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://claroty.com/2022/03/24/blog-research-locking-down-splunk-enterprise-indexers-and-forwarders/",
      "source": "prodsec@splunk.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.splunk.com/en_us/product-security/announcements/svd-2022-0301.html",
      "source": "prodsec@splunk.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}