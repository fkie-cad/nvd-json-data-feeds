{
  "id": "CVE-2021-43777",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-11-24T16:15:14.257",
  "lastModified": "2021-11-30T15:39:23.900",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Redash is a package for data visualization and sharing. In Redash version 10.0 and prior, the implementation of Google Login (via OAuth) incorrectly uses the `state` parameter to pass the next URL to redirect the user to after login. The `state` parameter should be used for a Cross-Site Request Forgery (CSRF) token, not a static and easily predicted value. This vulnerability does not affect users who do not use Google Login for their instance of Redash. A patch in the `master` and `release/10.x.x` branches addresses this by replacing `Flask-Oauthlib` with `Authlib` which automatically provides and validates a CSRF token for the state variable. The new implementation stores the next URL on the user session object. As a workaround, one may disable Google Login to mitigate the vulnerability."
    },
    {
      "lang": "es",
      "value": "Redash es un paquete para visualizar y compartir datos. En la versi\u00f3n 10.0 de Redash y anteriores, la implementaci\u00f3n de Google Login (por medio de OAuth) usa incorrectamente el par\u00e1metro \"state\" para pasar la siguiente URL a la que redirigir al usuario despu\u00e9s de iniciar sesi\u00f3n. El par\u00e1metro \"state\" deber\u00eda ser usado para un token de tipo Cross-Site Request Forgery (CSRF), no un valor est\u00e1tico y f\u00e1cilmente predecible. Esta vulnerabilidad no afecta a usuarios que no usan Google Login para su instancia de Redash. Un parche en las ramas \"master\" y \"release/10.x.x\" aborda esto sustituyendo \"Flask-Oauthlib\" por \"Authlib\" que proporciona y comprueba autom\u00e1ticamente un token CSRF para la variable de estado. La nueva implementaci\u00f3n almacena la siguiente URL en el objeto de sesi\u00f3n del usuario. Como soluci\u00f3n, puede ser deshabilitado Google Login para mitigar la vulnerabilidad"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:U/C:H/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 6.8,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.2
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 5.8
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-601"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-352"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:redash:redash:*:*:*:*:*:*:*:*",
              "versionEndIncluding": "10.0.0",
              "matchCriteriaId": "5D326B6D-E6EE-4598-845F-63258E732F02"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/getredash/redash/commit/da696ff7f84787cbf85967460fac52886cbe063e",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/getredash/redash/security/advisories/GHSA-vhc7-w7r8-8m34",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}