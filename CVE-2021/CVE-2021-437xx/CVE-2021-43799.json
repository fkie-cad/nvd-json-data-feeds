{
  "id": "CVE-2021-43799",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2022-01-25T21:15:07.853",
  "lastModified": "2022-02-02T18:35:08.767",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Zulip is an open-source team collaboration tool. Zulip Server installs RabbitMQ for internal message passing. In versions of Zulip Server prior to 4.9, the initial installation (until first reboot, or restart of RabbitMQ) does not successfully limit the default ports which RabbitMQ opens; this includes port 25672, the RabbitMQ distribution port, which is used as a management port. RabbitMQ's default \"cookie\" which protects this port is generated using a weak PRNG, which limits the entropy of the password to at most 36 bits; in practicality, the seed for the randomizer is biased, resulting in approximately 20 bits of entropy. If other firewalls (at the OS or network level) do not protect port 25672, a remote attacker can brute-force the 20 bits of entropy in the \"cookie\" and leverage it for arbitrary execution of code as the rabbitmq user. They can also read all data which is sent through RabbitMQ, which includes all message traffic sent by users. Version 4.9 contains a patch for this vulnerability. As a workaround, ensure that firewalls prevent access to ports 5672 and 25672 from outside the Zulip server."
    },
    {
      "lang": "es",
      "value": "Zulip es una herramienta de colaboraci\u00f3n en equipo de c\u00f3digo abierto. Zulip Server instala RabbitMQ para el paso de mensajes internos. En las versiones de Zulip Server anteriores a 4.9, la instalaci\u00f3n inicial (hasta el primer reinicio, o el reinicio de RabbitMQ) no limita correctamente los puertos por defecto que RabbitMQ abre; esto incluye el puerto 25672, el puerto de distribuci\u00f3n de RabbitMQ, que es usado como puerto de administraci\u00f3n. La \"cookie\" por defecto de RabbitMQ que protege este puerto es generada usando un PRNG d\u00e9bil, que limita la entrop\u00eda de la contrase\u00f1a a un m\u00e1ximo de 36 bits; en la pr\u00e1ctica, la semilla para el aleatorizador est\u00e1 sesgada, resultando en aproximadamente 20 bits de entrop\u00eda. Si otros firewalls (a nivel de Sistema Operativo o de red) no protegen el puerto 25672, un atacante remoto puede forzar los 20 bits de entrop\u00eda de la \"cookie\" y aprovecharlos para una ejecuci\u00f3n arbitraria de c\u00f3digo como el usuario rabbitmq. Tambi\u00e9n pueden leer todos los datos que son enviados mediante RabbitMQ, lo que incluye todo el tr\u00e1fico de mensajes enviados por usuarios. La versi\u00f3n 4.9 contiene un parche para esta vulnerabilidad. Como soluci\u00f3n, aseg\u00farese de que los firewalls impiden el acceso a los puertos 5672 y 25672 desde fuera del servidor de Zulip"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.8,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 8.6,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 4.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-338"
        }
      ]
    },
    {
      "source": "security-advisories@github.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-338"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zulip:zulip:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "4.9",
              "matchCriteriaId": "FC48DF5C-4DA6-48A6-A3A5-A1F0FB87416D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/gteissier/erl-matter",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/commit/a5496f4098e3998c9b84e8dc564aa983d6cdf6e8",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/releases/tag/4.9",
      "source": "security-advisories@github.com",
      "tags": [
        "Release Notes",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/zulip/zulip/security/advisories/GHSA-p663-wxvv-2fjp",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}