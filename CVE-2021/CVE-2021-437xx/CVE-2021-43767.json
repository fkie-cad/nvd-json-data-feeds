{
  "id": "CVE-2021-43767",
  "sourceIdentifier": "patrick@puiterwijk.org",
  "published": "2022-08-25T18:15:09.377",
  "lastModified": "2022-12-21T15:01:19.963",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Odyssey passes to client unencrypted bytes from man-in-the-middle When Odyssey storage is configured to use the PostgreSQL server using 'trust' authentication with a 'clientcert' requirement or to use 'cert' authentication, a man-in-the-middle attacker can inject false responses to the client's first few queries. Despite the use of SSL certificate verification and encryption, Odyssey will pass these results to client as if they originated from valid server. This is similar to CVE-2021-23222 for PostgreSQL."
    },
    {
      "lang": "es",
      "value": "Odyssey pasa al cliente bytes no encriptados por el hombre en el medio Cuando el almacenamiento de Odyssey est\u00e1 configurado para usar el servidor PostgreSQL usando autenticaci\u00f3n \"trust\" con un requisito \"clientcert\" o para usar autenticaci\u00f3n \"cert\", un atacante hombre en el medio puede inyectar respuestas falsas a las primeras consultas del cliente. A pesar del uso de la verificaci\u00f3n y el cifrado del certificado SSL, Odyssey pasar\u00e1 estos resultados al cliente como si hubieran sido originados en un servidor v\u00e1lido. Esto es similar a CVE-2021-23222 para PostgreSQL."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.9,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 3.6
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    },
    {
      "source": "patrick@puiterwijk.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-522"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "9.6.0",
              "versionEndExcluding": "9.6.24",
              "matchCriteriaId": "2E950ED8-CA9E-4C53-BD86-7E1BEF561E9A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "10.0",
              "versionEndExcluding": "10.19",
              "matchCriteriaId": "C495B1CF-63CD-4E10-A9B2-6FD773AD5243"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "11.0",
              "versionEndExcluding": "11.14",
              "matchCriteriaId": "121A1F97-8480-4C15-AAA6-256CB1C0DD47"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "12.0",
              "versionEndExcluding": "12.9",
              "matchCriteriaId": "1E585815-7CA4-4B66-B222-28064F4600C7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "13.0",
              "versionEndExcluding": "13.5",
              "matchCriteriaId": "D4F8E475-7A26-4157-8E42-91D37845436C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:postgresql:postgresql:14.0:*:*:*:*:*:*:*",
              "matchCriteriaId": "B7DAB70A-574C-45E0-BC26-0C980E58907B"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/yandex/odyssey/issues/377,",
      "source": "patrick@puiterwijk.org",
      "tags": [
        "Broken Link"
      ]
    },
    {
      "url": "https://www.postgresql.org/support/security/CVE-2021-23222/",
      "source": "patrick@puiterwijk.org",
      "tags": [
        "Not Applicable",
        "Vendor Advisory"
      ]
    }
  ]
}