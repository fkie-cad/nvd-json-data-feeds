{
  "id": "CVE-2021-20109",
  "sourceIdentifier": "vulnreport@tenable.com",
  "published": "2021-07-19T15:15:07.673",
  "lastModified": "2022-06-28T14:11:45.273",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "Due to the Asset Explorer agent not validating HTTPS certificates, an attacker on the network can statically configure their IP address to match the Asset Explorer's Server IP address. This will allow an attacker to send a NEWSCAN request to a listening agent on the network as well as receive the agent's HTTP request verifying its authtoken. In AEAgent.cpp, the agent responding back over HTTP is vulnerable to a Heap Overflow if the POST payload response is too large. The POST payload response is converted to Unicode using vswprintf. This is written to a buffer only 0x2000 bytes big. If POST payload is larger, then heap overflow will occur."
    },
    {
      "lang": "es",
      "value": "Debido a que el agente de Asset Explorer no comprueba los certificados HTTPS, un atacante en la red puede configurar est\u00e1ticamente su direcci\u00f3n IP para que coincida con la direcci\u00f3n IP del servidor de Asset Explorer. Esto permitir\u00e1 a un atacante enviar una petici\u00f3n NEWSCAN a un agente que est\u00e9 escuchando en la red, as\u00ed como recibir la petici\u00f3n HTTP del agente comprobando su authtoken. En el archivo AEAgent.cpp, el agente que responde a trav\u00e9s de HTTP es vulnerable a un Desbordamiento de Pila si la respuesta de la carga \u00fatil POST es demasiado grande. La respuesta de la carga \u00fatil POST se convierte a Unicode usando vswprintf. Esto se escribe en un buffer de s\u00f3lo 0x2000 bytes de tama\u00f1o. Si la carga \u00fatil de POST es mayor, se producir\u00e1 un desbordamiento de pila"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-787"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:zohocorp:manageengine_assetexplorer:1.0.34:*:*:*:*:*:*:*",
              "matchCriteriaId": "2ED9862E-512A-4A1A-98F7-845ED9A62C44"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://www.tenable.com/security/research/tra-2021-30",
      "source": "vulnreport@tenable.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}