{
  "id": "CVE-2021-22138",
  "sourceIdentifier": "bressers@elastic.co",
  "published": "2021-05-13T18:15:09.077",
  "lastModified": "2022-06-04T02:56:05.497",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "In Logstash versions after 6.4.0 and before 6.8.15 and 7.12.0 a TLS certificate validation flaw was found in the monitoring feature. When specifying a trusted server CA certificate Logstash would not properly verify the certificate returned by the monitoring server. This could result in a man in the middle style attack against the Logstash monitoring data."
    },
    {
      "lang": "es",
      "value": "En Logstash versiones posteriores a 6.4.0 y anteriores a 6.8.15 y 7.12.0, se encontr\u00f3 un fallo de comprobaci\u00f3n del certificado TLS en la funcionalidad de monitoreo. Cuando se especifica un certificado CA en un servidor confiable, Logstash no verificaba apropiadamente el certificado devuelto por el servidor de monitoreo.&#xa0;Esto podr\u00eda resultar en un ataque de tipo man in the middle contra los datos de monitoreo de Logstash"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 3.7,
          "baseSeverity": "LOW"
        },
        "exploitabilityScore": 2.2,
        "impactScore": 1.4
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:N/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    },
    {
      "source": "bressers@elastic.co",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-295"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:elastic:logstash:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "6.4.0",
              "versionEndExcluding": "6.8.15",
              "matchCriteriaId": "AF51983B-CF75-4CFE-8E8F-C535086AA57B"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:elastic:logstash:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "7.0.0",
              "versionEndExcluding": "7.12.0",
              "matchCriteriaId": "1BD39C4B-52DA-4EE2-B2A5-4CFBC8924EE0"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://discuss.elastic.co/t/elastic-stack-7-12-0-and-6-8-15-security-update/268125",
      "source": "bressers@elastic.co",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://security.netapp.com/advisory/ntap-20210629-0001/",
      "source": "bressers@elastic.co",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}