{
  "id": "CVE-2021-24220",
  "sourceIdentifier": "contact@wpscan.com",
  "published": "2021-04-12T14:15:15.490",
  "lastModified": "2021-04-22T17:31:51.663",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Thrive \u201cLegacy\u201d Rise by Thrive Themes WordPress theme before 2.0.0, Luxe by Thrive Themes WordPress theme before 2.0.0, Minus by Thrive Themes WordPress theme before 2.0.0, Ignition by Thrive Themes WordPress theme before 2.0.0, FocusBlog by Thrive Themes WordPress theme before 2.0.0, Squared by Thrive Themes WordPress theme before 2.0.0, Voice WordPress theme before 2.0.0, Performag by Thrive Themes WordPress theme before 2.0.0, Pressive by Thrive Themes WordPress theme before 2.0.0, Storied by Thrive Themes WordPress theme before 2.0.0 register a REST API endpoint to compress images using the Kraken image optimization engine. By supplying a crafted request in combination with data inserted using the Option Update vulnerability, it was possible to use this endpoint to retrieve malicious code from a remote URL and overwrite an existing file on the site with it or create a new file.This includes executable PHP files that contain malicious code."
    },
    {
      "lang": "es",
      "value": "Thrive \"Legacy\" Rise by Thrive Themes de WordPress versiones anteriores a 2.0.0, Luxe para el tema Thrive Themes WordPress versiones anteriores a 2.0.0, Minus para el tema Thrive Themes WordPress versiones anteriores a 2.0.0, Ignition para el tema Thrive Themes WordPress versiones anteriores a 2.0.0,  FocusBlog para el tema Thrive Themes WordPress versiones anteriores a 2.0.0, Squared para el tema Thrive Themes WordPress versiones anteriores a 2.0.0, el tema Voice WordPress versiones anteriores a 2.0.0, Performag para el tema Thrive Themes WordPress versiones anteriores a 2.0.0,  Pressive para el tema Thrive Themes WordPress versiones anteriores a 2.0.0, Storied para el tema Thrive Themes WordPress versiones anteriores a 20.0, registra un endpoint de la API REST para comprimir im\u00e1genes utilizando el motor de optimizaci\u00f3n de im\u00e1genes Kraken.&#xa0;Al suministrar una petici\u00f3n dise\u00f1ada en combinaci\u00f3n con los datos insertados usando la vulnerabilidad de Actualizaci\u00f3n de Opciones, era posible utilizar este endpoint para recuperar c\u00f3digo malicioso de una URL remota y sobrescribir un archivo existente en el sitio con \u00e9l o crear un nuevo archivo. Esto incluye archivos PHP ejecutables que contienen c\u00f3digo malicioso"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 9.1,
          "baseSeverity": "CRITICAL"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 5.2
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.4
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "contact@wpscan.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-434"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:focusblog:*:*:*:*:*:wordpress_:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "BFFF0175-A293-4B84-B638-CBB57C36A847"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:ignition:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "34F8D47C-0A83-4F99-8DBD-93E84237FBD4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:luxe:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "1760E6FC-E15D-4F80-A703-F47FC34E0A3C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:minus:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "C17B650A-18C6-4479-B9A3-8B765450EB78"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:performag:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "5C9BD6E6-F0D2-4C6D-B4A9-4C9DCB197F75"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:pressive:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "2C9C11DF-0A77-43FD-B2D6-4C9BB59855AC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:rise:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "AEC69A5B-13F5-4B20-98E2-016CB0B22CF7"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:squared:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "960214E4-1349-4C85-929C-2CF7A5295358"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:storied:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "9652A2E0-34E6-4308-B7C7-CC6F9D71AE67"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:thrivethemes:voice:*:*:*:*:*:wordpress:*:*",
              "versionEndExcluding": "2.0.0",
              "matchCriteriaId": "1A4ACF69-0C88-4765-A028-4DD2DDDA7743"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://wpscan.com/vulnerability/a2424354-2639-4f53-a24f-afc11f6c4cac",
      "source": "contact@wpscan.com",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.wordfence.com/blog/2021/03/recently-patched-vulnerability-in-thrive-themes-actively-exploited-in-the-wild",
      "source": "contact@wpscan.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}