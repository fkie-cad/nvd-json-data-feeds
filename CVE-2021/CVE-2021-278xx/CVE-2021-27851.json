{
  "id": "CVE-2021-27851",
  "sourceIdentifier": "cret@cert.org",
  "published": "2021-04-26T16:15:07.433",
  "lastModified": "2022-07-29T16:34:08.000",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "A security vulnerability that can lead to local privilege escalation has been found in \u2019guix-daemon\u2019. It affects multi-user setups in which \u2019guix-daemon\u2019 runs locally. The attack consists in having an unprivileged user spawn a build process, for instance with `guix build`, that makes its build directory world-writable. The user then creates a hardlink to a root-owned file such as /etc/shadow in that build directory. If the user passed the --keep-failed option and the build eventually fails, the daemon changes ownership of the whole build tree, including the hardlink, to the user. At that point, the user has write access to the target file. Versions after and including v0.11.0-3298-g2608e40988, and versions prior to v1.2.0-75109-g94f0312546 are vulnerable."
    },
    {
      "lang": "es",
      "value": "Se ha encontrado una vulnerabilidad de seguridad en \"guix-daemon\" que puede conllevar a una escalada de privilegios local.&#xa0;Afecta a las configuraciones multiusuario en las que \"guix-daemon\" se ejecuta localmente.&#xa0;El ataque consiste en hacer que un usuario no privilegiado genere un proceso de compilaci\u00f3n, por ejemplo con \"guix build\", que hace que su directorio de compilaci\u00f3n sea world-writable.&#xa0;Luego, el usuario crea un v\u00ednculo f\u00edsico a un archivo de propiedad root tal y como /etc/shadow en ese directorio de compilaci\u00f3n.&#xa0;Si el usuario pas\u00f3 la opci\u00f3n --keep-failed y finalmente se produce un fallo en la compilaci\u00f3n, el demonio cambia la propiedad de todo el \u00e1rbol de compilaci\u00f3n, incluido el enlace f\u00edsico, al usuario.&#xa0;En ese momento, el usuario tiene acceso de escritura al archivo de destino.&#xa0;Las versiones posteriores a la v0.11.0-3298-g2608e40988 y las versiones anteriores a la v1.2.0-75109-g94f0312546 son vulnerables"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:L/AC:L/PR:L/UI:N/S:U/C:N/I:H/A:N",
          "attackVector": "LOCAL",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 5.5,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:L/AC:L/Au:N/C:N/I:P/A:N",
          "accessVector": "LOCAL",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 2.1
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 3.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-59"
        }
      ]
    },
    {
      "source": "cret@cert.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-264"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:gnu:guix:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "0.11.0",
              "versionEndExcluding": "1.2.0",
              "matchCriteriaId": "D489F131-C780-45C0-99CF-B59532F60807"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugs.gnu.org/47229",
      "source": "cret@cert.org",
      "tags": [
        "Issue Tracking",
        "Mailing List",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://guix.gnu.org/en/blog/2021/risk-of-local-privilege-escalation-via-guix-daemon/",
      "source": "cret@cert.org",
      "tags": [
        "Patch",
        "Vendor Advisory"
      ]
    }
  ]
}