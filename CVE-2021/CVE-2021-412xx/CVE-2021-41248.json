{
  "id": "CVE-2021-41248",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-11-04T21:15:08.097",
  "lastModified": "2021-11-09T15:35:49.180",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "GraphiQL is the reference implementation of this monorepo, GraphQL IDE, an official project under the GraphQL Foundation. All versions of graphiql older than graphiql@1.4.7 are vulnerable to compromised HTTP schema introspection responses or schema prop values with malicious GraphQL type names, exposing a dynamic XSS attack surface that can allow code injection on operation autocomplete. In order for the attack to take place, the user must load a vulnerable schema in graphiql. There are a number of ways that can occur. By default, the schema URL is not attacker-controllable in graphiql or in its suggested implementations or examples, leaving only very complex attack vectors. If a custom implementation of graphiql's fetcher allows the schema URL to be set dynamically, such as a URL query parameter like ?endpoint= in graphql-playground, or a database provided value, then this custom graphiql implementation is vulnerable to phishing attacks, and thus much more readily available, low or no privelege level xss attacks. The URLs could look like any generic looking graphql schema URL. It should be noted that desktop clients such as Altair, Insomnia, Postwoman, do not appear to be impacted by this. This vulnerability does not impact codemirror-graphql, monaco-graphql or other dependents, as it exists in onHasCompletion.ts in graphiql. It does impact all forks of graphiql, and every released version of graphiql."
    },
    {
      "lang": "es",
      "value": "GraphiQL es la implementaci\u00f3n de referencia de este monorepo, GraphQL IDE, un proyecto oficial bajo la GraphQL Foundation. Todas las versiones de graphiql anteriores a graphiql@1.4.7 son vulnerables a respuestas de introspecci\u00f3n de esquema HTTP comprometidas o valores de prop de esquema con nombres de tipo GraphQL maliciosos, exponiendo una superficie de ataque de tipo XSS din\u00e1mica que puede permitir una inyecci\u00f3n de c\u00f3digo en el autocompletado de operaciones. Para que el ataque tenga lugar, el usuario debe cargar un esquema vulnerable en graphiql. Esto puede ocurrir de varias maneras. Por defecto, la URL del esquema no es controlable por el atacante en graphiql o en sus implementaciones o ejemplos sugeridos, dejando s\u00f3lo vectores de ataque muy complejos. Si una implementaci\u00f3n personalizada del fetcher de graphiql permite que la URL del esquema sea establecida din\u00e1micamente, como un par\u00e1metro de consulta de la URL como ?endpoint= en graphql-playground, o un valor proporcionado por la base de datos, entonces esta implementaci\u00f3n personalizada de graphiql es vulnerable a ataques de suplantaci\u00f3n de identidad, y por lo tanto a ataques de tipo xss de bajo o ning\u00fan nivel de privilegio. Las URLs podr\u00edan parecerse a cualquier URL de esquema graphql de aspecto gen\u00e9rico. Cabe se\u00f1alar que los clientes de escritorio como Altair, Insomnia, Postwoman, no parecen ser impactados por esto. Esta vulnerabilidad no afecta a codemirror-graphql, monaco-graphql u otros dependientes, ya que se presenta en onHasCompletion.ts en graphiql. Afecta a todas las bifurcaciones de graphiql, y a todas las versiones publicadas de graphiql"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 4.7,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 2.7
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:U/C:H/I:H/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "LOW",
          "baseScore": 7.1,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 1.6,
        "impactScore": 5.5
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:H/Au:N/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "HIGH",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 2.6
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 4.9,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:graphql:graphiql:*:*:*:*:*:node.js:*:*",
              "versionStartIncluding": "0.5.0",
              "versionEndExcluding": "1.4.7",
              "matchCriteriaId": "ECCC95D1-CD01-402E-9897-CF74150D03CF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/graphql/graphiql/commit/cb237eeeaf7333c4954c752122261db7520f7bf4",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/graphql/graphiql/security/advisories/GHSA-x4r7-m2q9-69c8",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/graphql/graphql-playground/security/advisories/GHSA-59r9-6jp6-jcm7",
      "source": "security-advisories@github.com",
      "tags": [
        "Not Applicable",
        "Third Party Advisory"
      ]
    }
  ]
}