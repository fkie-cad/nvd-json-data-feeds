{
  "id": "CVE-2021-27910",
  "sourceIdentifier": "security@mautic.org",
  "published": "2021-08-30T16:15:07.293",
  "lastModified": "2021-09-10T15:02:27.527",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "Insufficient sanitization / filtering allows for arbitrary JavaScript Injection in Mautic using the bounce management callback function. The values submitted in the \"error\" and \"error_related_to\" parameters of the POST request of the bounce management callback will be permanently stored and executed once the details page of an affected lead is opened by a Mautic user. An attacker with access to the bounce management callback function (identified with the Mailjet webhook, but it is assumed this will work uniformly across all kinds of webhooks) can inject arbitrary JavaScript Code into the \"error\" and \"error_related_to\" parameters of the POST request (POST /mailer/<product / webhook>/callback). It is noted that there is no authentication needed to access this function. The JavaScript Code is stored permanently in the web application and executed every time an authenticated user views the details page of a single contact / lead in Mautic. This means, arbitrary code can be executed to, e.g., steal or tamper with information."
    },
    {
      "lang": "es",
      "value": "Un saneamiento / filtrado insuficiente permite una inyecci\u00f3n arbitraria de JavaScript en Mautic mediante la funci\u00f3n bounce management callback. Los valores enviados en los par\u00e1metros \"error\" y \"error_related_to\" de la petici\u00f3n POST de la devoluci\u00f3n de llamada de la administraci\u00f3n de rebotes ser\u00e1n almacenados de forma permanente y ser\u00e1n ejecutados una vez que la p\u00e1gina de detalles de un lead afectado sea abierta por un usuario de Mautic. Un atacante con acceso a la funci\u00f3n de callback de administraci\u00f3n de rebotes (identificada con el webhook de Mailjet, pero se supone que esto funcionar\u00e1 uniformemente en todos los tipos de webhooks) puede inyectar c\u00f3digo JavaScript arbitrario en los par\u00e1metros \"error\" y \"error_related_to\" de la petici\u00f3n POST (POST /mailer//callback). N\u00f3tese que no se necesita autenticaci\u00f3n para acceder a esta funci\u00f3n. El c\u00f3digo JavaScript es almacenado permanentemente en la aplicaci\u00f3n web y es ejecutado cada vez que un usuario autenticado visualiza la p\u00e1gina de detalles de un solo contacto / lead en Mautic. Esto significa que puede ser ejecutado un c\u00f3digo arbitrario para, por ejemplo, robar o manipular informaci\u00f3n."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 6.1,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.7
      },
      {
        "source": "security@mautic.org",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:H/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "HIGH",
          "availabilityImpact": "NONE",
          "baseScore": 8.2,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 4.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 4.3
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    },
    {
      "source": "security@mautic.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:acquia:mautic:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.3.4",
              "matchCriteriaId": "EA7B8AF8-5929-4515-9EFF-9F589FA3FFDC"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:acquia:mautic:4.0.0:alpha1:*:*:*:*:*:*",
              "matchCriteriaId": "A4B8FCED-A690-45D0-ACE1-871ADA2080F3"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:acquia:mautic:4.0.0:beta:*:*:*:*:*:*",
              "matchCriteriaId": "14D56FFE-E768-4502-BA7E-6B34BFE463B4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:acquia:mautic:4.0.0:rc:*:*:*:*:*:*",
              "matchCriteriaId": "C536B44B-C713-47D1-9EBD-E2D94CB0561E"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/mautic/mautic/security/advisories/GHSA-86pv-95mj-7w5f",
      "source": "security@mautic.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}