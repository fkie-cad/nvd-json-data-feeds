{
  "id": "CVE-2021-47516",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-05-24T15:15:13.130",
  "lastModified": "2024-05-24T18:09:20.027",
  "vulnStatus": "Undergoing Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\nnfp: Fix memory leak in nfp_cpp_area_cache_add()\n\nIn line 800 (#1), nfp_cpp_area_alloc() allocates and initializes a\nCPP area structure. But in line 807 (#2), when the cache is allocated\nfailed, this CPP area structure is not freed, which will result in\nmemory leak.\n\nWe can fix it by freeing the CPP area when the cache is allocated\nfailed (#2).\n\n792 int nfp_cpp_area_cache_add(struct nfp_cpp *cpp, size_t size)\n793 {\n794 \tstruct nfp_cpp_area_cache *cache;\n795 \tstruct nfp_cpp_area *area;\n\n800\tarea = nfp_cpp_area_alloc(cpp, NFP_CPP_ID(7, NFP_CPP_ACTION_RW, 0),\n801 \t\t\t\t  0, size);\n\t// #1: allocates and initializes\n\n802 \tif (!area)\n803 \t\treturn -ENOMEM;\n\n805 \tcache = kzalloc(sizeof(*cache), GFP_KERNEL);\n806 \tif (!cache)\n807 \t\treturn -ENOMEM; // #2: missing free\n\n817\treturn 0;\n818 }"
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: nfp: corrige la p\u00e9rdida de memoria en nfp_cpp_area_cache_add() En la l\u00ednea 800 (#1), nfp_cpp_area_alloc() asigna e inicializa una estructura de \u00e1rea CPP. Pero en la l\u00ednea 807 (#2), cuando falla la asignaci\u00f3n de cach\u00e9, esta estructura de \u00e1rea CPP no se libera, lo que resultar\u00e1 en una p\u00e9rdida de memoria. Podemos solucionarlo liberando el \u00e1rea de CPP cuando falla la asignaci\u00f3n de cach\u00e9 (#2). 792 int nfp_cpp_area_cache_add(struct nfp_cpp *cpp, size_t tama\u00f1o) 793 { 794 struct nfp_cpp_area_cache *cache; 795 estructura nfp_cpp_area *\u00e1rea; \u00e1rea 800 = nfp_cpp_area_alloc(cpp, NFP_CPP_ID(7, NFP_CPP_ACTION_RW, 0), 801 0, tama\u00f1o); // #1: asigna e inicializa 802 if (!area) 803 return -ENOMEM; 805 cach\u00e9 = kzalloc(sizeof(*cache), GFP_KERNEL); 806 si (!cache) 807 retorno -ENOMEM; // #2: falta el retorno 817 gratuito 0; 818 }"
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/2e0e072e62fdaf7816220af08e05c020f0fcb77a",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/3e93abcdcec0436fbf0b6a88ae806902426895a2",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/484069b5de9d223cc1c64c6f80389a99cfef51f1",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/c56c96303e9289cc34716b1179597b6f470833de",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/eb51f639ef3fd5498b7def290ed8681b6aadd9a7",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/f707820c09239d6f67699d9b2ff57863cc7905b0",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}