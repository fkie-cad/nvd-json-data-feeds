{
  "id": "CVE-2021-22696",
  "sourceIdentifier": "security@apache.org",
  "published": "2021-04-02T10:15:12.200",
  "lastModified": "2022-05-12T14:36:12.783",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "CXF supports (via JwtRequestCodeFilter) passing OAuth 2 parameters via a JWT token as opposed to query parameters (see: The OAuth 2.0 Authorization Framework: JWT Secured Authorization Request (JAR)). Instead of sending a JWT token as a \"request\" parameter, the spec also supports specifying a URI from which to retrieve a JWT token from via the \"request_uri\" parameter. CXF was not validating the \"request_uri\" parameter (apart from ensuring it uses \"https) and was making a REST request to the parameter in the request to retrieve a token. This means that CXF was vulnerable to DDos attacks on the authorization server, as specified in section 10.4.1 of the spec. This issue affects Apache CXF versions prior to 3.4.3; Apache CXF versions prior to 3.3.10."
    },
    {
      "lang": "es",
      "value": "CXF admite (por medio de JwtRequestCodeFilter) pasar par\u00e1metros de OAuth 2 por medio de un token JWT en lugar de par\u00e1metros de consulta (consulte: El Framework de Autorizaci\u00f3n de OAuth 2.0: JWT Secured Authorization Request (JAR)).&#xa0;En lugar de enviar un token JWT como un par\u00e1metro \"request\", la especificaci\u00f3n tambi\u00e9n admite la especificaci\u00f3n de un URI desde el cual recuperar un token JWT por medio del par\u00e1metro \"request_uri\".&#xa0;CXF no estaba comprobando el par\u00e1metro \"request_uri\" (adem\u00e1s de asegurarse de que usa \"https) y estaba realizando una petici\u00f3n REST hacia el par\u00e1metro en la petici\u00f3n para recuperar un token. Esto significa que CXF era vulnerable a ataques de DDos en el servidor de autorizaci\u00f3n, como lo especifica en secci\u00f3n 10.4.1 de la especificaci\u00f3n Este problema afecta a Apache CXF versiones anteriores a 3.4.3; Apache CXF versiones anteriores a 3.3.10."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:N/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "HIGH",
          "baseScore": 7.5,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.9,
        "impactScore": 3.6
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:N/C:N/I:N/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "NONE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "NONE",
          "availabilityImpact": "PARTIAL",
          "baseScore": 5.0
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 10.0,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    },
    {
      "source": "security@apache.org",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-400"
        },
        {
          "lang": "en",
          "value": "CWE-918"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:cxf:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "3.3.10",
              "matchCriteriaId": "19CA6A81-4F3E-4342-9C77-AF8416C2D443"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:apache:cxf:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "3.4.0",
              "versionEndExcluding": "3.4.3",
              "matchCriteriaId": "66C2F29C-4DA4-43E2-9661-A6AAC9696E43"
            }
          ]
        }
      ]
    },
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:business_intelligence:5.5.0.0.0:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "D40AD626-B23A-44A3-A6C0-1FFB4D647AE4"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:business_intelligence:5.9.0.0.0:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "B602F9E8-1580-436C-A26D-6E6F8121A583"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:business_intelligence:12.2.1.3.0:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "77C3DD16-1D81-40E1-B312-50FBD275507C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:business_intelligence:12.2.1.4.0:*:*:*:enterprise:*:*:*",
              "matchCriteriaId": "81DAC8C0-D342-44B5-9432-6B88D389584F"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:communications_diameter_intelligence_hub:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.0.0",
              "versionEndIncluding": "8.1.0",
              "matchCriteriaId": "B5B4A191-44AE-4C35-9164-19237D2CF013"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:communications_diameter_intelligence_hub:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.2.0",
              "versionEndIncluding": "8.2.3",
              "matchCriteriaId": "A543B4F8-149A-48AB-B388-AB7FA2ECAC18"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:communications_element_manager:8.2.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "19EEAA04-A7BD-4FFF-8B0B-CEE5EC09F75C"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:communications_session_report_manager:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.0.0",
              "versionEndIncluding": "8.2.4.0",
              "matchCriteriaId": "9B7C949D-0AB3-4566-9096-014C82FC1CF1"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:oracle:communications_session_route_manager:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "8.0.0",
              "versionEndIncluding": "8.2.4",
              "matchCriteriaId": "1FDBAD8E-C926-4D6F-9FD2-B0428980D6DF"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "http://www.openwall.com/lists/oss-security/2021/04/02/2",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://cxf.apache.org/security-advisories.data/CVE-2021-22696.txt.asc",
      "source": "security@apache.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r6445001cc5f9a2bb1e6316993753306e054bdd1d702656b7cbe59045@%3Cannounce.apache.org%3E",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r8651c06212c56294a1c0ea61a5ad7790c06502209c03f05c0c7c9914@%3Cdev.cxf.apache.org%3E",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/r8651c06212c56294a1c0ea61a5ad7790c06502209c03f05c0c7c9914@%3Cusers.cxf.apache.org%3E",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/rec7160382badd3ef4ad017a22f64a266c7188b9ba71394f0d321e2d4@%3Ccommits.cxf.apache.org%3E",
      "source": "security@apache.org",
      "tags": [
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://lists.apache.org/thread.html/rfb87e0bf3995e7d560afeed750fac9329ff5f1ad49da365129b7f89e@%3Ccommits.cxf.apache.org%3E",
      "source": "security@apache.org",
      "tags": [
        "Exploit",
        "Mailing List",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuapr2022.html",
      "source": "security@apache.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.oracle.com/security-alerts/cpuoct2021.html",
      "source": "security@apache.org",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    }
  ]
}