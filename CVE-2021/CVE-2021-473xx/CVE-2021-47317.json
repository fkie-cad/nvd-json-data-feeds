{
  "id": "CVE-2021-47317",
  "sourceIdentifier": "416baaa9-dc9f-4396-8d5f-8c081fb06d67",
  "published": "2024-05-21T15:15:19.007",
  "lastModified": "2024-05-21T16:54:26.047",
  "vulnStatus": "Awaiting Analysis",
  "descriptions": [
    {
      "lang": "en",
      "value": "In the Linux kernel, the following vulnerability has been resolved:\n\npowerpc/bpf: Fix detecting BPF atomic instructions\n\nCommit 91c960b0056672 (\"bpf: Rename BPF_XADD and prepare to encode other\natomics in .imm\") converted BPF_XADD to BPF_ATOMIC and added a way to\ndistinguish instructions based on the immediate field. Existing JIT\nimplementations were updated to check for the immediate field and to\nreject programs utilizing anything more than BPF_ADD (such as BPF_FETCH)\nin the immediate field.\n\nHowever, the check added to powerpc64 JIT did not look at the correct\nBPF instruction. Due to this, such programs would be accepted and\nincorrectly JIT'ed resulting in soft lockups, as seen with the atomic\nbounds test. Fix this by looking at the correct immediate value."
    },
    {
      "lang": "es",
      "value": "En el kernel de Linux, se resolvi\u00f3 la siguiente vulnerabilidad: powerpc/bpf: Correcci\u00f3n de la detecci\u00f3n de instrucciones at\u00f3micas BPF. La confirmaci\u00f3n 91c960b0056672 (\"bpf: Renombrar BPF_XADD y prepararse para codificar otros \u00e1tomos en .imm\") convirti\u00f3 BPF_XADD a BPF_ATOMIC y agreg\u00f3 una forma de distinguir instrucciones basadas en el campo inmediato. Las implementaciones JIT existentes se actualizaron para verificar el campo inmediato y rechazar programas que utilicen algo m\u00e1s que BPF_ADD (como BPF_FETCH) en el campo inmediato. Sin embargo, la verificaci\u00f3n agregada a powerpc64 JIT no analiz\u00f3 la instrucci\u00f3n BPF correcta. Debido a esto, dichos programas ser\u00edan aceptados y sometidos a JIT incorrectamente, lo que provocar\u00eda bloqueos suaves, como se ve con la prueba de l\u00edmites at\u00f3micos. Solucione este problema observando el valor inmediato correcto."
    }
  ],
  "metrics": {},
  "references": [
    {
      "url": "https://git.kernel.org/stable/c/0d435b6d94b05dcfd836d758a63145aa566618e2",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/419ac821766cbdb9fd85872bb3f1a589df05c94c",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    },
    {
      "url": "https://git.kernel.org/stable/c/7284dab07e4d51d453cc42851fae9ec4fac6ef2f",
      "source": "416baaa9-dc9f-4396-8d5f-8c081fb06d67"
    }
  ]
}