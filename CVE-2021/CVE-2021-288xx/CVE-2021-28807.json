{
  "id": "CVE-2021-28807",
  "sourceIdentifier": "security@qnapsecurity.com.tw",
  "published": "2021-06-03T03:15:08.533",
  "lastModified": "2021-09-14T14:30:13.457",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "A post-authentication reflected XSS vulnerability has been reported to affect QNAP NAS running Q\u2019center. If exploited, this vulnerability allows remote attackers to inject malicious code. QNAP have already fixed this vulnerability in the following versions of Q\u2019center: QTS 4.5.3: Q\u2019center v1.12.1012 and later QTS 4.3.6: Q\u2019center v1.10.1004 and later QTS 4.3.3: Q\u2019center v1.10.1004 and later QuTS hero h4.5.2: Q\u2019center v1.12.1012 and later QuTScloud c4.5.4: Q\u2019center v1.12.1012 and later"
    },
    {
      "lang": "es",
      "value": "Se ha reportado una vulnerabilidad de tipo XSS reflejada despu\u00e9s de la autenticaci\u00f3n que afecta los NAS de QNAP que ejecuta Q'center. Si es explotada, esta vulnerabilidad permite a atacantes remotos inyectar c\u00f3digo malicioso. QNAP ya ha corregido esta vulnerabilidad en las siguientes versiones de Q'center: versiones QTS 4.5.3: Q'center v1.12.1012 y posteriores, versi\u00f3n QTS 4.3.6: Q'center v1.10.1004 y posteriores, versi\u00f3n QTS 4.3.3: Q'center v1.10.1004 y posteriores, versi\u00f3n QuTS hero h4.5.2: Q'center v1.12.1012 y posteriores, versi\u00f3n QuTScloud c4.5.4: Q'center v1.12.1012 y posteriores"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      },
      {
        "source": "security@qnapsecurity.com.tw",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 7.7,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 3.1,
        "impactScore": 4.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 3.5
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 6.8,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security@qnapsecurity.com.tw",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:qnap:q\\'center:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.12.1012",
              "matchCriteriaId": "3CAF8C5F-53BB-42BB-89D7-78C752D32396"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:qnap:qts:4.5.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "48622A55-7475-4A9B-A16E-547BB40593B4"
            }
          ]
        }
      ]
    },
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:qnap:q\\'center:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.10.1004",
              "matchCriteriaId": "E9CC9D66-BF65-4229-9C30-C0BC5B21BE70"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:qnap:qts:4.3.3:*:*:*:*:*:*:*",
              "matchCriteriaId": "C5994C07-17FE-4784-9FA4-9675BA8B4743"
            }
          ]
        }
      ]
    },
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:qnap:q\\'center:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.10.1004",
              "matchCriteriaId": "E9CC9D66-BF65-4229-9C30-C0BC5B21BE70"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:qnap:qts:4.3.6:*:*:*:*:*:*:*",
              "matchCriteriaId": "FE9FAC96-AA2A-4CA5-A170-8C0E6BD47391"
            }
          ]
        }
      ]
    },
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:qnap:q\\'center:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.12.1012",
              "matchCriteriaId": "3CAF8C5F-53BB-42BB-89D7-78C752D32396"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:qnap:quts_hero:h4.5.2:*:*:*:*:*:*:*",
              "matchCriteriaId": "23F7A1DB-7D99-44FA-BCFA-8EBFF810B0AD"
            }
          ]
        }
      ]
    },
    {
      "operator": "AND",
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:qnap:q\\'center:*:*:*:*:*:*:*:*",
              "versionEndExcluding": "1.12.1012",
              "matchCriteriaId": "3CAF8C5F-53BB-42BB-89D7-78C752D32396"
            }
          ]
        },
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": false,
              "criteria": "cpe:2.3:o:qnap:qutscloud:c4.5.4:*:*:*:*:*:*:*",
              "matchCriteriaId": "F5CCD0BB-D81A-4C66-9280-5165FAFA2358"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://www.qnap.com/zh-tw/security-advisory/qsa-21-20",
      "source": "security@qnapsecurity.com.tw",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.shielder.it/advisories/qnap-qcenter-post-auth-remote-code-execution-via-qpkg/",
      "source": "security@qnapsecurity.com.tw",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://www.shielder.it/advisories/qnap-qcenter-virtual-stored-xss/",
      "source": "security@qnapsecurity.com.tw",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}