{
  "id": "CVE-2021-40088",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2021-08-25T02:15:08.230",
  "lastModified": "2021-09-07T14:17:56.557",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "An issue was discovered in PrimeKey EJBCA before 7.6.0. CMP RA Mode can be configured to use a known client certificate to authenticate enrolling clients. The same RA client certificate is used for revocation requests as well. While enrollment enforces multi tenancy constraints (by verifying that the client certificate has access to the CA and Profiles being enrolled against), this check was not performed when authenticating revocation operations, allowing a known tenant to revoke a certificate belonging to another tenant."
    },
    {
      "lang": "es",
      "value": "Se ha detectado un problema en PrimeKey EJBCA versiones anteriores a 7.6.0. El modo CMP RA puede ser configurado para usar un certificado de cliente conocido para autenticar a los clientes que se inscriben. El mismo certificado de cliente RA es usado tambi\u00e9n para las peticiones de revocaci\u00f3n. Mientras que la inscripci\u00f3n refuerza las restricciones de tenencia m\u00faltiple (al verificar que el certificado del cliente tiene acceso a la CA y a los Perfiles contra los que se est\u00e1 inscribiendo), esta comprobaci\u00f3n no se llevaba a cabo cuando se autenticaban las operaciones de revocaci\u00f3n, permitiendo a un tenedor conocido revocar un certificado perteneciente a otro tenedor."
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:L",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "NONE",
          "integrityImpact": "LOW",
          "availabilityImpact": "LOW",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 2.5
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 4.9
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 6.8,
        "impactScore": 4.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-862"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:primekey:ejbca:*:*:*:*:enterprise:*:*:*",
              "versionEndExcluding": "7.6.0",
              "matchCriteriaId": "69AD9042-C5D5-4D8D-8243-072E5D69E223"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://support.primekey.com/news/posts/51",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}