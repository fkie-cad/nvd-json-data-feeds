{
  "id": "CVE-2021-3738",
  "sourceIdentifier": "secalert@redhat.com",
  "published": "2022-03-02T23:15:09.070",
  "lastModified": "2022-03-10T14:59:45.067",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "In DCE/RPC it is possible to share the handles (cookies for resource state) between multiple connections via a mechanism called 'association groups'. These handles can reference connections to our sam.ldb database. However while the database was correctly shared, the user credentials state was only pointed at, and when one connection within that association group ended, the database would be left pointing at an invalid 'struct session_info'. The most likely outcome here is a crash, but it is possible that the use-after-free could instead allow different user state to be pointed at and this might allow more privileged access."
    },
    {
      "lang": "es",
      "value": "En DCE/RPC es posible compartir los manejadores (cookies para el estado de los recursos) entre m\u00faltiples conexiones por medio de un mecanismo llamado \"association groups\". Estos manejadores pueden hacer referencia a conexiones a nuestra base de datos sam.ldb. Sin embargo, mientras la base de datos era compartida correctamente, el estado de las credenciales del usuario s\u00f3lo era apuntado, y cuando una conexi\u00f3n dentro de ese grupo de asociaci\u00f3n terminaba, la base de datos quedaba apuntando a una \"struct session_info\" no v\u00e1lida. El resultado m\u00e1s probable en este caso es un bloqueo, pero es posible que un uso de memoria previamente liberada permita apuntar a un estado de usuario diferente y esto podr\u00eda permitir un acceso m\u00e1s privilegiado"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:L/Au:S/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "LOW",
          "authentication": "SINGLE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.5
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.0,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": false
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-416"
        }
      ]
    },
    {
      "source": "secalert@redhat.com",
      "type": "Secondary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-416"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.0.0",
              "versionEndExcluding": "4.13.14",
              "matchCriteriaId": "90E25F32-0EA6-4663-8031-D7473716820A"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.14.0",
              "versionEndExcluding": "4.14.10",
              "matchCriteriaId": "E2BD5F53-14DC-4BBF-8E5D-A1DBD24B5F02"
            },
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:samba:samba:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "4.15.0",
              "versionEndExcluding": "4.15.2",
              "matchCriteriaId": "8F33C9B3-33EE-431B-93CF-B738D05BBD0A"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2021726",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://bugzilla.samba.org/show_bug.cgi?id=14468",
      "source": "secalert@redhat.com",
      "tags": [
        "Issue Tracking",
        "Patch",
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://www.samba.org/samba/security/CVE-2021-3738.html",
      "source": "secalert@redhat.com",
      "tags": [
        "Vendor Advisory"
      ]
    }
  ]
}