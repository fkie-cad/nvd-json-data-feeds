{
  "id": "CVE-2021-39197",
  "sourceIdentifier": "security-advisories@github.com",
  "published": "2021-09-07T18:15:07.473",
  "lastModified": "2021-09-14T18:34:34.410",
  "vulnStatus": "Analyzed",
  "descriptions": [
    {
      "lang": "en",
      "value": "better_errors is an open source replacement for the standard Rails error page with more information rich error pages. It is also usable outside of Rails in any Rack app as Rack middleware. better_errors prior to 2.8.0 did not implement CSRF protection for its internal requests. It also did not enforce the correct \"Content-Type\" header for these requests, which allowed a cross-origin \"simple request\" to be made without CORS protection. These together left an application with better_errors enabled open to cross-origin attacks. As a developer tool, better_errors documentation strongly recommends addition only to the `development` bundle group, so this vulnerability should only affect development environments. Please ensure that your project limits better_errors to the `development` group (or the non-Rails equivalent). Starting with release 2.8.x, CSRF protection is enforced. It is recommended that you upgrade to the latest release, or minimally to \"~> 2.8.3\". There are no known workarounds to mitigate the risk of using older releases of better_errors."
    },
    {
      "lang": "es",
      "value": "better_errors es un reemplazo de c\u00f3digo abierto para la p\u00e1gina de error est\u00e1ndar de Rails con p\u00e1ginas de error m\u00e1s ricas en informaci\u00f3n. Tambi\u00e9n puede ser usado fuera de Rails en cualquier aplicaci\u00f3n Rack como middleware Rack. better_errors versiones anteriores a 2.8.0, no implementaba la protecci\u00f3n CSRF para sus peticiones internas. Tampoco aplicaba la cabecera \"Content-Type\" correcta para estas peticiones, que permit\u00eda realizar una \"petici\u00f3n simple\" de origen cruzado sin protecci\u00f3n CORS. Todo esto dejaba una aplicaci\u00f3n con better_errors habilitado abierta a ataques de origen cruzado. Como herramienta para desarrolladores, la documentaci\u00f3n de better_errors recomienda encarecidamente que se a\u00f1ada s\u00f3lo al grupo de paquetes \"development\", por lo que esta vulnerabilidad s\u00f3lo deber\u00eda afectar a los entornos de desarrollo. Por favor, aseg\u00farese de que su proyecto limita better_errors al grupo \"development\" (o su equivalente no Rails). A partir de la versi\u00f3n 2.8.x, se aplica la protecci\u00f3n CSRF. Se recomienda actualizar a la \u00faltima versi\u00f3n, o como m\u00ednimo a \" versiones posteriores a 2.8.3\". No se presentan soluciones conocidas para mitigar el riesgo de usar versiones anteriores de better_errors"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "NONE",
          "userInteraction": "REQUIRED",
          "scope": "UNCHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "HIGH",
          "availabilityImpact": "HIGH",
          "baseScore": 8.8,
          "baseSeverity": "HIGH"
        },
        "exploitabilityScore": 2.8,
        "impactScore": 5.9
      },
      {
        "source": "security-advisories@github.com",
        "type": "Secondary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:H/I:N/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "HIGH",
          "privilegesRequired": "LOW",
          "userInteraction": "NONE",
          "scope": "CHANGED",
          "confidentialityImpact": "HIGH",
          "integrityImpact": "NONE",
          "availabilityImpact": "NONE",
          "baseScore": 6.3,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 1.8,
        "impactScore": 4.0
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:N/C:P/I:P/A:P",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "NONE",
          "confidentialityImpact": "PARTIAL",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "PARTIAL",
          "baseScore": 6.8
        },
        "baseSeverity": "MEDIUM",
        "exploitabilityScore": 8.6,
        "impactScore": 6.4,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "security-advisories@github.com",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-352"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:better_errors_project:better_errors:*:*:*:*:*:ruby:*:*",
              "versionEndExcluding": "2.8.0",
              "matchCriteriaId": "82B32E86-42A3-4E3A-819D-BB3E0A2AEA7D"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://github.com/BetterErrors/better_errors/commit/8e8e796bfbde4aa088741823c8a3fc6df2089bb0",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BetterErrors/better_errors/discussions/507",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BetterErrors/better_errors/pull/474",
      "source": "security-advisories@github.com",
      "tags": [
        "Patch",
        "Third Party Advisory"
      ]
    },
    {
      "url": "https://github.com/BetterErrors/better_errors/security/advisories/GHSA-w3j4-76qw-wwjm",
      "source": "security-advisories@github.com",
      "tags": [
        "Third Party Advisory"
      ]
    }
  ]
}