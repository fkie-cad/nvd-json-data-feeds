{
  "id": "CVE-2021-36563",
  "sourceIdentifier": "cve@mitre.org",
  "published": "2021-07-26T18:15:08.483",
  "lastModified": "2021-09-16T13:21:57.460",
  "vulnStatus": "Analyzed",
  "cveTags": [],
  "descriptions": [
    {
      "lang": "en",
      "value": "The CheckMK management web console (versions 1.5.0 to 2.0.0) does not sanitise user input in various parameters of the WATO module. This allows an attacker to open a backdoor on the device with HTML content and interpreted by the browser (such as JavaScript or other client-side scripts), the XSS payload will be triggered when the user accesses some specific sections of the application. In the same sense a very dangerous potential way would be when an attacker who has the monitor role (not administrator) manages to get a stored XSS to steal the secretAutomation (for the use of the API in administrator mode) and thus be able to create another administrator user who has high privileges on the CheckMK monitoring web console. Another way is that persistent XSS allows an attacker to modify the displayed content or change the victim's information. Successful exploitation requires access to the web management interface, either with valid credentials or with a hijacked session."
    },
    {
      "lang": "es",
      "value": "La consola web de administraci\u00f3n de CheckMK (versiones 1.5.0 hasta 2.0.0) no sanea la entrada del usuario en varios par\u00e1metros del m\u00f3dulo WATO. Esto permite a un atacante abrir una backdoor en el dispositivo con contenido HTML e interpretarlo por el navegador (como JavaScript u otros scripts del lado del cliente), la carga \u00fatil de tipo XSS se desencadenar\u00e1 cuando el usuario acceda a algunas secciones espec\u00edficas de la aplicaci\u00f3n. En este mismo sentido una forma potencial muy peligrosa ser\u00eda cuando un atacante que presenta el rol de monitor (no de administrador) consigue que una vulnerabilidad de tipo XSS almacenado le robe el secretAutomation (para el uso de la API en modo administrador) y as\u00ed poder crear otro usuario administrador que tenga altos privilegios en la consola web de monitorizaci\u00f3n de CheckMK. Otra forma es que la vulnerabilidad de tipo XSS persistente permite a un atacante modificar el contenido mostrado o cambiar la informaci\u00f3n de la v\u00edctima. Una explotaci\u00f3n con \u00e9xito requiere el acceso a la interfaz de administraci\u00f3n web, ya sea con credenciales v\u00e1lidas o con una sesi\u00f3n secuestrada"
    }
  ],
  "metrics": {
    "cvssMetricV31": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "3.1",
          "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:C/C:L/I:L/A:N",
          "attackVector": "NETWORK",
          "attackComplexity": "LOW",
          "privilegesRequired": "LOW",
          "userInteraction": "REQUIRED",
          "scope": "CHANGED",
          "confidentialityImpact": "LOW",
          "integrityImpact": "LOW",
          "availabilityImpact": "NONE",
          "baseScore": 5.4,
          "baseSeverity": "MEDIUM"
        },
        "exploitabilityScore": 2.3,
        "impactScore": 2.7
      }
    ],
    "cvssMetricV2": [
      {
        "source": "nvd@nist.gov",
        "type": "Primary",
        "cvssData": {
          "version": "2.0",
          "vectorString": "AV:N/AC:M/Au:S/C:N/I:P/A:N",
          "accessVector": "NETWORK",
          "accessComplexity": "MEDIUM",
          "authentication": "SINGLE",
          "confidentialityImpact": "NONE",
          "integrityImpact": "PARTIAL",
          "availabilityImpact": "NONE",
          "baseScore": 3.5
        },
        "baseSeverity": "LOW",
        "exploitabilityScore": 6.8,
        "impactScore": 2.9,
        "acInsufInfo": false,
        "obtainAllPrivilege": false,
        "obtainUserPrivilege": false,
        "obtainOtherPrivilege": false,
        "userInteractionRequired": true
      }
    ]
  },
  "weaknesses": [
    {
      "source": "nvd@nist.gov",
      "type": "Primary",
      "description": [
        {
          "lang": "en",
          "value": "CWE-79"
        }
      ]
    }
  ],
  "configurations": [
    {
      "nodes": [
        {
          "operator": "OR",
          "negate": false,
          "cpeMatch": [
            {
              "vulnerable": true,
              "criteria": "cpe:2.3:a:checkmk:checkmk:*:*:*:*:*:*:*:*",
              "versionStartIncluding": "1.5.0",
              "versionEndIncluding": "2.0.0",
              "matchCriteriaId": "29099650-370E-4A84-A329-C2C4D2E9B4B3"
            }
          ]
        }
      ]
    }
  ],
  "references": [
    {
      "url": "https://checkmk.com/de/werk/12762",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://checkmk.com/de/werk/13148",
      "source": "cve@mitre.org",
      "tags": [
        "Vendor Advisory"
      ]
    },
    {
      "url": "https://github.com/Edgarloyola/CVE-2021-36563",
      "source": "cve@mitre.org",
      "tags": [
        "Exploit",
        "Third Party Advisory"
      ]
    }
  ]
}